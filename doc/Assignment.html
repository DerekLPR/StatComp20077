<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="20077 Peiran Liu" />


<title>Assignment</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Assignment</h1>
<h4 class="author">20077 Peiran Liu</h4>
<h4 class="date">2020/12/19</h4>



<div id="section" class="section level1">
<h1>2020-9-22</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce 3 examples in the book.The 1st example should contain texts and at least one figure. The 2nd example should contain texts and at least one table. The 3rd example should contain at least a couple of LaTeX formulas.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>This is a test Rmd file with figures,tables and LaTeX formulas,which helps author familar with R Studio and English.As there is no requirement for content,examples are irrelevant with math and statistics.</p>
<div id="example-1figure" class="section level3">
<h3>Example 1:Figure</h3>
<p>When we want to insert pictures,there are two ways to complete.</p>
<p>(1)The drawing of the function in R Studio.There are two function images about trigonometric functions,which are drawing by R codes.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">curve</span>(<span class="kw">sin</span>(x), <span class="dv">0</span>, <span class="dv">4</span><span class="op">*</span>pi)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">curve</span>(<span class="kw">cos</span>(x), <span class="dv">0</span>, <span class="dv">4</span><span class="op">*</span>pi)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>(2)Type the path and file name of the picture</p>
<p>There are some pictures about domestic smartphones,which are on sale this year.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">##The figure is hard to use in R packages,so eval=FALSE </span></span>
<span id="cb3-2"><a href="#cb3-2"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;smartphone/mi10u.png&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;smartphone/P40.png&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;smartphone/findX2Pro.png&quot;</span>)</span></code></pre></div>
</div>
<div id="example-2table" class="section level3">
<h3>Example 2:Table</h3>
<p>When we want to write articles,it’s hard for us to output formula by Word,especially Greek letter.As a solution,LaTeX is a useful software.There is a table about a part of Greek letters with corresponding LaTeX codes.</p>
<table>
<thead>
<tr class="header">
<th>Greek letter</th>
<th>code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\alpha\)</span></td>
<td>alpha</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta\)</span></td>
<td>beta</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\gamma\)</span></td>
<td>gamma</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\delta\)</span></td>
<td>delta</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\sigma\)</span></td>
<td>sigma</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\theta\)</span></td>
<td>theta</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\mu\)</span></td>
<td>mu</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\rho\)</span></td>
<td>rho</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\lambda\)</span></td>
<td>lambda</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\zeta\)</span></td>
<td>zeta</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\psi\)</span></td>
<td>psi</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\epsilon\)</span></td>
<td>epsilon</td>
</tr>
</tbody>
</table>
<p>In addition,when we have to output some Mathematical symbols,LaTeX is also a practical tool.</p>
<table>
<thead>
<tr class="header">
<th>Mathematical symbol</th>
<th>code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\int_{min}^{max}\)</span></td>
<td>int_{min}^{max}</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\frac{a}{b}\)</span></td>
<td>frac{a}{b}</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\in\)</span></td>
<td>in</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\subset\)</span></td>
<td>subset</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\prod\)</span></td>
<td>prod</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\sum\)</span></td>
<td>sum</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\neq\)</span></td>
<td>neq</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\cap\)</span></td>
<td>cap</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\cup\)</span></td>
<td>cup</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\to\)</span></td>
<td>to</td>
</tr>
</tbody>
</table>
</div>
<div id="example-3latex-formula" class="section level3">
<h3>Example 3:LaTeX Formula</h3>
<p>To make readers pay attention to form(Output LaTeX Formula) rather than contents,the author just show a simple math problem.</p>
<p>Get the limit of the mathematical expression <span class="math display">\[
\lim_{x\to 0} \frac{e^x-1}{\sin x}
\]</span></p>
<p>Solution.</p>
<p>(1)(L’Hospital’s rule) <span class="math display">\[
\lim_{x\to 0} \frac{e^x-1}{\sin x}=\lim_{x\to 0} \frac{(e^x-1)&#39;}{(\sin x)&#39;}=\lim_{x\to 0} \frac{e^x}{\cos x}=1
\]</span></p>
<p>(2)(substitution of equivalence infinitesimal)</p>
<p>According to basic knowledge of calculus,when <span class="math inline">\(x\to 0\)</span> <span class="math display">\[
e^x\to x,\sin x\to x
\]</span> As a result <span class="math display">\[
\lim_{x\to 0} \frac{e^x-1}{\sin x}=1
\]</span></p>
</div>
</div>
</div>
<div id="section-1" class="section level1">
<h1>2020 9-29</h1>
<div id="caption" class="section level3">
<h3>Caption</h3>
<p>When generate the random sample,the results of each time are different.So sometimes the the empirical and theoretical distributions are different,so the density density histogram(empirical distribution) may not coincide with density curve(theoretical distribution).</p>
</div>
<div id="question13.3" class="section level3">
<h3>Question1(3.3)</h3>
<p>The Pareto<span class="math inline">\((a, b)\)</span> distribution has cdf <span class="math display">\[
F(x)=1-\left(\frac{b}{x}\right)^a,x&gt;=b&gt;0,a&gt;0.
\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto<span class="math inline">\((2, 2)\)</span> distribution. Graph the density histogram of the sample with the Pareto<span class="math inline">\((2, 2)\)</span> density superimposed for comparison.</p>
</div>
<div id="answer1" class="section level3">
<h3>Answer1</h3>
<p><span class="math display">\[
u=1-(\frac{b}{x})^a\Rightarrow(\frac{b}{x})^a=1-u\Rightarrow\frac{b}{x}=(1-u)^\frac{1}{a}\Rightarrow x=\frac{b}{(1-u)^\frac{1}{a}}
\]</span> the probability inverse transformation<span class="math inline">\(F^{-1}(u)=\frac{b}{(1-u)^\frac{1}{a}}\)</span></p>
<p>as <span class="math inline">\(a=2,b=2\)</span> <span class="math display">\[
x=F^{-1}(u)=\frac{2}{(1-u)^\frac{1}{2}}=\sqrt{\frac{4}{1-u}}
\]</span> the pdf is <span class="math display">\[
f(x)=F&#39;(x)=\frac{8}{x^3}
\]</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb4-3"><a href="#cb4-3"></a>x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">4</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u)) <span class="co">#simulate a random sample from the Pareto(2, 2) distribution.</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">8</span><span class="op">/</span>x<span class="op">^</span>{<span class="dv">3</span>}))<span class="co">#density histogram of sample</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">25</span>, <span class="fl">.01</span>)</span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="kw">lines</span>(y, (<span class="dv">2</span><span class="op">/</span>y)<span class="op">^</span><span class="dv">3</span>) <span class="co">#density curve pdf</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question23.9" class="section level3">
<h3>Question2(3.9)</h3>
<p>The rescaled Epanechnikov kernel is a symmetric density function. <span class="math display">\[
 f_e(x)=\frac{3}{4}(1-x^2), |x|\leq1
 \]</span> Devroye and Gyorfi give the following algorithm for simulation from this distribution. Generate i.i.d <span class="math inline">\(U_1, U_2, U_3\)</span>∼ Uniform(−1, 1). If <span class="math inline">\(|U_3|\geq|U_2|\)</span> and <span class="math inline">\(|U_3|\geq|U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="answer2" class="section level3">
<h3>Answer2</h3>
<p>Using the acceptance-rejection method.</p>
<p>the pdf of random variable <span class="math inline">\(Y\)</span> is<span class="math inline">\(f(y)=\frac 34(1-y^2)\)</span>,the random variable <span class="math inline">\(X \sim U(-1,1)\)</span>,pdf is<span class="math inline">\(g(x)=\frac 12\)</span>,so <span class="math display">\[
\frac{f(x)}{g(x)}=\frac{3}{2}(1-x^2)\leq \frac 32
\]</span> mark <span class="math inline">\(c=\frac 32\)</span>.Random variable <span class="math inline">\(U\sim U(0,1)\)</span>.When <span class="math inline">\(u&lt;\frac{f(x)}{cg(x)}\)</span>,accept <span class="math inline">\(x\)</span> and deliver <span class="math inline">\(y=x\)</span>;else reject <span class="math inline">\(x\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>k &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co">#counter for accepted</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>j &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co">#iterations,it&#39;s not necessary</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>y &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="cf">while</span> (k <span class="op">&lt;</span><span class="st"> </span>n) {</span>
<span id="cb5-6"><a href="#cb5-6"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a>j &lt;-<span class="st"> </span>j <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>z &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) </span>
<span id="cb5-9"><a href="#cb5-9"></a>x &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>z<span class="dv">-1</span> <span class="co">#random variate from g(x)</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="cf">if</span> ( (<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>) <span class="op">&gt;</span>u ) {<span class="co">#when accept x</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#we accept x</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>y[k] &lt;-<span class="st"> </span>x</span>
<span id="cb5-14"><a href="#cb5-14"></a>}</span>
<span id="cb5-15"><a href="#cb5-15"></a>}</span>
<span id="cb5-16"><a href="#cb5-16"></a>j<span class="co">#the number of variable X</span></span></code></pre></div>
<pre><code>## [1] 1528</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">hist</span>(y, <span class="dt">prob =</span> <span class="ot">TRUE</span>)<span class="co">#the histogram of Y</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question33.10" class="section level3">
<h3>Question3(3.10)</h3>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span>.</p>
</div>
<div id="answer3" class="section level3">
<h3>Answer3</h3>
<p>As <span class="math inline">\(U_1,U_2,U_3\)</span>i.i.d. ~<span class="math inline">\(U(-1,1)\)</span> mark random variable Y is <span class="math display">\[
Y=U_2,\text{when} |U_3|\geq|U_2| \text{and} |U_3|\geq|U_1|,\\
Y=U_3,\text{others}
\]</span> so the pdf of Y is <span class="math display">\[
f_Y(x)=f(Y=U_2,U_2=x)+f(Y=U_3,U_3=x)
\]</span> Calculate two functions <span class="math display">\[
f(Y=U_2,U_2=x)=f(|U_3|\geq|U_2|,|U_3|\geq|U_1|,U_2=x)\\
=(\int_{-1}^{-|x|}+\int_{|x|}^{1})du_3(\int_{-|u_3|}^{|u_3|}\frac 18 du_1)\\
=(\int_{-1}^{-|x|}+\int_{|x|}^{1})\frac{|u_3|}{4}du_3\\
=\frac{1-x^2}{4}
\]</span></p>
<p><span class="math display">\[
f(Y=U_3,U_3=x)=f(U_3=x)-f(U_3=x,Y\not= U_3)\\
=f(U_3=x)-f(|U_3|\geq|U_2|,|U_3|\geq|U_1|,U_3=x)\\
=\int_{-1}^{1}d u_1\int_{-1}^{1} \frac{1}{8}d u_2-\int_{-|x|}^{|x|}d u_1\int_{-|x|}^{|x|} \frac{1}{8}d \\
=\frac{1-x^2}{2}
\]</span> so the pdf of Y is <span class="math display">\[
f_Y(x)=f(Y=U_2,U_2=x)+f(Y=U_3,U_3=x)=\frac 34(1-x^2)=f_e(x)
\]</span> So the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span>.</p>
</div>
<div id="question43.13" class="section level3">
<h3>Question4(3.13)</h3>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[
F(y)=1-(\frac{\beta}{\beta+y})^{\gamma},y\geq0
\]</span></p>
<p>(This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with <span class="math inline">\(\gamma = 4\)</span> and<span class="math inline">\(\beta = 2\)</span>. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer4" class="section level3">
<h3>Answer4</h3>
<p>Assume <span class="math inline">\(x=y+\beta\rightarrow y=x-\beta\)</span>,according to the question 1,probability inverse transformation of <span class="math inline">\(x\)</span> is<span class="math inline">\(x=\frac{\beta}{(1-u)^\frac{1}{\gamma}}\)</span>,so probability inverse transformation of <span class="math inline">\(y\)</span> is <span class="math display">\[y=F^{-1}(u)=\frac{\beta}{(1-u)^\frac{1}{\gamma}}-\beta.
\]</span> as <span class="math inline">\(\gamma=4,\beta=2\)</span>. <span class="math display">\[
y=\frac{2}{(1-u)^\frac{1}{4}}-2=(\frac{16}{1-u})^\frac {1}{4}-2.
\]</span> the pdf is <span class="math display">\[
f(y)=F&#39;(y)=\frac{64}{(2+y)^5}
\]</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb8-3"><a href="#cb8-3"></a>x &lt;-<span class="st"> </span>(<span class="dv">16</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">-</span><span class="dv">2</span> <span class="co">#simulate a random sample from the Pareto(2, 2) distribution with 1000 observations</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">64</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>x)<span class="op">^</span><span class="dv">5</span>))<span class="co">#density histogram of sample(empirical distribution)</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">.01</span>)</span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="kw">lines</span>(y, <span class="dv">2</span><span class="op">*</span>(<span class="dv">2</span><span class="op">/</span>(y<span class="op">+</span><span class="dv">2</span>))<span class="op">^</span><span class="dv">5</span>)<span class="co">#density curve pdf(theoretical distribution)</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The histogram and density plot suggests that the empirical and theoretical distributions approximately agree.</p>
</div>
</div>
<div id="section-2" class="section level1">
<h1>2020-10-13</h1>
<div id="question-15.1" class="section level3">
<h3>Question 1(5.1)</h3>
<p>Compute a Monte Carlo estimate of <span class="math display">\[
\int_{0}^{\frac{\pi}{3}}\sin t dt
\]</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-1" class="section level3">
<h3>Answer</h3>
<p><span class="math display">\[
\int_{0}^{\frac{\pi}{3}}\sin t dt=-\cos t|_{t=0}^{t=\frac {\pi}{3}}=1-\frac 12=0.5
\]</span> So the exact value of the integral is <span class="math inline">\(0.5\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">set.seed</span>(<span class="dv">79</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>m &lt;-<span class="st"> </span><span class="dv">100000</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(m)<span class="co">##x~U(0,1)</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>t &lt;-<span class="st"> </span>x<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span><span class="co">##t~U(0,pi/3)</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(t))<span class="co">## the estimate</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="kw">print</span>(theta.hat)<span class="co">##output the estimate </span></span></code></pre></div>
<pre><code>## [1] 0.4784859</code></pre>
<p>The estimate is 0.4784859,the exact value of the integral is <span class="math inline">\(0.5\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">print</span>((theta.hat<span class="fl">-0.5</span>)<span class="op">/</span><span class="fl">0.5</span>)<span class="co">##the percent of bias</span></span></code></pre></div>
<pre><code>## [1] -0.04302824</code></pre>
</div>
<div id="question-25.65.7" class="section level3">
<h3>Question 2(5.6&amp;&amp;5.7)</h3>
<p>(5.6) In Example 5.7 the control variate approach was illustrated for Monte Carlo integration of <span class="math display">\[
\theta=\int_0^1 e^xdx
\]</span> Now consider the antithetic variate approach. Compute <span class="math inline">\(Cov (e^U , e^{1−U} )\)</span> and <span class="math inline">\(Var(e^U + e^{1−U} )\)</span>, where <span class="math inline">\(U\sim Uniform(0,1)\)</span>. What is the percent reduction in variance of  that can be achieved using antithetic variates (compared with simple MC)?</p>
<p>(5.7) Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate θ by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="answer-2" class="section level3">
<h3>Answer</h3>
<p><span class="math display">\[
E(e^U+e^{1-U})=\int_0^1e^u+e^{1-u}du=(e^u-e^{1-u})|_{u=0}^{u=1}=2e-2
\]</span> <span class="math display">\[
E(e^U)=\int_0^1e^udu=(e^u)|_{u=0}^{u=1}=e-1
\]</span> <span class="math display">\[
E(e^U)=E(e^U+e^{1-U})-E(e^U)=e-1
\]</span> Compute the Variance <span class="math display">\[
Var(e^U+e^{1-U})=E[(e^U+e^{1-U})^2]-[E(e^U+e^{1-U})]^2\\
=\int_0^1(e^u+e^{1-u})^2du-(2e-2)^2\\
=(\frac{e^{2u}}{2}-\frac{e^{2-2u}}{2}+2eu)|_{u=0}^{u=1}-4e^2+8e-4\\
=-3e^2+10e-5
\]</span> <span class="math display">\[
Var(e^U)=E[(e^U)^2]-[E(e^U)]^2\\
=\int_0^1(e^u)^2du-(e-1)^2\\
=(\frac{e^{2u}}{2})|_{u=0}^{u=1}-e^2+2e-1\\
=-\frac 12e^2+2e-\frac 32
\]</span> <span class="math display">\[
Var(e^{1-U})=E[(e^{1-U})^2]-[E(e^{1-U})]^2\\
=\int_0^1(e^{1-u})^2du-(e-1)^2\\
=(-\frac{e^{2-2u}}{2})|_{u=0}^{u=1}-e^2+2e-1\\
=-\frac 12e^2+2e-\frac 32
\]</span> Compute the covariance <span class="math display">\[
Cov(e^U,e^{1-U})=\frac 12[Var(e^U+e^{1-U})-Var(e^U)-Var(e^{1-U})]\\
=-2e^2+6e-2
\]</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">print</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">2</span>)<span class="op">+</span><span class="dv">6</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">2</span>)<span class="co">## the theoretical Covariance</span></span></code></pre></div>
<pre><code>## [1] -0.4684212</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">print</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">2</span>)<span class="op">+</span><span class="dv">10</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">5</span>)<span class="co">##the theoretical Variance</span></span></code></pre></div>
<pre><code>## [1] 0.01564999</code></pre>
<p>for the Antithetic Variables<span class="math inline">\((e^U+e^{1-U})/2\)</span>,the variance is</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">print</span>((<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">2</span>)<span class="op">+</span><span class="dv">10</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">5</span>)<span class="op">/</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.003912497</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>n &lt;-<span class="dv">10000</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>u &lt;-<span class="kw">runif</span>(n)</span>
<span id="cb19-4"><a href="#cb19-4"></a>MC.simple &lt;-<span class="kw">exp</span>(u)<span class="co">##the smaple of Simple Monte Carlo</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>Mc.antithetic &lt;-(<span class="kw">exp</span>(u)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">/</span><span class="dv">2</span><span class="co">##the smaple of Antithetic Variables</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>theta.s &lt;-<span class="kw">mean</span>(MC.simple)<span class="co">##the estimate of  Simple Monte Carlo</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>theta.a &lt;-<span class="kw">mean</span>(Mc.antithetic)<span class="co">##the estimate of Antithetic Variables</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>sd.s &lt;-<span class="kw">sd</span>(MC.simple)<span class="co">##the sd of Simple Monte Carlo</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>sd.a &lt;-<span class="kw">sd</span>(Mc.antithetic)<span class="co">##the sd of Antithetic Variables</span></span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="kw">print</span>(theta.s)<span class="co">##the estimate of  Simple Monte Carlo</span></span></code></pre></div>
<pre><code>## [1] 1.715201</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">print</span>(theta.a)<span class="co">##the estimate of  Simple Monte Carlo</span></span></code></pre></div>
<pre><code>## [1] 1.716926</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">print</span>(sd.s)<span class="co">##the sd of Simple Monte Carlo</span></span></code></pre></div>
<pre><code>## [1] 0.4874751</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">print</span>(sd.a)<span class="co">##the sd of Antithetic Variables</span></span></code></pre></div>
<pre><code>## [1] 0.0621996</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">print</span>((sd.s<span class="op">-</span>sd.a)<span class="op">/</span>sd.s)<span class="co">##the percent reduction in variance using the antithetic</span></span></code></pre></div>
<pre><code>## [1] 0.8724046</code></pre>
<p>The theoretical value is<span class="math inline">\(\theta=\int_0^1 e^x dx=e-1\)</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">print</span>(<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>)<span class="co">##the theoretical value</span></span></code></pre></div>
<pre><code>## [1] 1.718282</code></pre>
<p>The theoretical variance of the antithetic variables is 0.003912497,the sd is 0.0621996,the empirical estimate of the percent reduction in variance using the antithetic variate is 87.24%.</p>
</div>
<div id="question-35.11" class="section level3">
<h3>Question 3(5.11)</h3>
<p>If <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_1\)</span> are antithetic, we derived that <span class="math inline">\(c^*=\frac 12\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta}_c = c\hat{\theta}_1 + (1 − c)\hat{\theta}_2\)</span>. Derive <span class="math inline">\(c^*\)</span> for the general case. That is, if <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are any two unbiased estimators of θ, find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta}_c = c\hat{\theta}_1 + (1 − c)\hat{\theta}_2\)</span>in equation (5.11). (<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="answer-3" class="section level3">
<h3>Answer</h3>
<p>The equation (5.11) is <span class="math display">\[
Var(\hat{\theta}_c)=Var(\hat{\theta}_2)+c^2Var(\hat{\theta}_1-\hat{\theta}_2)+2cCov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)
\]</span> For <span class="math inline">\(\forall\)</span> random variable <span class="math inline">\(X\)</span>,<span class="math inline">\(Var(X)\geq 0\)</span>.In general case,<span class="math inline">\(Var(X)\not =0\)</span>,so <span class="math inline">\(Var(X)&gt;0\)</span>.So <span class="math display">\[
Var(\hat{\theta}_c)=Var(\hat{\theta}_1-\hat{\theta}_2)[c+\frac{Cov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)}{Var(\hat{\theta}_1-\hat{\theta}_2)}]^2+Var(\hat{\theta}_2)-\frac{[Cov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)]^2}{Var(\hat{\theta}_1-\hat{\theta}_2)}
\]</span> So when <span class="math inline">\(c+\frac{Cov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)}{Var(\hat{\theta}_1-\hat{\theta}_2)}=0\)</span>,<span class="math inline">\(Var(\hat{\theta}_c)\)</span> can get the minimum value<span class="math inline">\(Var(\hat{\theta}_2)-\frac{[Cov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)]^2}{Var(\hat{\theta}_1-\hat{\theta}_2)}\)</span>.So <span class="math display">\[
c^*=-\frac{Cov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)}{Var(\hat{\theta}_1-\hat{\theta}_2)}=\frac{Var(\hat{\theta}_2,\hat{\theta}_2)-Cov(\hat{\theta}_2,\hat{\theta}_1)}{Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_2,\hat{\theta}_1)}
\]</span></p>
</div>
</div>
<div id="section-3" class="section level1">
<h1>2020-10-20</h1>
<div id="question-1" class="section level3">
<h3>Question 1</h3>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}},x&gt;1
\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[
\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx
\]</span> by importance sampling? Explain</p>
</div>
<div id="answer-4" class="section level3">
<h3>Answer</h3>
<p><span class="math display">\[
f_1(x)=I(x&gt;1)\frac{xe^{-\frac{x^2}{2}}}{e^{-\frac 12}}=I(x&gt;1)e^{\frac 12}xe^{-\frac{x^2}{2}}
\]</span> So <span class="math display">\[
\int_{1}^{\infty} f_1(x)dx=-e^{\frac 12}e^{-\frac{x^2}{2}}|_{x=1}^{x=\infty}=1
\]</span></p>
<p><span class="math display">\[
f_2(x)=I(x&gt;1)\frac{e}{5}x^2e^{-x}
\]</span> And <span class="math display">\[
\int_{1}^{\infty}f_2(x)dx=\int_{1}^{\infty}\frac{e}{5}x^2e^{-x}dx
=1\]</span></p>
<p><span class="math display">\[
\frac{g(x)}{f_1(x)}=\frac{x}{\sqrt{2e\pi}},\frac{g(x)}{f_2(x)}=\frac{5}{\sqrt{2\pi}e}e^{x-\frac{x^2}{2}}
\]</span></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb31-4"><a href="#cb31-4"></a>gf_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb31-5"><a href="#cb31-5"></a>gf_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb31-6"><a href="#cb31-6"></a>gf1 &lt;-<span class="st"> </span><span class="cf">function</span>(z) {<span class="co">##function g/f1</span></span>
<span id="cb31-7"><a href="#cb31-7"></a>z<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>))</span>
<span id="cb31-8"><a href="#cb31-8"></a>}</span>
<span id="cb31-9"><a href="#cb31-9"></a>gf2 &lt;-<span class="st"> </span><span class="cf">function</span>(z) {<span class="co">##function g/f2</span></span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="dv">5</span><span class="op">*</span><span class="kw">exp</span>(z<span class="op">-</span>z<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="kw">exp</span>(<span class="dv">2</span>))</span>
<span id="cb31-11"><a href="#cb31-11"></a>}</span>
<span id="cb31-12"><a href="#cb31-12"></a>y &lt;-<span class="st"> </span><span class="kw">runif</span>(n)<span class="co">##y~U(0,1)</span></span>
<span id="cb31-13"><a href="#cb31-13"></a>x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>y<span class="co">##x~U(1,\infty)</span></span>
<span id="cb31-14"><a href="#cb31-14"></a>gf_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">gf1</span>(x)</span>
<span id="cb31-15"><a href="#cb31-15"></a>gf_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">gf2</span>(x)</span>
<span id="cb31-16"><a href="#cb31-16"></a>theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(gf_<span class="dv">1</span>)</span>
<span id="cb31-17"><a href="#cb31-17"></a>theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(gf_<span class="dv">2</span>)</span>
<span id="cb31-18"><a href="#cb31-18"></a>se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(gf_<span class="dv">1</span>)</span>
<span id="cb31-19"><a href="#cb31-19"></a>se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(gf_<span class="dv">2</span>)</span>
<span id="cb31-20"><a href="#cb31-20"></a><span class="kw">rbind</span>(theta.hat, se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat  2.206505 0.6231456
## se        31.191573 0.4968159</code></pre>
<p>the variance of <span class="math inline">\(gf_2\)</span> is smaller than <span class="math inline">\(gf_1\)</span>,the <span class="math inline">\(gf_2\)</span> is better choice.</p>
</div>
<div id="question-2" class="section level3">
<h3>Question 2</h3>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-5" class="section level3">
<h3>Answer</h3>
<p>In each interval <span class="math inline">\((\frac{k-1}{5},\frac{k}{5}),k=1,2,3,4,5\)</span> <span class="math display">\[
h_k(x)=I(\frac{k-1}{5}&lt;x&lt;\frac{k}{5})\frac{e^{-x}}{e^{-\frac{k-1}{5}}-e^{-\frac{k}{5}}},k=1,2,3,4,5
\]</span> So the integral <span class="math display">\[
\int_{\frac{k-1}{5}}^{\frac{k}{5}}h_k(x)dx=\frac{1}{e^{-\frac{k-1}{5}}-e^{-\frac{k}{5}}}\int_{\frac{k-1}{5}}^{\frac{k}{5}}e^{-x}dx=1
\]</span> <span class="math display">\[
\frac{g(x)}{h_k(x)}=\frac{e^{-\frac{k-1}{5}}-e^{-\frac{k}{5}}}{1+x^2}
\]</span></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>M &lt;-<span class="st"> </span><span class="dv">50000</span><span class="co">##number of replicates</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>theta.hat &lt;-<span class="st"> </span>var.hat&lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb33-4"><a href="#cb33-4"></a>h &lt;-<span class="st"> </span><span class="cf">function</span>(x,k){(<span class="kw">exp</span>(<span class="op">-</span>(k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>(k)<span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)}<span class="co">##importance function on each subinterval</span></span>
<span id="cb33-5"><a href="#cb33-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</span>
<span id="cb33-6"><a href="#cb33-6"></a>  x &lt;-<span class="st"> </span><span class="kw">runif</span>(M<span class="op">/</span><span class="dv">5</span>, (i<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>, i<span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb33-7"><a href="#cb33-7"></a>  y &lt;-<span class="st"> </span><span class="kw">h</span>(x,i)</span>
<span id="cb33-8"><a href="#cb33-8"></a>  theta.hat[i]=<span class="kw">mean</span>(y)<span class="co">##the estimate on each subinterval</span></span>
<span id="cb33-9"><a href="#cb33-9"></a>  var.hat[i]=<span class="kw">var</span>(y)<span class="co">##the variance on each subinterval</span></span>
<span id="cb33-10"><a href="#cb33-10"></a>}</span>
<span id="cb33-11"><a href="#cb33-11"></a>theta_hat=<span class="kw">sum</span>(theta.hat)</span>
<span id="cb33-12"><a href="#cb33-12"></a>var_hat=<span class="kw">sum</span>(var.hat)</span>
<span id="cb33-13"><a href="#cb33-13"></a>theta_hat<span class="co">##output the estimate</span></span></code></pre></div>
<pre><code>## [1] 0.5238734</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>var_hat<span class="co">##output the variance</span></span></code></pre></div>
<pre><code>## [1] 6.245897e-05</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">sqrt</span>(var_hat)<span class="co">##the standard deviation</span></span></code></pre></div>
<pre><code>## [1] 0.007903099</code></pre>
<p>The standard deviation of stratified smportance sampling is 0.007919952,which is smaller than the standard deviation 0.09658794 in Example 5.10</p>
</div>
<div id="question-3" class="section level3">
<h3>Question 3</h3>
<p>Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-6" class="section level3">
<h3>Answer</h3>
<p><span class="math inline">\(X\)</span>：lognormal distribution,<span class="math inline">\(\ln X\sim N(\mu,\sigma^2)\)</span>,the pdf is <span class="math display">\[
f(x;\mu,\sigma)=I(x&gt;0)\frac{1}{x\sqrt{2\pi}\sigma}e^{-\frac{(\ln x-\mu)^2}{2\sigma^2}}
\]</span> As <span class="math inline">\(\ln X\sim N(\mu,\sigma^2)\)</span> and <span class="math inline">\(\sigma^2\)</span> is unkown,mark<span class="math inline">\(Y=\ln X\sim N(\mu,\sigma^2)\)</span>.</p>
<p>According to the knowledge from mathematical statistics,mark <span class="math inline">\(S_Y\)</span> <span class="math display">\[
S_Y^2=\frac{1}{n-1}\sum_{i=1}^{n}(Y_i-\overline{Y})^2
\]</span> So the variable <span class="math inline">\(T\)</span> <span class="math display">\[
T=\frac{\sqrt{n}(\overline{Y}-\mu)}{S_Y}\sim t_{n-1}
\]</span> <span class="math display">\[
P(|T|\leq c)=P(-c\leq \frac{\sqrt{n}(\overline{Y}-\mu)}{S_Y}\leq c)=1-\alpha
\]</span> If <span class="math inline">\(c=t_{n-1}(\frac{\alpha}{2})\)</span>,the <span class="math inline">\(1-\alpha\)</span> confidence interval for the parameter <span class="math inline">\(\mu\)</span> is <span class="math display">\[
\left[\overline{Y}-\frac{S_Y}{\sqrt{n}}t_{n-1}(\frac{\alpha}{2}),\overline{Y}+\frac{S_Y}{\sqrt{n}}t_{n-1}(\frac{\alpha}{2}) \right]
\]</span> And<span class="math inline">\(P(t_{n-1}&gt;t_{n-1}(\alpha))=\alpha\)</span></p>
<p>When <span class="math inline">\(\alpha=0.05\)</span>,the 95% confidence interval is <span class="math display">\[
\left[\overline{Y}-\frac{S_Y}{\sqrt{n}}t_{n-1}(0.025),\overline{Y}+\frac{S_Y}{\sqrt{n}}t_{n-1}(0.025) \right]
\]</span></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb39-2"><a href="#cb39-2"></a>n &lt;-<span class="st"> </span><span class="dv">25</span><span class="co">##Sample size of each experiments</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span><span class="co">##Number of experiments</span></span>
<span id="cb39-4"><a href="#cb39-4"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb39-5"><a href="#cb39-5"></a>Y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">0</span>) ,<span class="dt">nrow=</span>m , <span class="dt">ncol=</span>n)</span>
<span id="cb39-6"><a href="#cb39-6"></a>t &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>(alpha<span class="op">/</span><span class="dv">2</span>),n<span class="dv">-1</span>)<span class="co">##t(alpha/2),use qt function</span></span>
<span id="cb39-7"><a href="#cb39-7"></a>te &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>m)<span class="co">## te=1 if mu in confidence region,else te=0</span></span>
<span id="cb39-8"><a href="#cb39-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb39-9"><a href="#cb39-9"></a>  Y[i,] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n , <span class="dt">mean=</span><span class="dv">0</span> , <span class="dt">sd=</span><span class="dv">1</span>)<span class="co">##normal distribution</span></span>
<span id="cb39-10"><a href="#cb39-10"></a>  mu &lt;-<span class="st"> </span><span class="kw">mean</span>(Y[i,]) </span>
<span id="cb39-11"><a href="#cb39-11"></a>  se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(Y[i,]))</span>
<span id="cb39-12"><a href="#cb39-12"></a>  min_Y &lt;-<span class="st"> </span>mu<span class="op">-</span>se<span class="op">*</span>t<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="co">##lower limit of confidence region</span></span>
<span id="cb39-13"><a href="#cb39-13"></a>  max_Y &lt;-<span class="st"> </span>mu<span class="op">+</span>se<span class="op">*</span>t<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="co">##upper limit of confidence region</span></span>
<span id="cb39-14"><a href="#cb39-14"></a>  <span class="cf">if</span>(<span class="dv">0</span><span class="op">&lt;</span>min_Y) {te[i]=<span class="dv">0</span>}</span>
<span id="cb39-15"><a href="#cb39-15"></a>  <span class="cf">else</span> <span class="cf">if</span>(<span class="dv">0</span><span class="op">&gt;</span>max_Y) {te[i]=<span class="dv">0</span>}</span>
<span id="cb39-16"><a href="#cb39-16"></a>  <span class="cf">else</span> {te[i]=<span class="dv">1</span>}<span class="co">## te=1 if mu in confidence region,else te=0</span></span>
<span id="cb39-17"><a href="#cb39-17"></a>}</span>
<span id="cb39-18"><a href="#cb39-18"></a>conlevel &lt;-<span class="st"> </span><span class="kw">mean</span>(te)<span class="co">##empirical estimate of the confidence level</span></span>
<span id="cb39-19"><a href="#cb39-19"></a><span class="kw">print</span>(conlevel)<span class="co">##print empirical estimate of the confidence level</span></span></code></pre></div>
<pre><code>## [1] 0.9447</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">cat</span>(<span class="st">&quot;[&quot;</span>,min_Y,<span class="st">&quot;,&quot;</span>,max_Y,<span class="st">&quot;]&quot;</span>) <span class="co">##One of the confidence levels</span></span></code></pre></div>
<pre><code>## [ -0.0966212 , 0.6970358 ]</code></pre>
<p>The empirical estimate of the confidence level is 0.9447,here is a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. <span class="math display">\[
[-0.0966212,0.6970358]
\]</span></p>
</div>
<div id="question-4" class="section level3">
<h3>Question 4</h3>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-7" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb43-2"><a href="#cb43-2"></a>n &lt;-<span class="st"> </span><span class="dv">20</span><span class="co">##Sample size of each experiments</span></span>
<span id="cb43-3"><a href="#cb43-3"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span><span class="co">##Number of experiments</span></span>
<span id="cb43-4"><a href="#cb43-4"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb43-5"><a href="#cb43-5"></a>Y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">0</span>) ,<span class="dt">nrow=</span>m , <span class="dt">ncol=</span>n)</span>
<span id="cb43-6"><a href="#cb43-6"></a>t &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>(alpha<span class="op">/</span><span class="dv">2</span>),n<span class="dv">-1</span>)<span class="co">##t(alpha/2),use qt function</span></span>
<span id="cb43-7"><a href="#cb43-7"></a>te &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>m)<span class="co">## te=1 if mu in confidence region,else te=0</span></span>
<span id="cb43-8"><a href="#cb43-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb43-9"><a href="#cb43-9"></a>  Y[i,] &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n , <span class="dt">df=</span><span class="dv">2</span>)<span class="co">##chi-square distribution</span></span>
<span id="cb43-10"><a href="#cb43-10"></a>  mu &lt;-<span class="st"> </span><span class="kw">mean</span>(Y[i,]) </span>
<span id="cb43-11"><a href="#cb43-11"></a>  se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(Y[i,]))</span>
<span id="cb43-12"><a href="#cb43-12"></a>  min_Y &lt;-<span class="st"> </span>mu<span class="op">-</span>se<span class="op">*</span>t<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="co">##lower limit of confidence region</span></span>
<span id="cb43-13"><a href="#cb43-13"></a>  max_Y &lt;-<span class="st"> </span>mu<span class="op">+</span>se<span class="op">*</span>t<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="co">##upper limit of confidence region</span></span>
<span id="cb43-14"><a href="#cb43-14"></a>  <span class="cf">if</span>(<span class="dv">2</span><span class="op">&lt;</span>min_Y) {te[i]=<span class="dv">0</span>}</span>
<span id="cb43-15"><a href="#cb43-15"></a>  <span class="cf">else</span> <span class="cf">if</span>(<span class="dv">2</span><span class="op">&gt;</span>max_Y) {te[i]=<span class="dv">0</span>}</span>
<span id="cb43-16"><a href="#cb43-16"></a>  <span class="cf">else</span> {te[i]=<span class="dv">1</span>}<span class="co">## te=1 if mu in confidence region,else te=0</span></span>
<span id="cb43-17"><a href="#cb43-17"></a>}</span>
<span id="cb43-18"><a href="#cb43-18"></a>conlevel &lt;-<span class="st"> </span><span class="kw">mean</span>(te)<span class="co">##t-interval results</span></span>
<span id="cb43-19"><a href="#cb43-19"></a><span class="kw">print</span>(conlevel)<span class="co">##print t-interval results</span></span></code></pre></div>
<pre><code>## [1] 0.9173</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb45-2"><a href="#cb45-2"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span><span class="co">##Number of experiments</span></span>
<span id="cb45-3"><a href="#cb45-3"></a>n &lt;-<span class="st"> </span><span class="dv">20</span><span class="co">##Sample size of each experiments</span></span>
<span id="cb45-4"><a href="#cb45-4"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb45-5"><a href="#cb45-5"></a>test &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb45-6"><a href="#cb45-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb45-7"><a href="#cb45-7"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">2</span>)<span class="co">##normal distribution</span></span>
<span id="cb45-8"><a href="#cb45-8"></a>  UCL &lt;-<span class="st"> </span>(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df=</span>n<span class="dv">-1</span>)<span class="co">## the upper confidence limit</span></span>
<span id="cb45-9"><a href="#cb45-9"></a>  <span class="cf">if</span>(<span class="dv">4</span><span class="op">&lt;</span>UCL) test[i]&lt;-<span class="dv">1</span></span>
<span id="cb45-10"><a href="#cb45-10"></a>  <span class="cf">else</span> test[i]&lt;-<span class="dv">0</span><span class="co">## te=1 if mu in confidence region,else te=0</span></span>
<span id="cb45-11"><a href="#cb45-11"></a>}</span>
<span id="cb45-12"><a href="#cb45-12"></a>t&lt;-<span class="kw">mean</span>(test)</span>
<span id="cb45-13"><a href="#cb45-13"></a>t<span class="co">##simulation results in Example 6.4</span></span></code></pre></div>
<pre><code>## [1] 0.9456</code></pre>
<p>Simulation results is 0.9456,t-interval results is 0.9173.The t-interval is more robust to departures from normality than the interval for variance.</p>
</div>
</div>
<div id="section-4" class="section level1">
<h1>2020-10-27</h1>
<div id="question-16.7" class="section level3">
<h3>Question 1(6.7)</h3>
<p>Estimate the power of the skewness test of normality against symmetric Beta<span class="math inline">\((\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
</div>
<div id="answer-8" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb47-2"><a href="#cb47-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb47-3"><a href="#cb47-3"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb47-4"><a href="#cb47-4"></a>n &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co">##Sample size</span></span>
<span id="cb47-5"><a href="#cb47-5"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="fl">0.05</span>,<span class="dv">1</span>,<span class="fl">0.05</span>),<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">97</span>,<span class="dv">4</span>))<span class="co">##parameter of beta distribution</span></span>
<span id="cb47-6"><a href="#cb47-6"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(a)</span>
<span id="cb47-7"><a href="#cb47-7"></a>power_sk &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb47-8"><a href="#cb47-8"></a>power_t &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb47-9"><a href="#cb47-9"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb47-10"><a href="#cb47-10"></a>cv_t &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha,n<span class="dv">-1</span>)</span>
<span id="cb47-11"><a href="#cb47-11"></a></span>
<span id="cb47-12"><a href="#cb47-12"></a>skew &lt;-<span class="st"> </span><span class="cf">function</span>(y){</span>
<span id="cb47-13"><a href="#cb47-13"></a>  mean_y &lt;-<span class="st"> </span><span class="kw">mean</span> (y)</span>
<span id="cb47-14"><a href="#cb47-14"></a>  m_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">mean</span>((y<span class="op">-</span>mean_y)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb47-15"><a href="#cb47-15"></a>  m_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">mean</span>((y<span class="op">-</span>mean_y)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb47-16"><a href="#cb47-16"></a>  <span class="kw">return</span>(<span class="kw">sqrt</span>(((m_<span class="dv">3</span>)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>((m_<span class="dv">2</span>)<span class="op">^</span><span class="dv">3</span>)))</span>
<span id="cb47-17"><a href="#cb47-17"></a>}</span>
<span id="cb47-18"><a href="#cb47-18"></a></span>
<span id="cb47-19"><a href="#cb47-19"></a>ft &lt;-<span class="st"> </span><span class="cf">function</span>(z){</span>
<span id="cb47-20"><a href="#cb47-20"></a>  m1&lt;-<span class="kw">mean</span>(z)</span>
<span id="cb47-21"><a href="#cb47-21"></a>  m2&lt;-<span class="kw">mean</span>((z<span class="op">-</span>m1)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb47-22"><a href="#cb47-22"></a>  <span class="kw">return</span>(<span class="kw">sqrt</span>(<span class="dv">20</span><span class="op">/</span>m2)<span class="op">*</span>(m1<span class="fl">-0.5</span>))</span>
<span id="cb47-23"><a href="#cb47-23"></a>}</span>
<span id="cb47-24"><a href="#cb47-24"></a></span>
<span id="cb47-25"><a href="#cb47-25"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </span>
<span id="cb47-26"><a href="#cb47-26"></a>para &lt;-<span class="st"> </span>a[j]</span>
<span id="cb47-27"><a href="#cb47-27"></a>sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb47-28"><a href="#cb47-28"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </span>
<span id="cb47-29"><a href="#cb47-29"></a>x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,para,para)</span>
<span id="cb47-30"><a href="#cb47-30"></a>sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">skew</span>(x)) <span class="op">&gt;</span><span class="st"> </span>cv)</span>
<span id="cb47-31"><a href="#cb47-31"></a>}</span>
<span id="cb47-32"><a href="#cb47-32"></a>power_sk[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb47-33"><a href="#cb47-33"></a></span>
<span id="cb47-34"><a href="#cb47-34"></a>}</span>
<span id="cb47-35"><a href="#cb47-35"></a></span>
<span id="cb47-36"><a href="#cb47-36"></a><span class="kw">plot</span>(a, power_sk, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb47-37"><a href="#cb47-37"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(a), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb47-38"><a href="#cb47-38"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb47-39"><a href="#cb47-39"></a>se_sk &lt;-<span class="st"> </span><span class="kw">sqrt</span>(power_sk <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>power_sk) <span class="op">/</span><span class="st"> </span>m) </span>
<span id="cb47-40"><a href="#cb47-40"></a><span class="kw">lines</span>(a, power_sk<span class="op">+</span>se_sk, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb47-41"><a href="#cb47-41"></a><span class="kw">lines</span>(a, power_sk<span class="op">-</span>se_sk, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </span>
<span id="cb48-2"><a href="#cb48-2"></a>para &lt;-<span class="st"> </span>a[j]</span>
<span id="cb48-3"><a href="#cb48-3"></a>t_test &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </span>
<span id="cb48-5"><a href="#cb48-5"></a>x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,para,para)</span>
<span id="cb48-6"><a href="#cb48-6"></a>t_test[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>( <span class="kw">ft</span>(x) <span class="op">&gt;</span><span class="st"> </span>cv_t)</span>
<span id="cb48-7"><a href="#cb48-7"></a>}</span>
<span id="cb48-8"><a href="#cb48-8"></a>power_t[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(t_test)</span>
<span id="cb48-9"><a href="#cb48-9"></a>}</span>
<span id="cb48-10"><a href="#cb48-10"></a></span>
<span id="cb48-11"><a href="#cb48-11"></a><span class="kw">plot</span>(a, power_t, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb48-12"><a href="#cb48-12"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(a), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb48-13"><a href="#cb48-13"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb48-14"><a href="#cb48-14"></a>se_t &lt;-<span class="st"> </span><span class="kw">sqrt</span>(power_t <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>power_t) <span class="op">/</span><span class="st"> </span>m) </span>
<span id="cb48-15"><a href="#cb48-15"></a><span class="kw">lines</span>(a, power_t<span class="op">+</span>se_t, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb48-16"><a href="#cb48-16"></a><span class="kw">lines</span>(a, power_t<span class="op">-</span>se_t, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Comment:the power don’t change a lot with the change of parameter.</p>
<p>The result is a little similar to the result in t test.</p>
</div>
<div id="question-16.8" class="section level3">
<h3>Question 1(6.8)</h3>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat{\alpha}=\)</span> 0.055. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-9" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb49-2"><a href="#cb49-2"></a>m&lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb49-3"><a href="#cb49-3"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">500</span>)</span>
<span id="cb49-4"><a href="#cb49-4"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.055</span></span>
<span id="cb49-5"><a href="#cb49-5"></a></span>
<span id="cb49-6"><a href="#cb49-6"></a>c5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb49-7"><a href="#cb49-7"></a>X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb49-8"><a href="#cb49-8"></a>Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb49-9"><a href="#cb49-9"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb49-10"><a href="#cb49-10"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb49-11"><a href="#cb49-11"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb49-12"><a href="#cb49-12"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb49-13"><a href="#cb49-13"></a>}</span>
<span id="cb49-14"><a href="#cb49-14"></a></span>
<span id="cb49-15"><a href="#cb49-15"></a></span>
<span id="cb49-16"><a href="#cb49-16"></a></span>
<span id="cb49-17"><a href="#cb49-17"></a></span>
<span id="cb49-18"><a href="#cb49-18"></a>Ftest &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, i) {</span>
<span id="cb49-19"><a href="#cb49-19"></a>V_x  &lt;-<span class="st"> </span><span class="kw">var</span>(x)</span>
<span id="cb49-20"><a href="#cb49-20"></a>V_y  &lt;-<span class="st"> </span><span class="kw">var</span>(y)</span>
<span id="cb49-21"><a href="#cb49-21"></a>k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">500</span>)</span>
<span id="cb49-22"><a href="#cb49-22"></a>qF &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">qf</span>(<span class="dv">1</span><span class="op">-</span>alpha,k[<span class="dv">1</span>],k[<span class="dv">1</span>]),<span class="kw">qf</span>(<span class="dv">1</span><span class="op">-</span>alpha,k[<span class="dv">2</span>],k[<span class="dv">3</span>]),<span class="kw">qf</span>(<span class="dv">1</span><span class="op">-</span>alpha,k[<span class="dv">3</span>],k[<span class="dv">3</span>]))</span>
<span id="cb49-23"><a href="#cb49-23"></a><span class="kw">return</span>(<span class="kw">as.integer</span>( V_x<span class="op">/</span>V_y <span class="op">&gt;</span><span class="st"> </span>qF[i]))</span>
<span id="cb49-24"><a href="#cb49-24"></a>}</span>
<span id="cb49-25"><a href="#cb49-25"></a></span>
<span id="cb49-26"><a href="#cb49-26"></a></span>
<span id="cb49-27"><a href="#cb49-27"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb49-28"><a href="#cb49-28"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.1</span></span>
<span id="cb49-29"><a href="#cb49-29"></a>power_c5&lt;-<span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb49-30"><a href="#cb49-30"></a>power_F&lt;-<span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb49-31"><a href="#cb49-31"></a>pF&lt;-<span class="st"> </span>pc5&lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb49-32"><a href="#cb49-32"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</span>
<span id="cb49-33"><a href="#cb49-33"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb49-34"><a href="#cb49-34"></a>      x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb49-35"><a href="#cb49-35"></a>      y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma2)</span>
<span id="cb49-36"><a href="#cb49-36"></a>      pF[j] &lt;-<span class="st"> </span><span class="kw">Ftest</span>(x,y,i)</span>
<span id="cb49-37"><a href="#cb49-37"></a>      pc5[j] &lt;-<span class="st"> </span><span class="kw">c5test</span>(x,y)</span>
<span id="cb49-38"><a href="#cb49-38"></a>  }</span>
<span id="cb49-39"><a href="#cb49-39"></a>  power_c5[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(pc5)</span>
<span id="cb49-40"><a href="#cb49-40"></a>  power_F[i]&lt;-<span class="st"> </span><span class="kw">mean</span>(pF)</span>
<span id="cb49-41"><a href="#cb49-41"></a>}</span>
<span id="cb49-42"><a href="#cb49-42"></a><span class="kw">print</span>(power_c5)</span></code></pre></div>
<pre><code>## [1] 0.0677 0.1672 0.2883</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">print</span>(power_F)</span></code></pre></div>
<pre><code>## [1] 0.0240 0.0166 0.0000</code></pre>
</div>
<div id="question-16.c" class="section level3">
<h3>Question 1(6.c)</h3>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[
\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3
\]</span> Under normality, <span class="math inline">\(\beta_{1,d}\)</span> The multivariate skewness statistic is <span class="math display">\[
b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^{n}[(X_i-\overline{X})^T\hat{\Sigma}^{-1}(X_j-\overline{X})]^3
\]</span> where<span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d + 1)(d + 2)/6\)</span> degrees of freedom.</p>
</div>
<div id="answer-10" class="section level3">
<h3>Answer</h3>
<p>The maximum likelihood estimator of covariance is <span class="math display">\[
\hat{\Sigma}=\sum_{i=1}^n\frac {1}{n}(X_i-\overline{X})(X_i-\overline{X})^T
\]</span> Assume the dimension <span class="math inline">\(d\)</span> is 2,and <span class="math inline">\(X\)</span> is standard multivariate normal distribution.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">set.seed</span>(<span class="dv">2007</span>)</span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="kw">library</span>(<span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb53-3"><a href="#cb53-3"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb53-4"><a href="#cb53-4"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb53-5"><a href="#cb53-5"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb53-6"><a href="#cb53-6"></a>cv_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb53-7"><a href="#cb53-7"></a>cv_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">qchisq</span>(alpha<span class="op">/</span><span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb53-8"><a href="#cb53-8"></a>Sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb53-9"><a href="#cb53-9"></a></span>
<span id="cb53-10"><a href="#cb53-10"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,n){</span>
<span id="cb53-11"><a href="#cb53-11"></a>  l &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</span>
<span id="cb53-12"><a href="#cb53-12"></a>  x1 &lt;-<span class="st"> </span>x[,<span class="dv">1</span>]</span>
<span id="cb53-13"><a href="#cb53-13"></a>  x2 &lt;-<span class="st"> </span>x[,<span class="dv">2</span>]</span>
<span id="cb53-14"><a href="#cb53-14"></a>  mean_X1 &lt;-<span class="st"> </span><span class="kw">mean</span>(x1)</span>
<span id="cb53-15"><a href="#cb53-15"></a>  mean_X2 &lt;-<span class="st"> </span><span class="kw">mean</span>(x2)</span>
<span id="cb53-16"><a href="#cb53-16"></a>  m_<span class="dv">11</span> &lt;-<span class="st"> </span><span class="kw">sum</span>((x1<span class="op">-</span>mean_X1)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb53-17"><a href="#cb53-17"></a>  m_<span class="dv">12</span> &lt;-<span class="st"> </span><span class="kw">sum</span>((x1<span class="op">-</span>mean_X1)<span class="op">*</span>((x2<span class="op">-</span>mean_X2)))</span>
<span id="cb53-18"><a href="#cb53-18"></a>  m_<span class="dv">21</span> &lt;-<span class="st"> </span><span class="kw">sum</span>((x1<span class="op">-</span>mean_X1)<span class="op">*</span>(x2<span class="op">-</span>mean_X2))</span>
<span id="cb53-19"><a href="#cb53-19"></a>  m_<span class="dv">22</span> &lt;-<span class="st"> </span><span class="kw">sum</span>((x2<span class="op">-</span>mean_X2)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb53-20"><a href="#cb53-20"></a>  M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(m_<span class="dv">11</span>,m_<span class="dv">12</span>,m_<span class="dv">21</span>,m_<span class="dv">22</span>),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb53-21"><a href="#cb53-21"></a>  Mm&lt;-<span class="kw">solve</span>(M)<span class="co">##Inverse matrix</span></span>
<span id="cb53-22"><a href="#cb53-22"></a>  result &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb53-23"><a href="#cb53-23"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb53-24"><a href="#cb53-24"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb53-25"><a href="#cb53-25"></a>      a &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(x1[i]<span class="op">-</span>mean_X1,x2[i]<span class="op">-</span>mean_X2),<span class="dt">nrow=</span><span class="dv">1</span>,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb53-26"><a href="#cb53-26"></a>       b &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(x1[j]<span class="op">-</span>mean_X1,x2[j]<span class="op">-</span>mean_X2),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb53-27"><a href="#cb53-27"></a>       result &lt;-<span class="st"> </span>result<span class="op">+</span>a<span class="op">%*%</span>Mm<span class="op">%*%</span>b </span>
<span id="cb53-28"><a href="#cb53-28"></a>    }</span>
<span id="cb53-29"><a href="#cb53-29"></a>  }</span>
<span id="cb53-30"><a href="#cb53-30"></a>  <span class="kw">return</span>(result)</span>
<span id="cb53-31"><a href="#cb53-31"></a>}</span>
<span id="cb53-32"><a href="#cb53-32"></a></span>
<span id="cb53-33"><a href="#cb53-33"></a>re&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb53-34"><a href="#cb53-34"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb53-35"><a href="#cb53-35"></a>  x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dt">n=</span><span class="dv">20</span>, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), Sigma)</span>
<span id="cb53-36"><a href="#cb53-36"></a>  ske &lt;-<span class="st"> </span><span class="kw">sk</span>(x,n)</span>
<span id="cb53-37"><a href="#cb53-37"></a>  <span class="cf">if</span>(ske<span class="op">&gt;</span>cv_<span class="dv">1</span>) {re[j]=<span class="dv">1</span>}</span>
<span id="cb53-38"><a href="#cb53-38"></a>  <span class="cf">else</span> <span class="cf">if</span>(ske<span class="op">&lt;</span>cv_<span class="dv">2</span>) {re[j]=<span class="dv">1</span>}</span>
<span id="cb53-39"><a href="#cb53-39"></a>  <span class="cf">else</span> {re[j]=<span class="dv">0</span>}</span>
<span id="cb53-40"><a href="#cb53-40"></a>}</span>
<span id="cb53-41"><a href="#cb53-41"></a>p &lt;-<span class="st"> </span><span class="kw">mean</span>(ske)</span>
<span id="cb53-42"><a href="#cb53-42"></a><span class="kw">print</span>(p)</span></code></pre></div>
<pre><code>## [1] 1.266348e-16</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>para &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">9</span>,<span class="dv">11</span>,<span class="fl">0.1</span>)<span class="co">##parameter change</span></span>
<span id="cb55-2"><a href="#cb55-2"></a>lp &lt;-<span class="st"> </span><span class="kw">length</span>(para)</span>
<span id="cb55-3"><a href="#cb55-3"></a>power &lt;-<span class="st"> </span><span class="kw">numeric</span>(lp)</span>
<span id="cb55-4"><a href="#cb55-4"></a></span>
<span id="cb55-5"><a href="#cb55-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>lp){</span>
<span id="cb55-6"><a href="#cb55-6"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb55-7"><a href="#cb55-7"></a>  x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dt">n=</span><span class="dv">20</span>, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="kw">matrix</span>(<span class="kw">c</span>(para[i],<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>),<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb55-8"><a href="#cb55-8"></a>  ske &lt;-<span class="st"> </span><span class="kw">sk</span>(x,n)</span>
<span id="cb55-9"><a href="#cb55-9"></a>  <span class="cf">if</span>(ske<span class="op">&gt;</span>cv_<span class="dv">1</span>) {re[j]=<span class="dv">1</span>}</span>
<span id="cb55-10"><a href="#cb55-10"></a>  <span class="cf">else</span> <span class="cf">if</span>(ske<span class="op">&lt;</span>cv_<span class="dv">2</span>) {re[j]=<span class="dv">1</span>}</span>
<span id="cb55-11"><a href="#cb55-11"></a>  <span class="cf">else</span> {re[j]=<span class="dv">0</span>}</span>
<span id="cb55-12"><a href="#cb55-12"></a>}</span>
<span id="cb55-13"><a href="#cb55-13"></a>power[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(ske)</span>
<span id="cb55-14"><a href="#cb55-14"></a>}</span>
<span id="cb55-15"><a href="#cb55-15"></a></span>
<span id="cb55-16"><a href="#cb55-16"></a><span class="co">##Curve</span></span>
<span id="cb55-17"><a href="#cb55-17"></a><span class="kw">plot</span>(para, power, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb55-18"><a href="#cb55-18"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(para), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb55-19"><a href="#cb55-19"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb55-20"><a href="#cb55-20"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(power <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>power) <span class="op">/</span><span class="st"> </span>m) </span></code></pre></div>
<pre><code>## Warning in sqrt(power * (1 - power)/m): 产生了NaNs</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="kw">lines</span>(para, power<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="kw">lines</span>(para, power<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-4-1" class="section level3">
<h3>Question 4</h3>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<p>(a)What is the corresponding hypothesis test problem?</p>
<p>(b)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p>
<p>(c)What information is needed to test your hypothesis?</p>
</div>
<div id="answer-a" class="section level3">
<h3>Answer (a)</h3>
<p><span class="math display">\[
\text{$H_0$:the powers of two sample are different}\Longleftrightarrow\text{$H_1$:the powers of two sample are same}
\]</span> the significance level is 0.05</p>
</div>
<div id="answer-b" class="section level3">
<h3>Answer (b)</h3>
<p>As we can not that two samples are independant,it’s better to use McNemar test.</p>
</div>
<div id="answer-c" class="section level3">
<h3>Answer (c)</h3>
<p>Only need to know the power 0.651 and 0.676.</p>
</div>
</div>
<div id="section-5" class="section level1">
<h1>2020-11-3</h1>
<div id="question1-7.1" class="section level3">
<h3>Question1 (7.1)</h3>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-11" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="kw">library</span>(bootstrap)<span class="co">##the data of law</span></span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;bootstrap&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(law)</span>
<span id="cb60-2"><a href="#cb60-2"></a>cor_j &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb60-3"><a href="#cb60-3"></a>cor_hat &lt;-<span class="st"> </span><span class="kw">cor</span>(law<span class="op">$</span>LSAT,law<span class="op">$</span>GPA)</span>
<span id="cb60-4"><a href="#cb60-4"></a></span>
<span id="cb60-5"><a href="#cb60-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){<span class="co">##Jackknife Sample</span></span>
<span id="cb60-6"><a href="#cb60-6"></a>  law_j &lt;-<span class="st"> </span>law[<span class="op">-</span>i,]</span>
<span id="cb60-7"><a href="#cb60-7"></a>  cor_j[i] &lt;-<span class="kw">cor</span>(law_j<span class="op">$</span>LSAT,law_j<span class="op">$</span>GPA)</span>
<span id="cb60-8"><a href="#cb60-8"></a>}</span>
<span id="cb60-9"><a href="#cb60-9"></a></span>
<span id="cb60-10"><a href="#cb60-10"></a>cor_jack &lt;-<span class="st"> </span><span class="kw">mean</span>(cor_j)</span>
<span id="cb60-11"><a href="#cb60-11"></a>bias_jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(cor_jack<span class="op">-</span>cor_hat)</span>
<span id="cb60-12"><a href="#cb60-12"></a>se_jack &lt;-<span class="st">  </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">/</span>n<span class="op">*</span><span class="kw">sum</span>((cor_j<span class="op">-</span>cor_jack)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb60-13"><a href="#cb60-13"></a></span>
<span id="cb60-14"><a href="#cb60-14"></a></span>
<span id="cb60-15"><a href="#cb60-15"></a>result&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(cor_jack,bias_jack,se_jack),<span class="dt">nrow=</span><span class="dv">1</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb60-16"><a href="#cb60-16"></a><span class="kw">rownames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Jackknife&#39;</span>)</span>
<span id="cb60-17"><a href="#cb60-17"></a><span class="kw">colnames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;estimate&#39;</span>,<span class="st">&#39;bias&#39;</span>, <span class="st">&#39;se&#39;</span>)</span>
<span id="cb60-18"><a href="#cb60-18"></a>result</span></code></pre></div>
<pre><code>##            estimate         bias        se
## Jackknife 0.7759121 -0.006473623 0.1425186</code></pre>
</div>
<div id="question2-7.5" class="section level3">
<h3>Question2 (7.5)</h3>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(\frac{1}{\lambda}\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-12" class="section level3">
<h3>Answer</h3>
<p>Compute the Maximum Likelihood Estimate of <span class="math inline">\(\lambda\)</span> <span class="math display">\[
l(X;\lambda)=\ln L(X;\lambda)=\sum_{i=1}^n \ln f(x_i;\lambda)=n\ln\lambda-\sum_{i=1}^n \lambda x_i
\]</span> <span class="math display">\[
 \frac{\partial l}{\partial \lambda}=\frac{n}{\lambda}-\sum_{i=1}^nx_i
\]</span> if <span class="math inline">\(\frac{\partial l}{\partial \lambda}=0\)</span>,then <span class="math display">\[
\hat{\lambda}_{MLE}=\frac{1}{\overline{X}}
\]</span> So the estimate of <span class="math inline">\(\frac{1}{\lambda}\)</span> is <span class="math display">\[
\hat{(\frac{1}{\lambda})}=\overline{X}
\]</span></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="kw">library</span>(boot)<span class="co">##the data of aircondit</span></span>
<span id="cb62-3"><a href="#cb62-3"></a>B &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb62-4"><a href="#cb62-4"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span> </span>
<span id="cb62-5"><a href="#cb62-5"></a>len &lt;-<span class="st"> </span><span class="kw">nrow</span>(aircondit)</span>
<span id="cb62-6"><a href="#cb62-6"></a>air &lt;-<span class="st"> </span><span class="kw">numeric</span>(len)</span>
<span id="cb62-7"><a href="#cb62-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len){</span>
<span id="cb62-8"><a href="#cb62-8"></a>  air[i] &lt;-<span class="st"> </span>aircondit[i,]</span>
<span id="cb62-9"><a href="#cb62-9"></a>}</span>
<span id="cb62-10"><a href="#cb62-10"></a>time_boot&lt;-<span class="kw">numeric</span>(B)</span>
<span id="cb62-11"><a href="#cb62-11"></a>time_hat&lt;-<span class="kw">mean</span>(air)</span>
<span id="cb62-12"><a href="#cb62-12"></a></span>
<span id="cb62-13"><a href="#cb62-13"></a></span>
<span id="cb62-14"><a href="#cb62-14"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</span>
<span id="cb62-15"><a href="#cb62-15"></a>  air_boot&lt;-<span class="st"> </span><span class="kw">sample</span>(air,len,<span class="dt">replace=</span><span class="ot">TRUE</span>)</span>
<span id="cb62-16"><a href="#cb62-16"></a>  time_boot[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(air_boot)</span>
<span id="cb62-17"><a href="#cb62-17"></a>}<span class="co">## the Bootstrap sample</span></span>
<span id="cb62-18"><a href="#cb62-18"></a></span>
<span id="cb62-19"><a href="#cb62-19"></a></span>
<span id="cb62-20"><a href="#cb62-20"></a>boot.n &lt;-<span class="st"> </span><span class="cf">function</span>(th,th_hat,conf){<span class="co">## normal confidence interval </span></span>
<span id="cb62-21"><a href="#cb62-21"></a>  se_hat &lt;-<span class="st"> </span><span class="kw">sd</span>(th)</span>
<span id="cb62-22"><a href="#cb62-22"></a>  z &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>conf<span class="op">/</span><span class="dv">2</span>,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</span>
<span id="cb62-23"><a href="#cb62-23"></a>  result_norm&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(th_hat<span class="op">-</span>z<span class="op">*</span>se_hat,th_hat<span class="op">+</span>z<span class="op">*</span>se_hat),<span class="dt">nrow=</span><span class="dv">1</span>,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb62-24"><a href="#cb62-24"></a>  <span class="kw">colnames</span>(result_norm) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;0.025&#39;</span>,<span class="st">&#39;0.975&#39;</span>)</span>
<span id="cb62-25"><a href="#cb62-25"></a>  <span class="kw">rownames</span>(result_norm) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;norm&#39;</span>)</span>
<span id="cb62-26"><a href="#cb62-26"></a>  <span class="kw">print</span>(result_norm)</span>
<span id="cb62-27"><a href="#cb62-27"></a>}</span>
<span id="cb62-28"><a href="#cb62-28"></a></span>
<span id="cb62-29"><a href="#cb62-29"></a>boot.p &lt;-<span class="st"> </span><span class="cf">function</span>(th,conf) {<span class="co">##percentile confidence interval </span></span>
<span id="cb62-30"><a href="#cb62-30"></a><span class="kw">quantile</span>(th,<span class="dt">probs =</span> <span class="kw">c</span>((<span class="dv">1</span><span class="op">-</span>conf)<span class="op">/</span><span class="dv">2</span>,(<span class="dv">1</span><span class="op">+</span>conf)<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb62-31"><a href="#cb62-31"></a>} </span>
<span id="cb62-32"><a href="#cb62-32"></a></span>
<span id="cb62-33"><a href="#cb62-33"></a></span>
<span id="cb62-34"><a href="#cb62-34"></a>boot.b &lt;-<span class="st"> </span><span class="cf">function</span>(th,th_hat,conf) {<span class="co">##basic confidence interval </span></span>
<span id="cb62-35"><a href="#cb62-35"></a>  th_minus &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>th_hat<span class="op">-</span>th</span>
<span id="cb62-36"><a href="#cb62-36"></a>  <span class="kw">quantile</span>(th_minus,<span class="dt">probs=</span><span class="kw">c</span>((<span class="dv">1</span><span class="op">-</span>conf)<span class="op">/</span><span class="dv">2</span>,(<span class="dv">1</span><span class="op">+</span>conf)<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb62-37"><a href="#cb62-37"></a>} </span>
<span id="cb62-38"><a href="#cb62-38"></a></span>
<span id="cb62-39"><a href="#cb62-39"></a></span>
<span id="cb62-40"><a href="#cb62-40"></a>boot.BCa &lt;-<span class="co">##the BCa function from textbook</span></span>
<span id="cb62-41"><a href="#cb62-41"></a><span class="cf">function</span>(x, th0, th, stat, <span class="dt">conf =</span> <span class="fl">.95</span>) {</span>
<span id="cb62-42"><a href="#cb62-42"></a><span class="co"># bootstrap with BCa bootstrap confidence interval</span></span>
<span id="cb62-43"><a href="#cb62-43"></a><span class="co"># th0 is the observed statistic</span></span>
<span id="cb62-44"><a href="#cb62-44"></a><span class="co"># th is the vector of bootstrap replicates</span></span>
<span id="cb62-45"><a href="#cb62-45"></a><span class="co"># stat is the function to compute the statistic</span></span>
<span id="cb62-46"><a href="#cb62-46"></a>x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x)</span>
<span id="cb62-47"><a href="#cb62-47"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x) </span>
<span id="cb62-48"><a href="#cb62-48"></a>N &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>n</span>
<span id="cb62-49"><a href="#cb62-49"></a>alpha &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span>conf, conf))<span class="op">/</span><span class="dv">2</span></span>
<span id="cb62-50"><a href="#cb62-50"></a>zalpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(alpha)</span>
<span id="cb62-51"><a href="#cb62-51"></a>z0 &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="kw">sum</span>(th <span class="op">&lt;</span><span class="st"> </span>th0) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(th))</span>
<span id="cb62-52"><a href="#cb62-52"></a>th.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb62-53"><a href="#cb62-53"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb62-54"><a href="#cb62-54"></a>J &lt;-<span class="st"> </span>N[<span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)]</span>
<span id="cb62-55"><a href="#cb62-55"></a>th.jack[i] &lt;-<span class="st"> </span><span class="kw">stat</span>(x[<span class="op">-</span>i, ], J)</span>
<span id="cb62-56"><a href="#cb62-56"></a>}</span>
<span id="cb62-57"><a href="#cb62-57"></a>L &lt;-<span class="st"> </span><span class="kw">mean</span>(th.jack) <span class="op">-</span><span class="st"> </span>th.jack</span>
<span id="cb62-58"><a href="#cb62-58"></a>a &lt;-<span class="st"> </span><span class="kw">sum</span>(L<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(<span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(L<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb62-59"><a href="#cb62-59"></a>adj.alpha &lt;-<span class="st"> </span><span class="kw">pnorm</span>(z0 <span class="op">+</span><span class="st"> </span>(z0<span class="op">+</span>zalpha)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>a<span class="op">*</span>(z0<span class="op">+</span>zalpha)))</span>
<span id="cb62-60"><a href="#cb62-60"></a>limits &lt;-<span class="st"> </span><span class="kw">quantile</span>(th, adj.alpha, <span class="dt">type=</span><span class="dv">6</span>)</span>
<span id="cb62-61"><a href="#cb62-61"></a><span class="kw">return</span>(<span class="kw">list</span>(<span class="st">&quot;est&quot;</span>=th0, <span class="st">&quot;BCa&quot;</span>=limits))</span>
<span id="cb62-62"><a href="#cb62-62"></a>}</span>
<span id="cb62-63"><a href="#cb62-63"></a></span>
<span id="cb62-64"><a href="#cb62-64"></a>time.boot &lt;-<span class="st"> </span><span class="cf">function</span>(dat, index){</span>
<span id="cb62-65"><a href="#cb62-65"></a><span class="co"># input: dat, data; index, a vector of the bootstrap index</span></span>
<span id="cb62-66"><a href="#cb62-66"></a><span class="co"># output: theta, the estimated theta using the bootstrap sample</span></span>
<span id="cb62-67"><a href="#cb62-67"></a>air.boot &lt;-<span class="st"> </span>dat[index]</span>
<span id="cb62-68"><a href="#cb62-68"></a>time.hat&lt;-<span class="kw">mean</span>(air.boot)</span>
<span id="cb62-69"><a href="#cb62-69"></a><span class="kw">return</span>(time.hat)</span>
<span id="cb62-70"><a href="#cb62-70"></a>}</span>
<span id="cb62-71"><a href="#cb62-71"></a></span>
<span id="cb62-72"><a href="#cb62-72"></a></span>
<span id="cb62-73"><a href="#cb62-73"></a></span>
<span id="cb62-74"><a href="#cb62-74"></a><span class="kw">boot.n</span>(time_boot,time_hat,<span class="dv">1</span><span class="op">-</span>alpha)<span class="co">##normal confidence interval </span></span></code></pre></div>
<pre><code>##         0.025    0.975
## norm 105.7206 110.4461</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">boot.p</span>(time_boot,<span class="dv">1</span><span class="op">-</span>alpha)<span class="co">##percentile confidence interval </span></span></code></pre></div>
<pre><code>##      2.5%     97.5% 
##  46.58333 191.66667</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="kw">boot.b</span>(time_boot,time_hat,<span class="dv">1</span><span class="op">-</span>alpha)<span class="co">##basic confidence interval </span></span></code></pre></div>
<pre><code>##     2.5%    97.5% 
##  24.5000 169.5833</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="kw">boot.BCa</span>(air,<span class="dt">th0 =</span> time_hat,<span class="dt">th =</span> time_boot,<span class="dt">stat =</span> time.boot)<span class="co">##BCa confidence interval </span></span></code></pre></div>
<pre><code>## $est
## [1] 108.0833
## 
## $BCa
##  6.60977% 99.56195% 
##  56.41667 222.69839</code></pre>
<p>As we can see,the length of normal confidence interval is smaller than the other three confidence intervals.In conclusion,the standard normal method is not a good choice.</p>
<p>These four methods have different purpose,they have different principle.As the methods are not same,the results are different.</p>
</div>
<div id="question3-7.8" class="section level3">
<h3>Question3 (7.8)</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-13" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="kw">library</span>(bootstrap) <span class="co">#for the score data</span></span>
<span id="cb70-3"><a href="#cb70-3"></a>B&lt;-<span class="dv">1000</span></span>
<span id="cb70-4"><a href="#cb70-4"></a>n&lt;-<span class="kw">nrow</span>(scor)</span>
<span id="cb70-5"><a href="#cb70-5"></a>m&lt;-<span class="kw">ncol</span>(scor)</span>
<span id="cb70-6"><a href="#cb70-6"></a>lambda_hat &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values</span>
<span id="cb70-7"><a href="#cb70-7"></a>theta_hat &lt;-<span class="st"> </span>lambda_hat[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda_hat)</span>
<span id="cb70-8"><a href="#cb70-8"></a></span>
<span id="cb70-9"><a href="#cb70-9"></a>theta_jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb70-10"><a href="#cb70-10"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb70-11"><a href="#cb70-11"></a>scor_jack &lt;-<span class="st"> </span>scor [<span class="op">-</span>i,]</span>
<span id="cb70-12"><a href="#cb70-12"></a>lambda_jack &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor_jack))<span class="op">$</span>values</span>
<span id="cb70-13"><a href="#cb70-13"></a>theta_jack[i] &lt;-<span class="st"> </span>lambda_jack[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda_jack)</span>
<span id="cb70-14"><a href="#cb70-14"></a>}</span>
<span id="cb70-15"><a href="#cb70-15"></a>bias_hat_jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta_jack) <span class="op">-</span><span class="st"> </span>theta_hat)</span>
<span id="cb70-16"><a href="#cb70-16"></a>se_hat_jack &lt;-<span class="st">  </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">/</span>n<span class="op">*</span><span class="kw">sum</span>((theta_jack<span class="op">-</span><span class="kw">mean</span>(theta_jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb70-17"><a href="#cb70-17"></a></span>
<span id="cb70-18"><a href="#cb70-18"></a>result&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">mean</span>(theta_jack),bias_hat_jack,se_hat_jack),<span class="dt">nrow=</span><span class="dv">1</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb70-19"><a href="#cb70-19"></a><span class="kw">rownames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Jackknife&#39;</span>)</span>
<span id="cb70-20"><a href="#cb70-20"></a><span class="kw">colnames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;estimate&#39;</span>,<span class="st">&#39;bias&#39;</span>, <span class="st">&#39;se&#39;</span>)</span>
<span id="cb70-21"><a href="#cb70-21"></a>result</span></code></pre></div>
<pre><code>##            estimate        bias         se
## Jackknife 0.6191273 0.001069139 0.04955231</code></pre>
</div>
<div id="question4-7.11" class="section level3">
<h3>Question4 (7.11)</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-14" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="kw">library</span>(DAAG); <span class="kw">attach</span>(ironslag)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;DAAG&#39;是用R版本4.0.3 来建造的</code></pre>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>) <span class="co">#sequence for plotting fits</span></span>
<span id="cb79-2"><a href="#cb79-2"></a>L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)</span>
<span id="cb79-3"><a href="#cb79-3"></a><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Linear&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb79-4"><a href="#cb79-4"></a>yhat1 &lt;-<span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</span>
<span id="cb79-5"><a href="#cb79-5"></a><span class="kw">lines</span>(a, yhat1, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Quadratic&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb80-3"><a href="#cb80-3"></a>yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span></span>
<span id="cb80-4"><a href="#cb80-4"></a><span class="kw">lines</span>(a, yhat2, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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z6fvtjnV4ITbr9znpzNBbjgg5Mar3DFIAvI+g6zbUX3BvE+crO6fgR+xZihww5c8Qm68KgJItndnqxc2hx3P43M/MZCnQSI/rYnfTSPYATd+LQZotDmwUTHa7ac5913u2sFX/VkfoKAmJuRa11Km0Xr9mJm2nuUxeShbXRMDUdEEZO+ku988+PzUZuDx9PWtj/UFadCvGhDtX+t5mSKnH2XicaN3raebP6lT9Y/Mul6Mn7A1uu636l2nn7OJ2414XKOAs56Bov4ua9/YvrPhz5e2ho5a5oBxBy4/honTjbHLezp+0WQViAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCgVQHyPx3GujfPA2U8uiBAuT4SJwIEtBJAtciWP+y+38qElVqmru63f9u1G3vxrmRRd3n1XWrLjQCSzyd9POx44nP3j+dI7bciof7+mSfQCRadpcibktu3AEjkxKu/++0b+bq5fxaJZN1/bzgLbfnNO5ljdxuAVJKqKG37n0yXU+mX6j/xuG4jnbU5t7uCWgegLklVA+oWYrMAUumsbSi6//eN16DTmc2oBukdtwHoHIMkIF3qESBlKRP6b6aJif7o+LRRgMTrU9X93McEpCxl5RG/1bgJQHocpEY2/HVbScaA1DhIJPa2CG8F0HpFgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCg/wN1MUdLdRK+nAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)</span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Exponential&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb81-3"><a href="#cb81-3"></a>logyhat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</span>
<span id="cb81-4"><a href="#cb81-4"></a>yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb81-5"><a href="#cb81-5"></a><span class="kw">lines</span>(a, yhat3, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(chemical))</span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="kw">plot</span>(<span class="kw">log</span>(chemical), <span class="kw">log</span>(magnetic), <span class="dt">main=</span><span class="st">&quot;Log-Log&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb82-3"><a href="#cb82-3"></a>logyhat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(a)</span>
<span id="cb82-4"><a href="#cb82-4"></a><span class="kw">lines</span>(<span class="kw">log</span>(a), logyhat4, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb83-3"><a href="#cb83-3"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb83-4"><a href="#cb83-4"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb83-5"><a href="#cb83-5"></a></span>
<span id="cb83-6"><a href="#cb83-6"></a>k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb83-7"><a href="#cb83-7"></a></span>
<span id="cb83-8"><a href="#cb83-8"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n) {</span>
<span id="cb83-9"><a href="#cb83-9"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(j<span class="dv">-1</span>)){</span>
<span id="cb83-10"><a href="#cb83-10"></a>    k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb83-11"><a href="#cb83-11"></a>    y1 &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>j]</span>
<span id="cb83-12"><a href="#cb83-12"></a>    x1 &lt;-<span class="st"> </span>chemical[<span class="op">-</span>j]</span>
<span id="cb83-13"><a href="#cb83-13"></a>    x &lt;-<span class="st"> </span>x1[<span class="op">-</span>i]</span>
<span id="cb83-14"><a href="#cb83-14"></a>    y &lt;-<span class="st"> </span>y1[<span class="op">-</span>i]</span>
<span id="cb83-15"><a href="#cb83-15"></a></span>
<span id="cb83-16"><a href="#cb83-16"></a>    J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb83-17"><a href="#cb83-17"></a>    es1_i &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i]</span>
<span id="cb83-18"><a href="#cb83-18"></a>    es1_j &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j]</span>
<span id="cb83-19"><a href="#cb83-19"></a>    e1[k] &lt;-<span class="st"> </span><span class="kw">abs</span>(magnetic[i] <span class="op">-</span><span class="st"> </span>es1_i)<span class="op">+</span><span class="kw">abs</span>(magnetic[j] <span class="op">-</span><span class="st"> </span>es1_j)</span>
<span id="cb83-20"><a href="#cb83-20"></a></span>
<span id="cb83-21"><a href="#cb83-21"></a>    J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb83-22"><a href="#cb83-22"></a>    es2_i &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] <span class="op">+</span></span>
<span id="cb83-23"><a href="#cb83-23"></a>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[i]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb83-24"><a href="#cb83-24"></a>    es2_j &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j] <span class="op">+</span></span>
<span id="cb83-25"><a href="#cb83-25"></a>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[j]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb83-26"><a href="#cb83-26"></a>    e2[k] &lt;-<span class="st"> </span><span class="kw">abs</span>(magnetic[i] <span class="op">-</span><span class="st"> </span>es2_i)<span class="op">+</span><span class="kw">abs</span>(magnetic[j] <span class="op">-</span><span class="st"> </span>es2_j)</span>
<span id="cb83-27"><a href="#cb83-27"></a></span>
<span id="cb83-28"><a href="#cb83-28"></a>    J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb83-29"><a href="#cb83-29"></a>    es3_i &lt;-<span class="st"> </span><span class="kw">exp</span>(J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i])</span>
<span id="cb83-30"><a href="#cb83-30"></a>    es3_j &lt;-<span class="st"> </span><span class="kw">exp</span>(J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j])</span>
<span id="cb83-31"><a href="#cb83-31"></a>    e3[k] &lt;-<span class="st"> </span><span class="kw">abs</span>(magnetic[i] <span class="op">-</span><span class="st"> </span>es3_i)<span class="op">+</span><span class="kw">abs</span>(magnetic[j] <span class="op">-</span><span class="st"> </span>es3_j)</span>
<span id="cb83-32"><a href="#cb83-32"></a></span>
<span id="cb83-33"><a href="#cb83-33"></a>    J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb83-34"><a href="#cb83-34"></a>    es4_i &lt;-<span class="st"> </span><span class="kw">exp</span>(J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[i]))</span>
<span id="cb83-35"><a href="#cb83-35"></a>    es4_j &lt;-<span class="st"> </span><span class="kw">exp</span>(J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[j]))</span>
<span id="cb83-36"><a href="#cb83-36"></a>    e4[k] &lt;-<span class="st"> </span><span class="kw">abs</span>(magnetic[i] <span class="op">-</span><span class="st"> </span>es4_i)<span class="op">+</span><span class="kw">abs</span>(magnetic[j] <span class="op">-</span><span class="st"> </span>es4_j)</span>
<span id="cb83-37"><a href="#cb83-37"></a>  }</span>
<span id="cb83-38"><a href="#cb83-38"></a>}</span>
<span id="cb83-39"><a href="#cb83-39"></a></span>
<span id="cb83-40"><a href="#cb83-40"></a></span>
<span id="cb83-41"><a href="#cb83-41"></a><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 60.75022 56.22732 56.67799 62.58377</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.The result is same to the result using leave-one-out (n-fold) cross validation.</p>
</div>
</div>
<div id="section-6" class="section level1">
<h1>2020-11-10</h1>
<div id="question-1-1" class="section level3">
<h3>Question 1</h3>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-15" class="section level3">
<h3>Answer</h3>
<p>According to the article of McGrath and Yeh,the method can change like that <span class="math display">\[
m_x=\frac{\ln(\frac \alpha 2)}{\ln n_x-\ln(n_x+n_y)}
\]</span> <span class="math display">\[
m_y=\frac{\ln(\frac \alpha 2)}{\ln n_y-\ln(n_x+n_y)}
\]</span> <span class="math inline">\(n_x\)</span>is the sample size of <span class="math inline">\(X\)</span>,<span class="math inline">\(n_y\)</span>is the sample size of <span class="math inline">\(Y\)</span>.If and only if the power <span class="math inline">\(a_x&lt;m_x\)</span> and <span class="math inline">\(a_y&lt;m_y\)</span>. accept <span class="math inline">\(H_0\)</span>.<span class="math inline">\(a_x\)</span> is the number of extreme points of Sample <span class="math inline">\(X\)</span>,<span class="math inline">\(a_y\)</span> is the number of extreme points of Sample <span class="math inline">\(Y\)</span></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb85-2"><a href="#cb85-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb85-3"><a href="#cb85-3"></a>B &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb85-4"><a href="#cb85-4"></a>n_X &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb85-5"><a href="#cb85-5"></a>n_Y &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb85-6"><a href="#cb85-6"></a></span>
<span id="cb85-7"><a href="#cb85-7"></a></span>
<span id="cb85-8"><a href="#cb85-8"></a>count_test &lt;-<span class="st"> </span><span class="cf">function</span>(X_<span class="dv">1</span>,X_<span class="dv">2</span>,alpha_a) {</span>
<span id="cb85-9"><a href="#cb85-9"></a>n_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">length</span>(X_<span class="dv">1</span>)</span>
<span id="cb85-10"><a href="#cb85-10"></a>n_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">length</span>(X_<span class="dv">2</span>)</span>
<span id="cb85-11"><a href="#cb85-11"></a>m_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">log</span>(alpha_a<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">log</span>(n_<span class="dv">1</span>)<span class="op">-</span><span class="kw">log</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2</span>))</span>
<span id="cb85-12"><a href="#cb85-12"></a>m_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">log</span>(alpha_a<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">log</span>(n_<span class="dv">2</span>)<span class="op">-</span><span class="kw">log</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2</span>))</span>
<span id="cb85-13"><a href="#cb85-13"></a>c_<span class="dv">1</span> &lt;-<span class="st"> </span>X_<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(X_<span class="dv">1</span>)</span>
<span id="cb85-14"><a href="#cb85-14"></a>c_<span class="dv">2</span> &lt;-<span class="st"> </span>X_<span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(X_<span class="dv">2</span>)</span>
<span id="cb85-15"><a href="#cb85-15"></a>out_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(c_<span class="dv">1</span> <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(c_<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(c_<span class="dv">1</span> <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(c_<span class="dv">2</span>))</span>
<span id="cb85-16"><a href="#cb85-16"></a>out_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(c_<span class="dv">2</span> <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(c_<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(c_<span class="dv">2</span> <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(c_<span class="dv">1</span>))</span>
<span id="cb85-17"><a href="#cb85-17"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb85-18"><a href="#cb85-18"></a><span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(<span class="kw">as.integer</span>(out_<span class="dv">1</span><span class="op">&gt;</span>m_<span class="dv">1</span>),<span class="kw">as.integer</span>(out_<span class="dv">2</span><span class="op">&gt;</span>m_<span class="dv">2</span>))))</span>
<span id="cb85-19"><a href="#cb85-19"></a>}</span>
<span id="cb85-20"><a href="#cb85-20"></a></span>
<span id="cb85-21"><a href="#cb85-21"></a>test_re &lt;-<span class="st"> </span><span class="kw">numeric</span>(B) </span>
<span id="cb85-22"><a href="#cb85-22"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</span>
<span id="cb85-23"><a href="#cb85-23"></a>  X &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_X,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb85-24"><a href="#cb85-24"></a>  Y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_Y,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb85-25"><a href="#cb85-25"></a>  test_re[b] &lt;-<span class="st"> </span><span class="kw">count_test</span>(X,Y,alpha)</span>
<span id="cb85-26"><a href="#cb85-26"></a>}</span>
<span id="cb85-27"><a href="#cb85-27"></a>p_count &lt;-<span class="st"> </span><span class="kw">mean</span>(test_re)</span>
<span id="cb85-28"><a href="#cb85-28"></a>p_count<span class="co">## output the power</span></span></code></pre></div>
<pre><code>## [1] 0.0493</code></pre>
<p>As we can see,the power is 0.0493&lt;0.5.</p>
</div>
<div id="question-2-1" class="section level3">
<h3>Question 2</h3>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<ol style="list-style-type: decimal">
<li><p>Unequal variances and equal expectations</p></li>
<li><p>Unequal variances and unequal expectations</p></li>
<li><p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p></li>
<li><p>Unbalanced samples (say, 1 case versus 10 controls)</p></li>
<li><p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p></li>
</ol>
</div>
<div id="answer-1-1" class="section level3">
<h3>Answer (1)</h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="kw">library</span>(energy)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;energy&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="kw">library</span>(Ball)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Ball&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="kw">library</span>(RANN)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;RANN&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb93-2"><a href="#cb93-2"></a>B &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb93-3"><a href="#cb93-3"></a>m &lt;-<span class="st"> </span><span class="dv">30</span><span class="co">##sample size of X</span></span>
<span id="cb93-4"><a href="#cb93-4"></a>n &lt;-<span class="st"> </span><span class="dv">30</span><span class="co">##sample size of Y</span></span>
<span id="cb93-5"><a href="#cb93-5"></a>L &lt;-<span class="st"> </span><span class="kw">c</span>(m,n)</span>
<span id="cb93-6"><a href="#cb93-6"></a>p_energy &lt;-<span class="st"> </span>p_ball&lt;-<span class="st"> </span>p_NN &lt;-<span class="kw">numeric</span>(B)</span>
<span id="cb93-7"><a href="#cb93-7"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb93-8"><a href="#cb93-8"></a></span>
<span id="cb93-9"><a href="#cb93-9"></a></span>
<span id="cb93-10"><a href="#cb93-10"></a>T_n &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, len,k) {</span>
<span id="cb93-11"><a href="#cb93-11"></a>  n_<span class="dv">1</span> &lt;-<span class="st"> </span>len[<span class="dv">1</span>]; </span>
<span id="cb93-12"><a href="#cb93-12"></a>  n_<span class="dv">2</span> &lt;-<span class="st"> </span>len[<span class="dv">2</span>]; </span>
<span id="cb93-13"><a href="#cb93-13"></a>  n &lt;-<span class="st"> </span>n_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_<span class="dv">2</span></span>
<span id="cb93-14"><a href="#cb93-14"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb93-15"><a href="#cb93-15"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb93-16"><a href="#cb93-16"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb93-17"><a href="#cb93-17"></a>  block_<span class="dv">1</span> &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n_<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb93-18"><a href="#cb93-18"></a>  block_<span class="dv">2</span> &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n_<span class="dv">1</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb93-19"><a href="#cb93-19"></a>  count_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(block_<span class="dv">1</span> <span class="op">&lt;</span><span class="st"> </span>n_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span>); </span>
<span id="cb93-20"><a href="#cb93-20"></a>  count_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(block_<span class="dv">2</span> <span class="op">&gt;</span><span class="st"> </span>n_<span class="dv">1</span><span class="fl">+0.5</span>)</span>
<span id="cb93-21"><a href="#cb93-21"></a>  (count_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>count_<span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb93-22"><a href="#cb93-22"></a>}</span>
<span id="cb93-23"><a href="#cb93-23"></a></span>
<span id="cb93-24"><a href="#cb93-24"></a></span>
<span id="cb93-25"><a href="#cb93-25"></a></span>
<span id="cb93-26"><a href="#cb93-26"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</span>
<span id="cb93-27"><a href="#cb93-27"></a>  X &lt;-<span class="st"> </span><span class="kw">rnorm</span>(m,<span class="fl">0.3</span>,<span class="dv">1</span>)</span>
<span id="cb93-28"><a href="#cb93-28"></a>  Y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="fl">0.8</span>,<span class="dv">1</span>)</span>
<span id="cb93-29"><a href="#cb93-29"></a>  Z &lt;-<span class="st"> </span><span class="kw">c</span>(X,Y)</span>
<span id="cb93-30"><a href="#cb93-30"></a>  boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(Z, <span class="dt">sizes=</span>L, <span class="dt">R=</span><span class="dv">99</span>)</span>
<span id="cb93-31"><a href="#cb93-31"></a>  p_energy[b] &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb93-32"><a href="#cb93-32"></a>  p_ball[b] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y,<span class="dt">num.permutations=</span><span class="dv">99</span>)<span class="op">$</span>p.value</span>
<span id="cb93-33"><a href="#cb93-33"></a></span>
<span id="cb93-34"><a href="#cb93-34"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> Z, <span class="dt">statistic =</span> T_n, <span class="dt">R =</span> <span class="dv">99</span>,</span>
<span id="cb93-35"><a href="#cb93-35"></a>  <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">len =</span> L,<span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb93-36"><a href="#cb93-36"></a>  test_re &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb93-37"><a href="#cb93-37"></a>  p_NN[b] &lt;-<span class="st"> </span><span class="kw">mean</span>(test_re<span class="op">&gt;=</span>test_re[<span class="dv">1</span>])</span>
<span id="cb93-38"><a href="#cb93-38"></a>}</span>
<span id="cb93-39"><a href="#cb93-39"></a></span>
<span id="cb93-40"><a href="#cb93-40"></a><span class="kw">print</span>(power_NN&lt;-<span class="kw">mean</span>(p_NN<span class="op">&lt;</span>alpha))<span class="co">##power of NN method</span></span></code></pre></div>
<pre><code>## [1] 0.01</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="kw">print</span>(power_energy&lt;-<span class="kw">mean</span>(p_energy<span class="op">&lt;</span>alpha))<span class="co">##  power of energy method</span></span></code></pre></div>
<pre><code>## [1] 0.01</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="kw">print</span>(power_ball&lt;-<span class="kw">mean</span>(p_ball<span class="op">&lt;</span>alpha))<span class="co">## power of ball method</span></span></code></pre></div>
<pre><code>## [1] 0.01</code></pre>
</div>
<div id="answer-2-1" class="section level3">
<h3>Answer (2)</h3>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb99-2"><a href="#cb99-2"></a><span class="kw">library</span>(energy)</span>
<span id="cb99-3"><a href="#cb99-3"></a><span class="kw">library</span>(Ball)</span>
<span id="cb99-4"><a href="#cb99-4"></a><span class="kw">library</span>(RANN)</span>
<span id="cb99-5"><a href="#cb99-5"></a><span class="kw">library</span>(boot)</span>
<span id="cb99-6"><a href="#cb99-6"></a>B &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb99-7"><a href="#cb99-7"></a>m &lt;-<span class="st"> </span><span class="dv">30</span><span class="co">##sample size of X</span></span>
<span id="cb99-8"><a href="#cb99-8"></a>n &lt;-<span class="st"> </span><span class="dv">30</span><span class="co">##sample size of Y</span></span>
<span id="cb99-9"><a href="#cb99-9"></a>L &lt;-<span class="st"> </span><span class="kw">c</span>(m,n)</span>
<span id="cb99-10"><a href="#cb99-10"></a>p_energy &lt;-<span class="st"> </span>p_ball&lt;-<span class="st"> </span>p_NN &lt;-<span class="kw">numeric</span>(B)</span>
<span id="cb99-11"><a href="#cb99-11"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb99-12"><a href="#cb99-12"></a></span>
<span id="cb99-13"><a href="#cb99-13"></a></span>
<span id="cb99-14"><a href="#cb99-14"></a>T_n &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, len,k) {</span>
<span id="cb99-15"><a href="#cb99-15"></a>  n_<span class="dv">1</span> &lt;-<span class="st"> </span>len[<span class="dv">1</span>]; </span>
<span id="cb99-16"><a href="#cb99-16"></a>  n_<span class="dv">2</span> &lt;-<span class="st"> </span>len[<span class="dv">2</span>]; </span>
<span id="cb99-17"><a href="#cb99-17"></a>  n &lt;-<span class="st"> </span>n_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_<span class="dv">2</span></span>
<span id="cb99-18"><a href="#cb99-18"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb99-19"><a href="#cb99-19"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb99-20"><a href="#cb99-20"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb99-21"><a href="#cb99-21"></a>  block_<span class="dv">1</span> &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n_<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb99-22"><a href="#cb99-22"></a>  block_<span class="dv">2</span> &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n_<span class="dv">1</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb99-23"><a href="#cb99-23"></a>  count_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(block_<span class="dv">1</span> <span class="op">&lt;</span><span class="st"> </span>n_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span>); </span>
<span id="cb99-24"><a href="#cb99-24"></a>  count_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(block_<span class="dv">2</span> <span class="op">&gt;</span><span class="st"> </span>n_<span class="dv">1</span><span class="fl">+0.5</span>)</span>
<span id="cb99-25"><a href="#cb99-25"></a>  (count_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>count_<span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb99-26"><a href="#cb99-26"></a>}</span>
<span id="cb99-27"><a href="#cb99-27"></a></span>
<span id="cb99-28"><a href="#cb99-28"></a></span>
<span id="cb99-29"><a href="#cb99-29"></a></span>
<span id="cb99-30"><a href="#cb99-30"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</span>
<span id="cb99-31"><a href="#cb99-31"></a>  X &lt;-<span class="st"> </span><span class="kw">rnorm</span>(m,<span class="fl">0.3</span>,<span class="dv">2</span>)</span>
<span id="cb99-32"><a href="#cb99-32"></a>  Y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="fl">0.8</span>,<span class="fl">1.5</span>)</span>
<span id="cb99-33"><a href="#cb99-33"></a>  Z &lt;-<span class="st"> </span><span class="kw">c</span>(X,Y)</span>
<span id="cb99-34"><a href="#cb99-34"></a>  boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(Z, <span class="dt">sizes=</span>L, <span class="dt">R=</span><span class="dv">99</span>)</span>
<span id="cb99-35"><a href="#cb99-35"></a>  p_energy[b] &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb99-36"><a href="#cb99-36"></a>  p_ball[b] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y,<span class="dt">num.permutations=</span><span class="dv">99</span>)<span class="op">$</span>p.value</span>
<span id="cb99-37"><a href="#cb99-37"></a></span>
<span id="cb99-38"><a href="#cb99-38"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> Z, <span class="dt">statistic =</span> T_n, <span class="dt">R =</span> <span class="dv">99</span>,</span>
<span id="cb99-39"><a href="#cb99-39"></a>  <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">len =</span> L,<span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb99-40"><a href="#cb99-40"></a>  test_re &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb99-41"><a href="#cb99-41"></a>  p_NN[b] &lt;-<span class="st"> </span><span class="kw">mean</span>(test_re<span class="op">&gt;=</span>test_re[<span class="dv">1</span>])</span>
<span id="cb99-42"><a href="#cb99-42"></a>}</span>
<span id="cb99-43"><a href="#cb99-43"></a></span>
<span id="cb99-44"><a href="#cb99-44"></a><span class="kw">print</span>(power_NN&lt;-<span class="kw">mean</span>(p_NN<span class="op">&lt;</span>alpha))<span class="co">##power of NN method</span></span></code></pre></div>
<pre><code>## [1] 0.01</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a><span class="kw">print</span>(power_energy&lt;-<span class="kw">mean</span>(p_energy<span class="op">&lt;</span>alpha))<span class="co">##  power of energy method</span></span></code></pre></div>
<pre><code>## [1] 0.01</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="kw">print</span>(power_ball&lt;-<span class="kw">mean</span>(p_ball<span class="op">&lt;</span>alpha))<span class="co">## power of ball method</span></span></code></pre></div>
<pre><code>## [1] 0.01</code></pre>
</div>
<div id="answer-3-1" class="section level3">
<h3>Answer (3)</h3>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb105-2"><a href="#cb105-2"></a><span class="kw">library</span>(energy)</span>
<span id="cb105-3"><a href="#cb105-3"></a><span class="kw">library</span>(Ball)</span>
<span id="cb105-4"><a href="#cb105-4"></a><span class="kw">library</span>(RANN)</span>
<span id="cb105-5"><a href="#cb105-5"></a><span class="kw">library</span>(boot)</span>
<span id="cb105-6"><a href="#cb105-6"></a>B &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb105-7"><a href="#cb105-7"></a>m &lt;-<span class="st"> </span><span class="dv">30</span><span class="co">##sample size of X</span></span>
<span id="cb105-8"><a href="#cb105-8"></a>n &lt;-<span class="st"> </span><span class="dv">30</span><span class="co">##sample size of Y</span></span>
<span id="cb105-9"><a href="#cb105-9"></a>L &lt;-<span class="st"> </span><span class="kw">c</span>(m,n)</span>
<span id="cb105-10"><a href="#cb105-10"></a>p_energy &lt;-<span class="st"> </span>p_ball&lt;-<span class="st"> </span>p_NN &lt;-<span class="kw">numeric</span>(B)</span>
<span id="cb105-11"><a href="#cb105-11"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb105-12"><a href="#cb105-12"></a></span>
<span id="cb105-13"><a href="#cb105-13"></a></span>
<span id="cb105-14"><a href="#cb105-14"></a>T_n &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, len,k) {</span>
<span id="cb105-15"><a href="#cb105-15"></a>  n_<span class="dv">1</span> &lt;-<span class="st"> </span>len[<span class="dv">1</span>]; </span>
<span id="cb105-16"><a href="#cb105-16"></a>  n_<span class="dv">2</span> &lt;-<span class="st"> </span>len[<span class="dv">2</span>]; </span>
<span id="cb105-17"><a href="#cb105-17"></a>  n &lt;-<span class="st"> </span>n_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_<span class="dv">2</span></span>
<span id="cb105-18"><a href="#cb105-18"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb105-19"><a href="#cb105-19"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb105-20"><a href="#cb105-20"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb105-21"><a href="#cb105-21"></a>  block_<span class="dv">1</span> &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n_<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb105-22"><a href="#cb105-22"></a>  block_<span class="dv">2</span> &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n_<span class="dv">1</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb105-23"><a href="#cb105-23"></a>  count_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(block_<span class="dv">1</span> <span class="op">&lt;</span><span class="st"> </span>n_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span>); </span>
<span id="cb105-24"><a href="#cb105-24"></a>  count_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(block_<span class="dv">2</span> <span class="op">&gt;</span><span class="st"> </span>n_<span class="dv">1</span><span class="fl">+0.5</span>)</span>
<span id="cb105-25"><a href="#cb105-25"></a>  (count_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>count_<span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb105-26"><a href="#cb105-26"></a>}</span>
<span id="cb105-27"><a href="#cb105-27"></a></span>
<span id="cb105-28"><a href="#cb105-28"></a></span>
<span id="cb105-29"><a href="#cb105-29"></a></span>
<span id="cb105-30"><a href="#cb105-30"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</span>
<span id="cb105-31"><a href="#cb105-31"></a>  X &lt;-<span class="st"> </span><span class="kw">rt</span>(m,<span class="dt">df=</span><span class="dv">1</span>)</span>
<span id="cb105-32"><a href="#cb105-32"></a>  Y_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb105-33"><a href="#cb105-33"></a>  Y_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="fl">0.8</span>)</span>
<span id="cb105-34"><a href="#cb105-34"></a>  Y &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb105-35"><a href="#cb105-35"></a>  p &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb105-36"><a href="#cb105-36"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb105-37"><a href="#cb105-37"></a>    <span class="cf">if</span>(p[i]<span class="op">&lt;</span><span class="fl">0.5</span>) {Y[i]=Y_<span class="dv">1</span>[i]}</span>
<span id="cb105-38"><a href="#cb105-38"></a>    <span class="cf">else</span>{Y[i]=Y_<span class="dv">2</span>[i]}</span>
<span id="cb105-39"><a href="#cb105-39"></a>  }<span class="co">##generate mixture of two normal   distributions</span></span>
<span id="cb105-40"><a href="#cb105-40"></a>  Z &lt;-<span class="st"> </span><span class="kw">c</span>(X,Y)</span>
<span id="cb105-41"><a href="#cb105-41"></a>  boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(Z, <span class="dt">sizes=</span>L, <span class="dt">R=</span><span class="dv">99</span>)</span>
<span id="cb105-42"><a href="#cb105-42"></a>  p_energy[b] &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb105-43"><a href="#cb105-43"></a>  p_ball[b] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y,<span class="dt">num.permutations=</span><span class="dv">99</span>)<span class="op">$</span>p.value</span>
<span id="cb105-44"><a href="#cb105-44"></a></span>
<span id="cb105-45"><a href="#cb105-45"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> Z, <span class="dt">statistic =</span> T_n, <span class="dt">R =</span> <span class="dv">99</span>,</span>
<span id="cb105-46"><a href="#cb105-46"></a>  <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">len =</span> L,<span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb105-47"><a href="#cb105-47"></a>  test_re &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb105-48"><a href="#cb105-48"></a>  p_NN[b] &lt;-<span class="st"> </span><span class="kw">mean</span>(test_re<span class="op">&gt;=</span>test_re[<span class="dv">1</span>])</span>
<span id="cb105-49"><a href="#cb105-49"></a>}</span>
<span id="cb105-50"><a href="#cb105-50"></a></span>
<span id="cb105-51"><a href="#cb105-51"></a><span class="kw">print</span>(power_NN&lt;-<span class="kw">mean</span>(p_NN<span class="op">&lt;</span>alpha))<span class="co">##power of NN method</span></span></code></pre></div>
<pre><code>## [1] 0.99</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="kw">print</span>(power_energy&lt;-<span class="kw">mean</span>(p_energy<span class="op">&lt;</span>alpha))<span class="co">##  power of energy method</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="kw">print</span>(power_ball&lt;-<span class="kw">mean</span>(p_ball<span class="op">&lt;</span>alpha))<span class="co">## power of ball method</span></span></code></pre></div>
<pre><code>## [1] 0.99</code></pre>
</div>
<div id="answer-4-1" class="section level3">
<h3>Answer (4)</h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb111-2"><a href="#cb111-2"></a><span class="kw">library</span>(energy)</span>
<span id="cb111-3"><a href="#cb111-3"></a><span class="kw">library</span>(Ball)</span>
<span id="cb111-4"><a href="#cb111-4"></a><span class="kw">library</span>(RANN)</span>
<span id="cb111-5"><a href="#cb111-5"></a><span class="kw">library</span>(boot)</span>
<span id="cb111-6"><a href="#cb111-6"></a>B &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb111-7"><a href="#cb111-7"></a>m &lt;-<span class="st"> </span><span class="dv">10</span><span class="co">##sample size of X</span></span>
<span id="cb111-8"><a href="#cb111-8"></a>n &lt;-<span class="st"> </span><span class="dv">100</span><span class="co">##sample size of Y</span></span>
<span id="cb111-9"><a href="#cb111-9"></a>L &lt;-<span class="st"> </span><span class="kw">c</span>(m,n)</span>
<span id="cb111-10"><a href="#cb111-10"></a>p_energy &lt;-<span class="st"> </span>p_ball&lt;-<span class="st"> </span>p_NN &lt;-<span class="kw">numeric</span>(B)</span>
<span id="cb111-11"><a href="#cb111-11"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb111-12"><a href="#cb111-12"></a></span>
<span id="cb111-13"><a href="#cb111-13"></a>T_n &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, len,k) {</span>
<span id="cb111-14"><a href="#cb111-14"></a>  n_<span class="dv">1</span> &lt;-<span class="st"> </span>len[<span class="dv">1</span>]; </span>
<span id="cb111-15"><a href="#cb111-15"></a>  n_<span class="dv">2</span> &lt;-<span class="st"> </span>len[<span class="dv">2</span>]; </span>
<span id="cb111-16"><a href="#cb111-16"></a>  n &lt;-<span class="st"> </span>n_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_<span class="dv">2</span></span>
<span id="cb111-17"><a href="#cb111-17"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb111-18"><a href="#cb111-18"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb111-19"><a href="#cb111-19"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb111-20"><a href="#cb111-20"></a>  block_<span class="dv">1</span> &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n_<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb111-21"><a href="#cb111-21"></a>  block_<span class="dv">2</span> &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n_<span class="dv">1</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb111-22"><a href="#cb111-22"></a>  count_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(block_<span class="dv">1</span> <span class="op">&lt;</span><span class="st"> </span>n_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span>); </span>
<span id="cb111-23"><a href="#cb111-23"></a>  count_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(block_<span class="dv">2</span> <span class="op">&gt;</span><span class="st"> </span>n_<span class="dv">1</span><span class="fl">+0.5</span>)</span>
<span id="cb111-24"><a href="#cb111-24"></a>  (count_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>count_<span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb111-25"><a href="#cb111-25"></a>}</span>
<span id="cb111-26"><a href="#cb111-26"></a></span>
<span id="cb111-27"><a href="#cb111-27"></a></span>
<span id="cb111-28"><a href="#cb111-28"></a></span>
<span id="cb111-29"><a href="#cb111-29"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</span>
<span id="cb111-30"><a href="#cb111-30"></a>  X &lt;-<span class="st"> </span><span class="kw">rnorm</span>(m,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb111-31"><a href="#cb111-31"></a>  Y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb111-32"><a href="#cb111-32"></a>  Z &lt;-<span class="st"> </span><span class="kw">c</span>(X,Y)</span>
<span id="cb111-33"><a href="#cb111-33"></a>  boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(Z, <span class="dt">sizes=</span>L, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb111-34"><a href="#cb111-34"></a>  p_energy[b] &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb111-35"><a href="#cb111-35"></a>  p_ball[b] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y,<span class="dt">num.permutations=</span><span class="dv">999</span>)<span class="op">$</span>p.value</span>
<span id="cb111-36"><a href="#cb111-36"></a></span>
<span id="cb111-37"><a href="#cb111-37"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> Z, <span class="dt">statistic =</span> T_n, <span class="dt">R =</span> <span class="dv">999</span>,</span>
<span id="cb111-38"><a href="#cb111-38"></a>  <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">len =</span> L,<span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb111-39"><a href="#cb111-39"></a>  test_re &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb111-40"><a href="#cb111-40"></a>  p_NN[b] &lt;-<span class="st"> </span><span class="kw">mean</span>(test_re<span class="op">&gt;=</span>test_re[<span class="dv">1</span>])</span>
<span id="cb111-41"><a href="#cb111-41"></a>}</span>
<span id="cb111-42"><a href="#cb111-42"></a></span>
<span id="cb111-43"><a href="#cb111-43"></a><span class="kw">print</span>(power_NN&lt;-<span class="kw">mean</span>(p_NN<span class="op">&lt;</span>alpha))<span class="co">##power of NN method</span></span></code></pre></div>
<pre><code>## [1] 0.1</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="kw">print</span>(power_energy&lt;-<span class="kw">mean</span>(p_energy<span class="op">&lt;</span>alpha))<span class="co">##  power of energy method</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="kw">print</span>(power_ball&lt;-<span class="kw">mean</span>(p_ball<span class="op">&lt;</span>alpha))<span class="co">## power of ball method</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
</div>
</div>
<div id="section-7" class="section level1">
<h1>2020-11-17</h1>
<div id="question-19.4" class="section level3">
<h3>Question 1(9.4)</h3>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-1-2" class="section level3">
<h3>Answer 1</h3>
<p>The pdf of the standard Laplace distribution is <span class="math display">\[
f_L(x)=\frac 12 e^{-|x|}
\]</span> So <span class="math display">\[
r(x_t,y)=\frac{f_L(Y)}{f_L(X_t)}=e^{|x_t|-|y|}
\]</span></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb117-2"><a href="#cb117-2"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb117-3"><a href="#cb117-3"></a>Sample_Laplace &lt;-<span class="st"> </span><span class="cf">function</span>(n,X_<span class="dv">1</span>,sigma){</span>
<span id="cb117-4"><a href="#cb117-4"></a>  p &lt;-<span class="st"> </span><span class="kw">runif</span>(n<span class="dv">-1</span>)</span>
<span id="cb117-5"><a href="#cb117-5"></a>  Sample &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb117-6"><a href="#cb117-6"></a>  count &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb117-7"><a href="#cb117-7"></a>  Sample[<span class="dv">1</span>] &lt;-<span class="st"> </span>X_<span class="dv">1</span></span>
<span id="cb117-8"><a href="#cb117-8"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb117-9"><a href="#cb117-9"></a>    delta &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,Sample[j],sigma)</span>
<span id="cb117-10"><a href="#cb117-10"></a>    r &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(Sample[j])<span class="op">-</span><span class="kw">abs</span>(delta))</span>
<span id="cb117-11"><a href="#cb117-11"></a>    <span class="cf">if</span> (p[j]<span class="op">&gt;</span>r){</span>
<span id="cb117-12"><a href="#cb117-12"></a>      Sample[j<span class="op">+</span><span class="dv">1</span>]&lt;-Sample[j]</span>
<span id="cb117-13"><a href="#cb117-13"></a>      count &lt;-<span class="st"> </span>count<span class="op">+</span><span class="dv">1</span></span>
<span id="cb117-14"><a href="#cb117-14"></a>    }</span>
<span id="cb117-15"><a href="#cb117-15"></a>    <span class="cf">else</span>{</span>
<span id="cb117-16"><a href="#cb117-16"></a>      Sample[j<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>delta</span>
<span id="cb117-17"><a href="#cb117-17"></a>    }</span>
<span id="cb117-18"><a href="#cb117-18"></a>  }</span>
<span id="cb117-19"><a href="#cb117-19"></a>  acceptrate &lt;-<span class="st"> </span>count<span class="op">/</span>n</span>
<span id="cb117-20"><a href="#cb117-20"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">acceptrate=</span>acceptrate,<span class="dt">Sample=</span>Sample))</span>
<span id="cb117-21"><a href="#cb117-21"></a>}</span>
<span id="cb117-22"><a href="#cb117-22"></a></span>
<span id="cb117-23"><a href="#cb117-23"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.6</span>,<span class="fl">1.8</span>,<span class="fl">5.4</span>)</span>
<span id="cb117-24"><a href="#cb117-24"></a>L &lt;-<span class="st"> </span><span class="kw">length</span>(sigma)</span>
<span id="cb117-25"><a href="#cb117-25"></a>x_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb117-26"><a href="#cb117-26"></a>accept_rate &lt;-<span class="st"> </span><span class="kw">numeric</span>(L)</span>
<span id="cb117-27"><a href="#cb117-27"></a></span>
<span id="cb117-28"><a href="#cb117-28"></a>LSample1&lt;-<span class="kw">Sample_Laplace</span>(N,x_<span class="dv">1</span>,sigma[<span class="dv">1</span>])</span>
<span id="cb117-29"><a href="#cb117-29"></a>LSample2&lt;-<span class="kw">Sample_Laplace</span>(N,x_<span class="dv">1</span>,sigma[<span class="dv">2</span>])</span>
<span id="cb117-30"><a href="#cb117-30"></a>LSample3&lt;-<span class="kw">Sample_Laplace</span>(N,x_<span class="dv">1</span>,sigma[<span class="dv">3</span>])</span>
<span id="cb117-31"><a href="#cb117-31"></a>LSample4&lt;-<span class="kw">Sample_Laplace</span>(N,x_<span class="dv">1</span>,sigma[<span class="dv">4</span>])</span>
<span id="cb117-32"><a href="#cb117-32"></a></span>
<span id="cb117-33"><a href="#cb117-33"></a></span>
<span id="cb117-34"><a href="#cb117-34"></a>accept_rate[<span class="dv">1</span>] &lt;-<span class="st"> </span>LSample1<span class="op">$</span>acceptrate</span>
<span id="cb117-35"><a href="#cb117-35"></a>accept_rate[<span class="dv">2</span>] &lt;-<span class="st"> </span>LSample2<span class="op">$</span>acceptrate</span>
<span id="cb117-36"><a href="#cb117-36"></a>accept_rate[<span class="dv">3</span>] &lt;-<span class="st"> </span>LSample3<span class="op">$</span>acceptrate</span>
<span id="cb117-37"><a href="#cb117-37"></a>accept_rate[<span class="dv">4</span>] &lt;-<span class="st"> </span>LSample4<span class="op">$</span>acceptrate</span>
<span id="cb117-38"><a href="#cb117-38"></a></span>
<span id="cb117-39"><a href="#cb117-39"></a></span>
<span id="cb117-40"><a href="#cb117-40"></a>sample1 &lt;-<span class="st"> </span>LSample1<span class="op">$</span>Sample</span>
<span id="cb117-41"><a href="#cb117-41"></a>sample2 &lt;-<span class="st"> </span>LSample2<span class="op">$</span>Sample</span>
<span id="cb117-42"><a href="#cb117-42"></a>sample3 &lt;-<span class="st"> </span>LSample3<span class="op">$</span>Sample</span>
<span id="cb117-43"><a href="#cb117-43"></a>sample4 &lt;-<span class="st"> </span>LSample4<span class="op">$</span>Sample</span>
<span id="cb117-44"><a href="#cb117-44"></a></span>
<span id="cb117-45"><a href="#cb117-45"></a></span>
<span id="cb117-46"><a href="#cb117-46"></a></span>
<span id="cb117-47"><a href="#cb117-47"></a>result &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(sigma,accept_rate),<span class="dt">nrow=</span>L,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">dimnames=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>),<span class="kw">c</span>(<span class="st">&quot;sigma&quot;</span>,<span class="st">&quot;accept rate&quot;</span>)))</span>
<span id="cb117-48"><a href="#cb117-48"></a>result</span></code></pre></div>
<pre><code>##   sigma accept rate
## 1   0.2      0.0795
## 2   0.6      0.1975
## 3   1.8      0.4430
## 4   5.4      0.7405</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a><span class="kw">plot</span>(sample1,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">main=</span><span class="st">&quot;sigma=0.2&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="kw">plot</span>(sample2,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">main=</span><span class="st">&quot;sigma=0.6&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a><span class="kw">plot</span>(sample3,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">main=</span><span class="st">&quot;sigma=1.8&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a><span class="kw">plot</span>(sample4,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">main=</span><span class="st">&quot;sigma=5.4&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In the first plot of Figure with <span class="math inline">\(σ = 0.2\)</span>, the ratios <span class="math inline">\(r(X_t, Y )\)</span> tend to be large and almost every candidate point is accepted.Chain 1 has not converged to the target in 2000 iterations.And the rate of acceptance(0.0795) is not in <span class="math inline">\([0.15,0.5]\)</span>.</p>
<p>The second chain generated with <span class="math inline">\(σ = 0.6\)</span> is not converging apparently.But the rate of acceptance(0.1975) is in <span class="math inline">\([0.15,0.5]\)</span>.</p>
<p>In the third plot <span class="math inline">\((σ = 1.8)\)</span> the chain is mixing well and converging to the target distribution.And the rate of acceptance(0.4430) is in <span class="math inline">\([0.15,0.5]\)</span>.</p>
<p>In the fourth plot, where <span class="math inline">\(σ = 5.4\)</span>, the chain is mixing well and converging to the target distribution.But the rate of acceptance(0.7405) is not in <span class="math inline">\([0.15,0.5]\)</span>.</p>
</div>
<div id="question-2-2" class="section level3">
<h3>Question 2</h3>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="answer-2-2" class="section level3">
<h3>Answer 2</h3>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb123-2"><a href="#cb123-2"></a></span>
<span id="cb123-3"><a href="#cb123-3"></a></span>
<span id="cb123-4"><a href="#cb123-4"></a>Gelman_Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {<span class="co">##the function from textbook</span></span>
<span id="cb123-5"><a href="#cb123-5"></a>psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb123-6"><a href="#cb123-6"></a>n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb123-7"><a href="#cb123-7"></a>k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb123-8"><a href="#cb123-8"></a>psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) </span>
<span id="cb123-9"><a href="#cb123-9"></a>B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) </span>
<span id="cb123-10"><a href="#cb123-10"></a>psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) </span>
<span id="cb123-11"><a href="#cb123-11"></a>W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) </span>
<span id="cb123-12"><a href="#cb123-12"></a>Var_hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)</span>
<span id="cb123-13"><a href="#cb123-13"></a>R_hat &lt;-<span class="st"> </span>Var_hat <span class="op">/</span><span class="st"> </span>W </span>
<span id="cb123-14"><a href="#cb123-14"></a><span class="kw">return</span>(R_hat)</span>
<span id="cb123-15"><a href="#cb123-15"></a>}</span>
<span id="cb123-16"><a href="#cb123-16"></a></span>
<span id="cb123-17"><a href="#cb123-17"></a></span>
<span id="cb123-18"><a href="#cb123-18"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb123-19"><a href="#cb123-19"></a>Sample_Laplace &lt;-<span class="st"> </span><span class="cf">function</span>(n,X_<span class="dv">1</span>,sigma){</span>
<span id="cb123-20"><a href="#cb123-20"></a>  p &lt;-<span class="st"> </span><span class="kw">runif</span>(n<span class="dv">-1</span>)</span>
<span id="cb123-21"><a href="#cb123-21"></a>  Sample &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb123-22"><a href="#cb123-22"></a>  Sample[<span class="dv">1</span>] &lt;-<span class="st"> </span>X_<span class="dv">1</span></span>
<span id="cb123-23"><a href="#cb123-23"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb123-24"><a href="#cb123-24"></a>    delta &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,Sample[j],sigma)</span>
<span id="cb123-25"><a href="#cb123-25"></a>    r &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(Sample[j])<span class="op">-</span><span class="kw">abs</span>(delta))</span>
<span id="cb123-26"><a href="#cb123-26"></a>    <span class="cf">if</span> (p[j]<span class="op">&gt;</span>r){</span>
<span id="cb123-27"><a href="#cb123-27"></a>      Sample[j<span class="op">+</span><span class="dv">1</span>]&lt;-Sample[j]</span>
<span id="cb123-28"><a href="#cb123-28"></a>    }</span>
<span id="cb123-29"><a href="#cb123-29"></a>    <span class="cf">else</span>{</span>
<span id="cb123-30"><a href="#cb123-30"></a>      Sample[j<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>delta</span>
<span id="cb123-31"><a href="#cb123-31"></a>    }</span>
<span id="cb123-32"><a href="#cb123-32"></a>  }</span>
<span id="cb123-33"><a href="#cb123-33"></a>  <span class="kw">return</span>(Sample)</span>
<span id="cb123-34"><a href="#cb123-34"></a>}</span>
<span id="cb123-35"><a href="#cb123-35"></a></span>
<span id="cb123-36"><a href="#cb123-36"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.6</span>,<span class="fl">1.8</span>,<span class="fl">5.4</span>)</span>
<span id="cb123-37"><a href="#cb123-37"></a>L &lt;-<span class="st"> </span><span class="kw">length</span>(sigma)</span>
<span id="cb123-38"><a href="#cb123-38"></a>x_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb123-39"><a href="#cb123-39"></a>accept_rate &lt;-<span class="st"> </span><span class="kw">numeric</span>(L)</span>
<span id="cb123-40"><a href="#cb123-40"></a>sample &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">0</span>),<span class="dt">nrow=</span>L,<span class="dt">ncol=</span>N)</span>
<span id="cb123-41"><a href="#cb123-41"></a><span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>L){</span>
<span id="cb123-42"><a href="#cb123-42"></a>  sample[l,] &lt;-<span class="st"> </span><span class="kw">Sample_Laplace</span>(N,x_<span class="dv">1</span>,sigma[l])</span>
<span id="cb123-43"><a href="#cb123-43"></a>}</span>
<span id="cb123-44"><a href="#cb123-44"></a></span>
<span id="cb123-45"><a href="#cb123-45"></a>b &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb123-46"><a href="#cb123-46"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(sample, <span class="dv">1</span>, cumsum))</span>
<span id="cb123-47"><a href="#cb123-47"></a>psi_row &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb123-48"><a href="#cb123-48"></a>psi_col &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb123-49"><a href="#cb123-49"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>psi_row)</span>
<span id="cb123-50"><a href="#cb123-50"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span>psi_col)</span>
<span id="cb123-51"><a href="#cb123-51"></a><span class="kw">print</span>(<span class="kw">Gelman_Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.132023</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb125-2"><a href="#cb125-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>L)</span>
<span id="cb125-3"><a href="#cb125-3"></a><span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb125-4"><a href="#cb125-4"></a><span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZmY6ZpA6ZrY6kNtmAABmZmZmtv+QOgCQOjqQZjqQZpCQtraQ2/+2ZgC22/+2///bkDrb2//b////tmb/25D/27b//7b//9v////vSfc7AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGIklEQVR4nO3da3uaSACGYdJNs0ezyR7ixlYb/f8/cuWgJkbmYWQGXuR9vrRXCwO5r0HEoBY7F6wYewfUMxBkIMhAkIEgA0EGggwEGQgyEGQgyECQgSADQQaCDAQZCDIQZCDIQJCBIANBBoIMBBkIMhBkIMhAkIEgA0EGggwEGQgyEGQgyECQgSADQQaCDAQZCDIQZCDIQJCBIANBBoIMBBkIMhBkIMhAkIEgA0EGggwEGQgyEGQgyECQgSADQQaCDAQZCDIQZCDIQJCBIANBBoIMBBkIigPaPhdVX14z7Y5eUUCrYlH/ZX34y+0XA7R9PrKsfvqeYWcUiwF6e3w6/HU9m4Ms8QwqJlMOoP1jUDOFWh+DJnNSzAO0P8hq/tZHoLkDDT1cvsYFmgBTbqBVy1ms6DXqgA08g85PDgaC4QwEw80baF0Udy/h4WYLtCyKxebX7+8vOi4ON1eg5f4J4rKaPa2XGs0f8kJZgKp5s3kogdouVouzP2XLBFRegW2/7XAGzRTo9PSwpgoMN1Og3ao+fa2Llsfo2QN1Hs5AMJz8aWxsIPkpZCBofCBxodGB1IXGBxI/yEZ+wSzh0JkSmEEGouGkH4UUgKSnkASQspCBIANBIkC6QhpAwlPIQJAIkK6QgSAZIFUhFSDZKaQDJCokA6QqpAMkepApvGB2/L8km0ic0AzSFFICkjzIpIAUhQwEiQHpCWUBqu8KWheBdxy2DDcnoOreMrqJ89M/ywllA2po6Ba8PpsZpGxAm68VEN3E+enf1YTUZpDcFIoF2v7T4U269dvp7ncdbuK8focGKhbo7fHutz///YaL743uXgLvCm8HEhOKPsR+/P3Lfnb8kW+7Uweq+vFX388LuHGgXflGlU7BOw4v/Y+WUPxj0PEVnWs+MqDL29GnDdTUeQZdsd1bANou8z0GiR1jV57Ffu/7kSWh7U4aqH4e9F/W7U4aKOKZdPCh/GaBurV9plNccDgloUyvKG6f73sMNwOgwFvpOgw3B6Bewymd6CWBlKaQgSADQZpAQkIGggwEGQgaGKjz5zfKCInOIAMZqOdwMlcbqkAyU8hAkIEgWSAVIQNBwkAaQrpAIlPIQJAykISQMJDGFJIGUhBSBpIQUn096LB4kq32SXoGVaBptxudOND4k0ge6HhYpt1+960nXzDTcGMJTQZoN9I0mg5QtdbwQpmA8DsOr/xJo4SSTLk8QPwdh9fueecfudbpT5QFqMs31EUM93HFTj/yaam+QlmAOnzHYY/d5h/5A2LPSTS5GVStHFz7k0ivx6Jcj0F5v+PwwicKh7+28XqiTGexYb7j8PQ1ZZGHXcw2ki846HAxrw1cd8UycaD47b5HKs66uELnka/bofh3HOavTeTyxz51HrXvbh32YdyL83AXdm9uh1jHTkgGgiZ2sTp8U7tYHbxJXmoM2WgXq5MpB1CHGRQ7aPr9TD2HE1+sxg56Y0B8sRo76K0BJR/UQKmWNNDgC440XuSgBkq1pIEGX3Ck8W4uA0EGggwEGQgyEGQgyECQgSADQQaCDAQZCEoPtC7KT3Vv7/TJ+MclaZVwm59fcwzblBxoXX7mfWi/Ng8vZ0viKsHeHqvf0aUe9lBqoPp3Z8vAB3Yefud4XJJXCbVu7hRIPOyx1ED1F5O03V9Vtro/W5JXCbQuFjVN2mFPJQeqZnrbb6bLluUHVy/eLcmrhKvXTD5sU2qg+qAPHPpvj+VvHZeL05K4Cm2yNEg/bNPgQM1iX17TAqUftmn4Q6xe7OtT4kMs+bBNwz9I14s9vCR7NH0PlHDYpsFP8/V+73+oZOfjCij9sE3DP1Gsdrn8fopUz+ias1jqYZvSX2qs6An+cn8+fvqwJK4SrDnEUg/b5ItVyECQgSADQQaCDAQZCDIQZCDIQJCBIANBBoIMBBkIMhBkIMhAkIEgA0EGggwEGQgyEGQgyECQgaAJANW3+Y6VPlBzm+9YyQOtAx8INkTqQMfbfMdKHWiX4DbDXhkIMhBkIMhAkIEgA0EGgiYANG4GggwEGQgyEGQgyECQgSADQQaCDAQZCDIQZCDIQJCBIANBBoIMBBkIMhBkIMhAkIGg/wH/NVA8mTHdzAAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZmY6ZpA6ZrY6kNtmAABmZmZmtv+QOgCQOjqQZjqQZpCQtraQ2/+2ZgC22/+2///bkDrb2//b////tmb/25D/27b//7b//9v////vSfc7AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGLUlEQVR4nO2daVfjNhRAzZSZrlDoAiVtGOD//8gm2CEhYF8vkvWc3Psp50h+MvfIjpYXUb1IJ1XpG4iOggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQkFlQthlKC0obLh4IABQFlBfV/wotRuAcpCMIpCMIpiMKFN6QgQEGAgoCZBX2Y4igIwikIwikIwikIwikIwikIwikIwikIwikIwp2roOfberz85QHCnamgVXVVf1jvPrSFO09Bz7dvWlY//NcdLrqhLIKerm92H9ctD9l5C7IHEauq6UL4DjpTQZuHrP4Wa+k/CuofTkEQ7twFrfwWG9bcx7Sb4IaKP2IKonAKgnAKgnDBc4QyzcX2L2P6FovehfL0oOfb1oWgj+HOUdDG0GXvcGcpaDNLveksr1o+h6P8S1pBGE5BEE5BFC6yIQUBCgJiCApsKISgyF0oiKC4hmIICtyFhgp6/qttI6dflLZfOoY1NFTQ0/XFL7///W/ydgf8OHReBj9i3//8afPH/Ja83SG/n52Tce+g73+07ChPaveEBL08/jzpVXTCgg5WU2nRcHi7EQ1F6kEhh0PjBD3f53gHhexCI7/Ffp3YgU5XUD0O+idTuycgqOdIunca8Mi7mY88c7H+acATGpmHLIKGJHGOb2UeMm09908DHt/KPNiDDhqfNLwf+A7qnQY8oZW0tJw7lWnBrH8a8JRWknK0Sr6TFGRFMVMrA2ib5iioabit5dyCMA04SSuTaZ8mz9yD6PS9YoJGlIytOClcIUEdzQYTVMRQ5zJUJkEjJ6uZBX2ylVLRfkqsyWpGQS3HkOJeSrCpRg5BRwcWDWwh2GQ1g6CJC90n34OmbgQEm6wmFzR5oyTYZDW9oNkCzDUOStvO9HDRBKVsJ0k+xIkKGnbaemek5BUnhuvZzv7vfxvwVYeFk25uxP3EEnQwCN7befuUNtFoaYKORsXvXGTJwVqWoAJZaEsSVCRJb0GCymQPBVty7WioUHZVuB7UuhgbbzV2ZMWp4T4vKZadtxBB5bIXlyIobesDWISgktmvAQV9sveQtu1BxBN0XFQ4eTqToNH7YsdFxX/ikmtNeuy+2FFRaT3xdjWOior7Cbcv9vKu15TvQBF70EFZeT/h9sXelQXoQOH2xV7Lqh6V5iLgOGhvSEFdpVlWmIeTW9DAJM5dafLNidHE7EGBUBAQb006GPYgoJigxZBDUI+zXIcGTX+fqfvwoHh8luvQoCcmiM9yHRr01AThWa5Dg56coNRBFZSq5pIEHaybTQ6qoFQ1FTR7xXzxWNApoSBgMbPLUigIUBCgIEBBgIIABQEKAhQEKAhQEJBe0LqqLu46yuu9kcvDmnRJN48/PuQI25Bc0HpzT+uu+3r8dndUEy/p5On6daslddgdqQXVU/37js2PXXrjW02+pIt1s0eXOOwbqQU9ft1ue7Rlx2xZXR7V5Es6WFdXtZq0YfckF/Ta09uSYLfcbw+uvjqoyZd0U1+ZPGxDakH1Q9/x6D9dbxMc76/2NfESanLrIH3YhtkFNdW+PKQVlD5sw/yPWF3t603iRyx52Ib5X9J1tW93yd6mh4IShm2Y/Wu+vu/NH5Xs+/hVUPqwDfMPFF9vefv/KVKN6JpvsdRhG9JPNVY0wL/ffB/fvKuJl3TSPGKpwzY4WQUUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIiC7o9fTYkj8BDS7o+fbi7mVVTc1hmUBwQYmyoCYQXFDN9Cyf8SxC0L09qJPWk2PnYAGC1iXf0QsQVLT/LEDQqqyf8IJWvc4Ey0hwQY9fSx+kElzQqj610XFQXBQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQH/A3OUSnje/3PrAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a><span class="co">#par(mfrow=c(1,1)) #restore default</span></span>
<span id="cb126-2"><a href="#cb126-2"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb126-3"><a href="#cb126-3"></a>Rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb126-4"><a href="#cb126-4"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb126-5"><a href="#cb126-5"></a>Rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman_Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb126-6"><a href="#cb126-6"></a><span class="kw">plot</span>(Rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb126-7"><a href="#cb126-7"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a><span class="kw">print</span>(<span class="kw">Gelman_Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.132023</code></pre>
<p>As we can see from the plot, when <span class="math inline">\(n&gt;1300\)</span>,<span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="question-311.4" class="section level3">
<h3>Question 3(11.4)</h3>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0, \sqrt{k})\)</span> of the curves <span class="math display">\[
S_{k-1}(a)=P\left(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}}\right)
\]</span> and <span class="math display">\[
S_{k}(a)=P\left(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}}\right)
\]</span> for <span class="math inline">\(k = 4 : 25, 100, 500, 1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student t random variable with <span class="math inline">\(k\)</span> degrees of freedom.</p>
</div>
<div id="answer-3-2" class="section level3">
<h3>Answer 3</h3>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb129-2"><a href="#cb129-2"></a>df &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb129-3"><a href="#cb129-3"></a>L &lt;-<span class="st"> </span><span class="kw">length</span>(df)</span>
<span id="cb129-4"><a href="#cb129-4"></a>root_Bisection &lt;-<span class="st"> </span>root_Brent &lt;-<span class="st"> </span><span class="kw">numeric</span>(L)</span>
<span id="cb129-5"><a href="#cb129-5"></a>N &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb129-6"><a href="#cb129-6"></a></span>
<span id="cb129-7"><a href="#cb129-7"></a></span>
<span id="cb129-8"><a href="#cb129-8"></a>h &lt;-<span class="st"> </span><span class="cf">function</span>(a,k){<span class="co">##the function need to get the root </span></span>
<span id="cb129-9"><a href="#cb129-9"></a>  re &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb129-10"><a href="#cb129-10"></a>  <span class="cf">if</span>(k<span class="op">&lt;</span><span class="dv">2</span>){re &lt;-<span class="st"> </span><span class="dv">0</span>}</span>
<span id="cb129-11"><a href="#cb129-11"></a>  <span class="cf">else</span> <span class="cf">if</span>(k<span class="op">&lt;=</span>a){re &lt;-<span class="st"> </span><span class="dv">0</span>}</span>
<span id="cb129-12"><a href="#cb129-12"></a>  <span class="cf">else</span> <span class="cf">if</span>(a<span class="op">&lt;=</span><span class="dv">0</span>){re &lt;-<span class="st"> </span><span class="dv">0</span>}</span>
<span id="cb129-13"><a href="#cb129-13"></a>  <span class="cf">else</span>{</span>
<span id="cb129-14"><a href="#cb129-14"></a>    re &lt;-(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">*</span>a<span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k<span class="dv">-1</span>))<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">*</span>a<span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k))</span>
<span id="cb129-15"><a href="#cb129-15"></a>  }</span>
<span id="cb129-16"><a href="#cb129-16"></a>  <span class="kw">return</span>(re)</span>
<span id="cb129-17"><a href="#cb129-17"></a>}</span>
<span id="cb129-18"><a href="#cb129-18"></a></span>
<span id="cb129-19"><a href="#cb129-19"></a></span>
<span id="cb129-20"><a href="#cb129-20"></a></span>
<span id="cb129-21"><a href="#cb129-21"></a></span>
<span id="cb129-22"><a href="#cb129-22"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>L){</span>
<span id="cb129-23"><a href="#cb129-23"></a>  low &lt;-<span class="st"> </span><span class="fl">0.000001</span></span>
<span id="cb129-24"><a href="#cb129-24"></a>  up &lt;-<span class="st"> </span><span class="kw">sqrt</span>(df[i])<span class="op">-</span><span class="fl">0.000001</span></span>
<span id="cb129-25"><a href="#cb129-25"></a>  root_Brent[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(a) {(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">*</span>a<span class="op">*</span>(df[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(df[i]<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>df[i]<span class="op">-</span><span class="dv">1</span>))<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">*</span>a<span class="op">*</span>df[i]<span class="op">/</span>(df[i]<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>df[i]))},</span>
<span id="cb129-26"><a href="#cb129-26"></a><span class="dt">interval =</span> <span class="kw">c</span>(<span class="fl">0.000001</span>, <span class="kw">sqrt</span>(df[i])<span class="op">-</span><span class="fl">0.000001</span>))<span class="op">$</span>root</span>
<span id="cb129-27"><a href="#cb129-27"></a>  </span>
<span id="cb129-28"><a href="#cb129-28"></a>  y &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb129-29"><a href="#cb129-29"></a>  y[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">h</span>(low,df[i])</span>
<span id="cb129-30"><a href="#cb129-30"></a>  y[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">h</span>(up,df[i])</span>
<span id="cb129-31"><a href="#cb129-31"></a>  <span class="cf">if</span>(y[<span class="dv">1</span>]<span class="op">*</span>y[<span class="dv">3</span>]<span class="op">&gt;</span><span class="dv">0</span>){</span>
<span id="cb129-32"><a href="#cb129-32"></a>    root_Bisection[i] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(df[i])<span class="op">-</span><span class="fl">0.000001</span></span>
<span id="cb129-33"><a href="#cb129-33"></a>  }</span>
<span id="cb129-34"><a href="#cb129-34"></a>  <span class="cf">else</span>{</span>
<span id="cb129-35"><a href="#cb129-35"></a>    count &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb129-36"><a href="#cb129-36"></a>    low &lt;-<span class="st"> </span><span class="fl">0.00001</span></span>
<span id="cb129-37"><a href="#cb129-37"></a>    up &lt;-<span class="st"> </span><span class="kw">sqrt</span>(df[i])<span class="op">-</span><span class="fl">0.00001</span></span>
<span id="cb129-38"><a href="#cb129-38"></a>    epsilon &lt;-<span class="st"> </span><span class="fl">0.00001</span></span>
<span id="cb129-39"><a href="#cb129-39"></a>    r &lt;-<span class="st"> </span>(up<span class="op">+</span>low)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb129-40"><a href="#cb129-40"></a>    y[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">h</span>(r,df[i])</span>
<span id="cb129-41"><a href="#cb129-41"></a>    <span class="cf">while</span>(<span class="kw">abs</span>(y[<span class="dv">2</span>])<span class="op">&gt;</span>epsilon <span class="op">&amp;&amp;</span><span class="st"> </span>count <span class="op">&lt;</span><span class="st"> </span>N){</span>
<span id="cb129-42"><a href="#cb129-42"></a>      r &lt;-<span class="st"> </span>(up<span class="op">+</span>low)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb129-43"><a href="#cb129-43"></a>      y[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">h</span>(low,df[i])</span>
<span id="cb129-44"><a href="#cb129-44"></a>      y[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">h</span>(up,df[i])</span>
<span id="cb129-45"><a href="#cb129-45"></a>      y[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">h</span>(r,df[i])</span>
<span id="cb129-46"><a href="#cb129-46"></a>      <span class="cf">if</span>(y[<span class="dv">1</span>]<span class="op">*</span>y[<span class="dv">2</span>]<span class="op">&gt;</span><span class="dv">0</span>){</span>
<span id="cb129-47"><a href="#cb129-47"></a>        low &lt;-<span class="st"> </span>r</span>
<span id="cb129-48"><a href="#cb129-48"></a>      }</span>
<span id="cb129-49"><a href="#cb129-49"></a>      <span class="cf">else</span>{</span>
<span id="cb129-50"><a href="#cb129-50"></a>        up &lt;-<span class="st"> </span>r</span>
<span id="cb129-51"><a href="#cb129-51"></a>      }</span>
<span id="cb129-52"><a href="#cb129-52"></a>      count &lt;-<span class="st"> </span>count <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb129-53"><a href="#cb129-53"></a>    }</span>
<span id="cb129-54"><a href="#cb129-54"></a>    <span class="cf">if</span>(count<span class="op">&lt;</span>N){root_Bisection[i] &lt;-<span class="st"> </span>r}</span>
<span id="cb129-55"><a href="#cb129-55"></a>    <span class="cf">else</span>{root_Bisection[i]&lt;-<span class="kw">sqrt</span>(df[i])<span class="op">-</span><span class="fl">0.000001</span>}</span>
<span id="cb129-56"><a href="#cb129-56"></a>  }</span>
<span id="cb129-57"><a href="#cb129-57"></a>}</span>
<span id="cb129-58"><a href="#cb129-58"></a></span>
<span id="cb129-59"><a href="#cb129-59"></a></span>
<span id="cb129-60"><a href="#cb129-60"></a></span>
<span id="cb129-61"><a href="#cb129-61"></a>result &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(df,root_Bisection,root_Brent),<span class="dt">nrow=</span>L,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb129-62"><a href="#cb129-62"></a><span class="kw">colnames</span>(result)&lt;-<span class="kw">c</span>(<span class="st">&quot;df&quot;</span>,<span class="st">&quot;Bisection&quot;</span>,<span class="st">&quot;Brent&quot;</span>)</span>
<span id="cb129-63"><a href="#cb129-63"></a>result</span></code></pre></div>
<pre><code>##         df Bisection     Brent
##  [1,]    4  1.492183  1.492103
##  [2,]    5  1.532926  1.533549
##  [3,]    6  1.562025  1.562768
##  [4,]    7  1.583832  1.584421
##  [5,]    8  1.602037  1.601182
##  [6,]    9  1.617187  1.614517
##  [7,]   10  1.624373  1.625406
##  [8,]   11  1.632401  1.634409
##  [9,]   12  1.637330  1.642026
## [10,]   13  1.647850  1.648511
## [11,]   14  1.651592  1.654174
## [12,]   15  1.664174  1.659121
## [13,]   16  1.656252  1.663442
## [14,]   17  1.675014  1.667288
## [15,]   18  1.657284  1.670736
## [16,]   19  1.668643  1.673841
## [17,]   20  1.677053  1.676589
## [18,]   21  1.682667  1.679139
## [19,]   22  1.685621  1.681461
## [20,]   23  1.686037  4.795831
## [21,]   24  1.684027  4.898978
## [22,]   25  1.718753  4.999999
## [23,]  100  5.000000  9.999999
## [24,]  500 11.180340 22.360679
## [25,] 1000 15.811388 31.622776</code></pre>
</div>
</div>
<div id="section-8" class="section level1">
<h1>2020-11-24</h1>
<div id="answer-1-3" class="section level3">
<h3>Answer 1</h3>
<p>It’s obvious that <span class="math display">\[
1=p^2+q^2+r^2+2pr+2qr+2pq=(p+q+r)^2
\]</span> So <span class="math inline">\(r=1-p-q\)</span>.</p>
<p>Observed data likelihood <span class="math display">\[
L(p,q;n_{A.},n_{B.},n_{OO},n_{AB})=(p^2+2pr)^{n_{A.}}(q^2+2qr)^{n_{B.}}(r^2)^{n_{OO}}(2pq)^{n_{AB}}
\]</span></p>
<p>Complete data likelihood <span class="math display">\[
L(p,q;n_{AA},n_{AO},n_{BB},n_{BO},n_{OO},n_{AB})=(p^2)^{n_{AA}}(q^2)^{n_{BB}}(r^2)^{n_{OO}}(2pq)^{n_{AB}}(2pr)^{n_{AO}}(2qr)^{n_{BO}}
\]</span> <span class="math display">\[
l(p,q;n_{AA},n_{AO},n_{BB},n_{BO},n_{OO},n_{AB})\\
=2n_{OO}\ln(r)+n_{AB}\ln(pq)+n_{A.}\ln(pr)+n_{B.}\ln(qr)+n_{AA}\ln(\frac{p}{r})+n_{BB}\ln(\frac{q}{r})+C\\
=(n_{AB}+n_{A.}+n_{AA})\ln(p)+(n_{AB}+n_{B.}+n_{BB})\ln(q)\\+(-n_{AA}+n_{A.}-n_{BB}+n_{B.}+2n_{OO})\ln(r)\\
=l(p,q|n_{AA},n_{A.},n_{BB},n_{B.},n_{OO},n_{AB})
\]</span> And <span class="math display">\[
n_{AA}|n_{A.},n_{B.},n_{AB},n_{OO}\sim B(n_{A.},\frac{p^2}{p^2+2pr})=B(n_{A.},\frac{p}{p+2r})
\]</span></p>
<p><span class="math display">\[
n_{BB}|n_{A.},n_{B.},n_{AB},n_{OO}\sim B(n_{B.},\frac{q^2}{q^2+2qr})=B(n_{B.},\frac{q}{q+2r})
\]</span></p>
<p>E-step <span class="math display">\[
E_{\hat\theta_m}[l(p,q|n_{AA},n_{A.},n_{BB},n_{B.},n_{OO},n_{AB})|n_{A.},n_{B.},n_{AB},n_{OO}]\\=
(n_{AB}+n_{A.}+n_{A.}\frac{\hat p_m}{2-\hat p_m-2\hat q_m})\ln(p)+(n_{AB}+n_{B.}+n_{B.}\frac{\hat q_m}{2-\hat q_m-2\hat p_m})\ln(q)\\+(-n_{A.}\frac{\hat p_m}{2-\hat p_m-2\hat q_m}+n_{A.}-n_{B.}\frac{\hat q_m}{2-\hat q_m-2\hat p_m}+n_{B.}+2n_{OO})\ln(r)\\
=(n_{AB}+n_{A.}\frac{2-2\hat q_m}{2-\hat p_m-2\hat q_m})\ln(p)+(n_{AB}+n_{B.}\frac{2-2\hat p_m}{2-\hat q_m-2\hat p_m})\ln(q)\\+(n_{A.}\frac{2-2\hat p_m-2\hat q_m }{2-\hat p_m-2\hat q_m}+n_{B.}\frac{2-2\hat p_m-2\hat q_m }{2-\hat q_m-2\hat p_m}+2n_{OO})\ln(1-p-q)
\]</span></p>
<p>M-step <span class="math display">\[
\hat p_{m+1}=\frac{n_{AB}}{2n}+\frac{n_{A.}}{n}\frac{1-\hat q_m}{2-\hat p_m-2\hat q_m}
\]</span></p>
<p><span class="math display">\[
\hat q_{m+1}=\frac{n_{AB}}{2n}+\frac{n_{B.}}{n}\frac{1-\hat p_m}{2-\hat q_m-2\hat p_m}
\]</span></p>
<p><span class="math display">\[
l_o=\ln L_o=c+2n_{OO}\ln r+n_{AB}\ln pq+n_{A.}\ln (2pr+p^2) +n_{B.}\ln(2qr+q^2)
\]</span></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb131-2"><a href="#cb131-2"></a></span>
<span id="cb131-3"><a href="#cb131-3"></a>n_At &lt;-<span class="st"> </span><span class="dv">444</span></span>
<span id="cb131-4"><a href="#cb131-4"></a>n_Bt &lt;-<span class="st"> </span><span class="dv">132</span></span>
<span id="cb131-5"><a href="#cb131-5"></a>n_OO &lt;-<span class="st"> </span><span class="dv">361</span></span>
<span id="cb131-6"><a href="#cb131-6"></a>n_AB &lt;-<span class="st"> </span><span class="dv">63</span></span>
<span id="cb131-7"><a href="#cb131-7"></a>n &lt;-<span class="st"> </span>n_At<span class="op">+</span>n_Bt<span class="op">+</span>n_OO<span class="op">+</span>n_AB</span>
<span id="cb131-8"><a href="#cb131-8"></a>  </span>
<span id="cb131-9"><a href="#cb131-9"></a>  </span>
<span id="cb131-10"><a href="#cb131-10"></a>N &lt;-<span class="st"> </span><span class="dv">15</span></span>
<span id="cb131-11"><a href="#cb131-11"></a>p_hat &lt;-<span class="st"> </span>q_hat &lt;-<span class="st"> </span>r_hat &lt;-<span class="st"> </span>l&lt;-<span class="st"> </span><span class="kw">numeric</span>(N)<span class="co">##l is the log-likelihood without constant</span></span>
<span id="cb131-12"><a href="#cb131-12"></a>p_hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="fl">0.2</span> </span>
<span id="cb131-13"><a href="#cb131-13"></a>q_hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="fl">0.3</span> </span>
<span id="cb131-14"><a href="#cb131-14"></a>r_hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p_hat[<span class="dv">1</span>]<span class="op">-</span>q_hat[<span class="dv">1</span>]</span>
<span id="cb131-15"><a href="#cb131-15"></a>l[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>n_OO<span class="op">*</span><span class="kw">log</span>(r_hat[<span class="dv">1</span>])<span class="op">+</span>n_AB<span class="op">*</span><span class="kw">log</span>(p_hat[<span class="dv">1</span>]<span class="op">*</span>q_hat[<span class="dv">1</span>]) <span class="op">+</span>n_At<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p_hat[<span class="dv">1</span>]<span class="op">*</span>r_hat[<span class="dv">1</span>]<span class="op">+</span>p_hat[<span class="dv">1</span>]<span class="op">*</span>p_hat[<span class="dv">1</span>])<span class="op">+</span>n_Bt<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q_hat[<span class="dv">1</span>]<span class="op">*</span>r_hat[<span class="dv">1</span>]<span class="op">+</span>q_hat[<span class="dv">1</span>]<span class="op">*</span>q_hat[<span class="dv">1</span>])</span>
<span id="cb131-16"><a href="#cb131-16"></a></span>
<span id="cb131-17"><a href="#cb131-17"></a></span>
<span id="cb131-18"><a href="#cb131-18"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb131-19"><a href="#cb131-19"></a>  p_hat[j] &lt;-<span class="st"> </span>n_AB<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)<span class="op">+</span>n_At<span class="op">/</span>n<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q_hat[j<span class="dv">-1</span>])<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>r_hat[j<span class="dv">-1</span>]<span class="op">+</span>p_hat[j<span class="dv">-1</span>])</span>
<span id="cb131-20"><a href="#cb131-20"></a>  q_hat[j] &lt;-<span class="st"> </span>n_AB<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)<span class="op">+</span>n_Bt<span class="op">/</span>n<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p_hat[j<span class="dv">-1</span>])<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>r_hat[j<span class="dv">-1</span>]<span class="op">+</span>q_hat[j<span class="dv">-1</span>])</span>
<span id="cb131-21"><a href="#cb131-21"></a>  r_hat[j] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p_hat[j]<span class="op">-</span>q_hat[j]</span>
<span id="cb131-22"><a href="#cb131-22"></a>  l[j] &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>n_OO<span class="op">*</span><span class="kw">log</span>(r_hat[j])<span class="op">+</span>n_AB<span class="op">*</span><span class="kw">log</span>(p_hat[j]<span class="op">*</span>q_hat[j]) <span class="op">+</span>n_At<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p_hat[j]<span class="op">*</span>r_hat[j]<span class="op">+</span>p_hat[j]<span class="op">*</span>p_hat[j])<span class="op">+</span>n_Bt<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q_hat[j]<span class="op">*</span>r_hat[j]<span class="op">+</span>q_hat[j]<span class="op">*</span>q_hat[j])</span>
<span id="cb131-23"><a href="#cb131-23"></a>} </span>
<span id="cb131-24"><a href="#cb131-24"></a></span>
<span id="cb131-25"><a href="#cb131-25"></a>re &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(p_hat,q_hat,r_hat,l),<span class="dt">nrow=</span>N,<span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb131-26"><a href="#cb131-26"></a><span class="kw">colnames</span>(re) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;p_hat&quot;</span>,<span class="st">&quot;q_hat&quot;</span>,<span class="st">&quot;r_hat&quot;</span>,<span class="st">&quot;log-likelihood&quot;</span>)</span>
<span id="cb131-27"><a href="#cb131-27"></a>re</span></code></pre></div>
<pre><code>##           p_hat     q_hat     r_hat log-likelihood
##  [1,] 0.2000000 0.3000000 0.5000000      -1435.629
##  [2,] 0.2905000 0.1127308 0.5967692      -1214.536
##  [3,] 0.2969564 0.1031958 0.5998478      -1213.493
##  [4,] 0.2975479 0.1027275 0.5997246      -1213.490
##  [5,] 0.2976254 0.1027067 0.5996679      -1213.490
##  [6,] 0.2976380 0.1027062 0.5996559      -1213.490
##  [7,] 0.2976402 0.1027062 0.5996536      -1213.490
##  [8,] 0.2976406 0.1027063 0.5996532      -1213.490
##  [9,] 0.2976406 0.1027063 0.5996531      -1213.490
## [10,] 0.2976407 0.1027063 0.5996531      -1213.490
## [11,] 0.2976407 0.1027063 0.5996531      -1213.490
## [12,] 0.2976407 0.1027063 0.5996531      -1213.490
## [13,] 0.2976407 0.1027063 0.5996531      -1213.490
## [14,] 0.2976407 0.1027063 0.5996531      -1213.490
## [15,] 0.2976407 0.1027063 0.5996531      -1213.490</code></pre>
<p>As we can see,</p>
<p>the corresponding log-maximum likelihood values (for observed data) are increasing each step.</p>
</div>
<div id="answer-2-3" class="section level3">
<h3>Answer 2</h3>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb133-2"><a href="#cb133-2"></a></span>
<span id="cb133-3"><a href="#cb133-3"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb133-4"><a href="#cb133-4"></a>mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb133-5"><a href="#cb133-5"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb133-6"><a href="#cb133-6"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb133-7"><a href="#cb133-7"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb133-8"><a href="#cb133-8"></a>)</span>
<span id="cb133-9"><a href="#cb133-9"></a></span>
<span id="cb133-10"><a href="#cb133-10"></a>l1 &lt;-<span class="st"> </span>list</span>
<span id="cb133-11"><a href="#cb133-11"></a>l2 &lt;-<span class="st"> </span>list</span>
<span id="cb133-12"><a href="#cb133-12"></a>l3 &lt;-<span class="st"> </span>list</span>
<span id="cb133-13"><a href="#cb133-13"></a>l4 &lt;-<span class="st"> </span>list</span>
<span id="cb133-14"><a href="#cb133-14"></a>Lm &lt;-<span class="st"> </span><span class="kw">list</span>(l1,l2,l3,l4)</span>
<span id="cb133-15"><a href="#cb133-15"></a></span>
<span id="cb133-16"><a href="#cb133-16"></a></span>
<span id="cb133-17"><a href="#cb133-17"></a></span>
<span id="cb133-18"><a href="#cb133-18"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb133-19"><a href="#cb133-19"></a>mtcars.list &lt;-<span class="st"> </span><span class="kw">split</span>(mtcars, mtcars<span class="op">$</span>cyl)</span>
<span id="cb133-20"><a href="#cb133-20"></a>mylm &lt;-<span class="st"> </span><span class="cf">function</span>(x, form, me) <span class="kw">lm</span>(form, x, <span class="dt">method =</span> me)</span>
<span id="cb133-21"><a href="#cb133-21"></a>Lm[[i]] &lt;-<span class="st"> </span><span class="kw">lapply</span>(mtcars.list, mylm, formulas[[i]], <span class="st">&quot;qr&quot;</span>)</span>
<span id="cb133-22"><a href="#cb133-22"></a>}</span>
<span id="cb133-23"><a href="#cb133-23"></a>Lm</span></code></pre></div>
<pre><code>## [[1]]
## [[1]]$`4`
## 
## Call:
## lm(formula = form, data = x, method = me)
## 
## Coefficients:
## (Intercept)         disp  
##     40.8720      -0.1351  
## 
## 
## [[1]]$`6`
## 
## Call:
## lm(formula = form, data = x, method = me)
## 
## Coefficients:
## (Intercept)         disp  
##   19.081987     0.003605  
## 
## 
## [[1]]$`8`
## 
## Call:
## lm(formula = form, data = x, method = me)
## 
## Coefficients:
## (Intercept)         disp  
##    22.03280     -0.01963  
## 
## 
## 
## [[2]]
## [[2]]$`4`
## 
## Call:
## lm(formula = form, data = x, method = me)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       11.92      1457.80  
## 
## 
## [[2]]$`6`
## 
## Call:
## lm(formula = form, data = x, method = me)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       19.98       -41.15  
## 
## 
## [[2]]$`8`
## 
## Call:
## lm(formula = form, data = x, method = me)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       8.669     2197.933  
## 
## 
## 
## [[3]]
## [[3]]$`4`
## 
## Call:
## lm(formula = form, data = x, method = me)
## 
## Coefficients:
## (Intercept)         disp           wt  
##     41.1350      -0.1225      -0.6978  
## 
## 
## [[3]]$`6`
## 
## Call:
## lm(formula = form, data = x, method = me)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    28.18835      0.01914     -3.83510  
## 
## 
## [[3]]$`8`
## 
## Call:
## lm(formula = form, data = x, method = me)
## 
## Coefficients:
## (Intercept)         disp           wt  
##   24.077855    -0.002512    -2.023138  
## 
## 
## 
## [[4]]
## [[4]]$`4`
## 
## Call:
## lm(formula = form, data = x, method = me)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##     15.3196    1312.7036      -0.8446  
## 
## 
## [[4]]$`6`
## 
## Call:
## lm(formula = form, data = x, method = me)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      36.618     -759.107       -4.034  
## 
## 
## [[4]]$`8`
## 
## Call:
## lm(formula = form, data = x, method = me)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      22.626      260.622       -2.073</code></pre>
</div>
<div id="answer-3-3" class="section level3">
<h3>Answer 3</h3>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb135-2"><a href="#cb135-2"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb135-3"><a href="#cb135-3"></a><span class="dv">100</span>,</span>
<span id="cb135-4"><a href="#cb135-4"></a><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb135-5"><a href="#cb135-5"></a><span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb135-6"><a href="#cb135-6"></a>)</span>
<span id="cb135-7"><a href="#cb135-7"></a><span class="kw">sapply</span>(trials,<span class="cf">function</span>(x) x[[<span class="st">&quot;p.value&quot;</span>]])</span></code></pre></div>
<pre><code>##   [1] 0.985437251 0.532749698 0.978836835 0.315174248 0.921314446 0.883463167
##   [7] 0.041695770 0.677729563 0.202297483 0.545344206 0.665523144 0.259980805
##  [13] 0.023920878 0.487345080 0.876435804 0.509672161 0.838848368 0.446998095
##  [19] 0.859058448 0.409316885 0.388242960 0.612654353 0.544802154 0.825190873
##  [25] 0.306580430 0.160329094 0.896343277 0.042342135 0.919318402 0.651793115
##  [31] 0.693042837 0.936728270 0.082523322 0.611649307 0.237830492 0.110428523
##  [37] 0.329328737 0.317353496 0.011372117 0.923625392 0.959556164 0.846634922
##  [43] 0.793780421 0.773401258 0.041488281 0.523214941 0.592418287 0.210329726
##  [49] 0.025376608 0.761461181 0.459093531 0.459735669 0.845187015 0.871731461
##  [55] 0.792785717 0.870329055 0.561587111 0.495988755 0.765329628 0.500057597
##  [61] 0.128992747 0.417173828 0.847974230 0.160903238 0.525452017 0.356270195
##  [67] 0.438360326 0.561868122 0.280737888 0.007634617 0.116885139 0.384203925
##  [73] 0.140884429 0.039122398 0.105653487 0.954696645 0.081334754 0.604068420
##  [79] 0.419869549 0.758859628 0.433498606 0.375566910 0.200059841 0.275349327
##  [85] 0.161982604 0.419044571 0.084695829 0.425861900 0.462522012 0.084198442
##  [91] 0.558496009 0.901083724 0.599393977 0.523167903 0.837708038 0.125477390
##  [97] 0.101650633 0.645513361 0.665117035 0.380066180</code></pre>
</div>
<div id="answer-4-2" class="section level3">
<h3>Answer 4</h3>
<p>The parameter: function, data, function.value</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb137-2"><a href="#cb137-2"></a></span>
<span id="cb137-3"><a href="#cb137-3"></a>new_lapply&lt;-<span class="cf">function</span>(x,y,f,f.value,...){</span>
<span id="cb137-4"><a href="#cb137-4"></a>  L &lt;-<span class="st"> </span><span class="kw">list</span>(x,y)</span>
<span id="cb137-5"><a href="#cb137-5"></a>  l&lt;-<span class="kw">Map</span>(unlist,L)</span>
<span id="cb137-6"><a href="#cb137-6"></a>  re &lt;-<span class="st"> </span><span class="kw">vapply</span>(l,f,f.value,...)</span>
<span id="cb137-7"><a href="#cb137-7"></a>  <span class="kw">return</span>(re)</span>
<span id="cb137-8"><a href="#cb137-8"></a>}</span>
<span id="cb137-9"><a href="#cb137-9"></a></span>
<span id="cb137-10"><a href="#cb137-10"></a>z_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">26</span>,<span class="dv">43</span>,<span class="dv">51</span>,<span class="dv">57</span>,<span class="dv">28</span>,<span class="dv">73</span>)</span>
<span id="cb137-11"><a href="#cb137-11"></a>z_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">35</span>,<span class="dv">60</span>,<span class="dv">53</span>,<span class="dv">27</span>,<span class="dv">48</span>,<span class="dv">23</span>)</span>
<span id="cb137-12"><a href="#cb137-12"></a><span class="kw">new_lapply</span>(z_<span class="dv">1</span>,z_<span class="dv">2</span>,sum,<span class="kw">double</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 278 246</code></pre>
</div>
</div>
<div id="section-9" class="section level1">
<h1>2020-12-1</h1>
</div>
<div id="question-5" class="section level1">
<h1>Question</h1>
<ol style="list-style-type: decimal">
<li><p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution . For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.(Rcpp function)</p></li>
<li><p>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</p></li>
<li><p>Campare the computation time of the two functions with the function “microbenchmark”.</p></li>
<li><p>Comments your results.</p></li>
</ol>
</div>
<div id="answer-16" class="section level1">
<h1>Answer</h1>
<p>We can know that if <span class="math display">\[
U,V \text{i.i.d}\sim U(0,1)
\]</span> then <span class="math display">\[
Z=\sqrt{-2\ln(U)}\sin(2\pi V)\sim N(0,1)
\]</span> I use this method to generate the sample of normal distribution in Cpp.</p>
<div id="r-code" class="section level3">
<h3>R-code</h3>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb139-2"><a href="#cb139-2"></a><span class="kw">library</span>(<span class="st">&quot;Rcpp&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a><span class="kw">library</span>(<span class="st">&quot;microbenchmark&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a>R_Lap &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb143-2"><a href="#cb143-2"></a>  p &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb143-3"><a href="#cb143-3"></a>  count &lt;-<span class="st"> </span><span class="kw">numeric</span>(N<span class="dv">-1</span>)</span>
<span id="cb143-4"><a href="#cb143-4"></a>  Sample &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb143-5"><a href="#cb143-5"></a>  Sample[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb143-6"><a href="#cb143-6"></a> </span>
<span id="cb143-7"><a href="#cb143-7"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(N<span class="dv">-1</span>)) {</span>
<span id="cb143-8"><a href="#cb143-8"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, Sample[i], sigma)</span>
<span id="cb143-9"><a href="#cb143-9"></a>  r &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(Sample[i])<span class="op">-</span><span class="kw">abs</span>(y))</span>
<span id="cb143-10"><a href="#cb143-10"></a>  <span class="cf">if</span> (p[i] <span class="op">&gt;</span><span class="st"> </span>r) {</span>
<span id="cb143-11"><a href="#cb143-11"></a>    Sample[i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>Sample[i]</span>
<span id="cb143-12"><a href="#cb143-12"></a>    count[i] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb143-13"><a href="#cb143-13"></a>  }  </span>
<span id="cb143-14"><a href="#cb143-14"></a>  <span class="cf">else</span> {</span>
<span id="cb143-15"><a href="#cb143-15"></a>    Sample[i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>y</span>
<span id="cb143-16"><a href="#cb143-16"></a>    count[i] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb143-17"><a href="#cb143-17"></a>  }</span>
<span id="cb143-18"><a href="#cb143-18"></a> }</span>
<span id="cb143-19"><a href="#cb143-19"></a> sum_count &lt;-<span class="st"> </span><span class="kw">sum</span>(count)</span>
<span id="cb143-20"><a href="#cb143-20"></a> ac &lt;-<span class="st"> </span>sum_count<span class="op">/</span>N</span>
<span id="cb143-21"><a href="#cb143-21"></a> <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">Sample =</span> Sample, <span class="dt">ac =</span> ac))</span>
<span id="cb143-22"><a href="#cb143-22"></a>}</span>
<span id="cb143-23"><a href="#cb143-23"></a></span>
<span id="cb143-24"><a href="#cb143-24"></a></span>
<span id="cb143-25"><a href="#cb143-25"></a><span class="kw">sourceCpp</span>(<span class="dt">code=</span><span class="st">&#39;</span></span>
<span id="cb143-26"><a href="#cb143-26"></a><span class="st">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb143-27"><a href="#cb143-27"></a><span class="st">#include &lt;stdlib.h&gt;</span></span>
<span id="cb143-28"><a href="#cb143-28"></a><span class="st">#include &lt;stdio.h&gt;</span></span>
<span id="cb143-29"><a href="#cb143-29"></a><span class="st">#include &lt;math.h&gt;</span></span>
<span id="cb143-30"><a href="#cb143-30"></a><span class="st">#define PI 3.141592654</span></span>
<span id="cb143-31"><a href="#cb143-31"></a></span>
<span id="cb143-32"><a href="#cb143-32"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb143-33"><a href="#cb143-33"></a><span class="st">//[[Rcpp::export]]</span></span>
<span id="cb143-34"><a href="#cb143-34"></a></span>
<span id="cb143-35"><a href="#cb143-35"></a><span class="st">double C_runif(double min, double max){</span></span>
<span id="cb143-36"><a href="#cb143-36"></a><span class="st">  double x,t;</span></span>
<span id="cb143-37"><a href="#cb143-37"></a><span class="st">  double z=RAND_MAX+1.0;</span></span>
<span id="cb143-38"><a href="#cb143-38"></a><span class="st">  x = rand()/z;</span></span>
<span id="cb143-39"><a href="#cb143-39"></a><span class="st">  t = min+ (max-min)*x;</span></span>
<span id="cb143-40"><a href="#cb143-40"></a><span class="st">  return t;</span></span>
<span id="cb143-41"><a href="#cb143-41"></a><span class="st">}</span></span>
<span id="cb143-42"><a href="#cb143-42"></a></span>
<span id="cb143-43"><a href="#cb143-43"></a><span class="st">//[[Rcpp::export]]</span></span>
<span id="cb143-44"><a href="#cb143-44"></a></span>
<span id="cb143-45"><a href="#cb143-45"></a><span class="st">double C_rnorm(double mu,double sigma){</span></span>
<span id="cb143-46"><a href="#cb143-46"></a><span class="st">  double U,V;</span></span>
<span id="cb143-47"><a href="#cb143-47"></a><span class="st">  double Z,norm;</span></span>
<span id="cb143-48"><a href="#cb143-48"></a><span class="st">  U = C_runif(0,1);</span></span>
<span id="cb143-49"><a href="#cb143-49"></a><span class="st">  V = C_runif(0,1);</span></span>
<span id="cb143-50"><a href="#cb143-50"></a><span class="st">  Z = sqrt(-2.0 * log(U))* sin(2.0 * PI * V);</span></span>
<span id="cb143-51"><a href="#cb143-51"></a><span class="st">  norm = mu+Z*sigma;</span></span>
<span id="cb143-52"><a href="#cb143-52"></a><span class="st">  return(norm);</span></span>
<span id="cb143-53"><a href="#cb143-53"></a><span class="st">}</span></span>
<span id="cb143-54"><a href="#cb143-54"></a></span>
<span id="cb143-55"><a href="#cb143-55"></a><span class="st">//[[Rcpp::export]]</span></span>
<span id="cb143-56"><a href="#cb143-56"></a></span>
<span id="cb143-57"><a href="#cb143-57"></a><span class="st">NumericVector C_Lap(double sigma,double x0,int N){</span></span>
<span id="cb143-58"><a href="#cb143-58"></a><span class="st">NumericVector Sample(N+1);</span></span>
<span id="cb143-59"><a href="#cb143-59"></a><span class="st">Sample[0] = x0;</span></span>
<span id="cb143-60"><a href="#cb143-60"></a><span class="st">int count=0;</span></span>
<span id="cb143-61"><a href="#cb143-61"></a><span class="st">double y,p,r;</span></span>
<span id="cb143-62"><a href="#cb143-62"></a><span class="st">for(int i=1; i&lt;N; i++){</span></span>
<span id="cb143-63"><a href="#cb143-63"></a><span class="st">  p = C_runif(0,1);</span></span>
<span id="cb143-64"><a href="#cb143-64"></a><span class="st">  y = C_rnorm(Sample[i-1],sigma);</span></span>
<span id="cb143-65"><a href="#cb143-65"></a><span class="st">  r = exp(fabs(Sample[i-1])-fabs(y));</span></span>
<span id="cb143-66"><a href="#cb143-66"></a><span class="st">  if (p &lt;= r) {</span></span>
<span id="cb143-67"><a href="#cb143-67"></a><span class="st">    Sample[i]=y;</span></span>
<span id="cb143-68"><a href="#cb143-68"></a><span class="st">    count = count+1;</span></span>
<span id="cb143-69"><a href="#cb143-69"></a><span class="st">  }</span></span>
<span id="cb143-70"><a href="#cb143-70"></a><span class="st">  else{</span></span>
<span id="cb143-71"><a href="#cb143-71"></a><span class="st">    Sample[i] = Sample[i-1];</span></span>
<span id="cb143-72"><a href="#cb143-72"></a><span class="st">  }</span></span>
<span id="cb143-73"><a href="#cb143-73"></a><span class="st">}</span></span>
<span id="cb143-74"><a href="#cb143-74"></a><span class="st">double c=count;</span></span>
<span id="cb143-75"><a href="#cb143-75"></a><span class="st">Sample[N]=c/N;</span></span>
<span id="cb143-76"><a href="#cb143-76"></a><span class="st">return Sample;</span></span>
<span id="cb143-77"><a href="#cb143-77"></a><span class="st">} &#39;</span>)<span class="co">## the acceptance rate is the last element in the array</span></span>
<span id="cb143-78"><a href="#cb143-78"></a></span>
<span id="cb143-79"><a href="#cb143-79"></a></span>
<span id="cb143-80"><a href="#cb143-80"></a>N &lt;-<span class="st"> </span><span class="dv">3000</span></span>
<span id="cb143-81"><a href="#cb143-81"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.6</span>,<span class="fl">3.6</span>,<span class="dv">12</span>)</span>
<span id="cb143-82"><a href="#cb143-82"></a>L &lt;-<span class="st"> </span><span class="kw">length</span>(sigma)</span>
<span id="cb143-83"><a href="#cb143-83"></a>x_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb143-84"><a href="#cb143-84"></a>accept_rate &lt;-<span class="st"> </span><span class="kw">numeric</span>(L)</span>
<span id="cb143-85"><a href="#cb143-85"></a>C_ac &lt;-<span class="st"> </span><span class="kw">numeric</span>(L)</span>
<span id="cb143-86"><a href="#cb143-86"></a></span>
<span id="cb143-87"><a href="#cb143-87"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb143-88"><a href="#cb143-88"></a>C1 &lt;-<span class="st"> </span><span class="kw">C_Lap</span>(sigma[<span class="dv">1</span>],x_<span class="dv">1</span>,N) </span>
<span id="cb143-89"><a href="#cb143-89"></a>C_ac[<span class="dv">1</span>] &lt;-<span class="st"> </span>C1[N<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb143-90"><a href="#cb143-90"></a>C_Sample1 &lt;-<span class="st"> </span>C1[<span class="dv">1</span><span class="op">:</span>N]</span>
<span id="cb143-91"><a href="#cb143-91"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb143-92"><a href="#cb143-92"></a>C2 &lt;-<span class="st"> </span><span class="kw">C_Lap</span>(sigma[<span class="dv">2</span>],x_<span class="dv">1</span>,N) </span>
<span id="cb143-93"><a href="#cb143-93"></a>C_ac[<span class="dv">2</span>] &lt;-<span class="st"> </span>C2[N<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb143-94"><a href="#cb143-94"></a>C_Sample2 &lt;-<span class="st"> </span>C2[<span class="dv">1</span><span class="op">:</span>N]</span>
<span id="cb143-95"><a href="#cb143-95"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb143-96"><a href="#cb143-96"></a>C3 &lt;-<span class="st"> </span><span class="kw">C_Lap</span>(sigma[<span class="dv">3</span>],x_<span class="dv">1</span>,N) </span>
<span id="cb143-97"><a href="#cb143-97"></a>C_ac[<span class="dv">3</span>] &lt;-<span class="st"> </span>C3[N<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb143-98"><a href="#cb143-98"></a>C_Sample3 &lt;-<span class="st"> </span>C3[<span class="dv">1</span><span class="op">:</span>N]</span>
<span id="cb143-99"><a href="#cb143-99"></a><span class="kw">set.seed</span>(<span class="dv">20077</span>)</span>
<span id="cb143-100"><a href="#cb143-100"></a>C4 &lt;-<span class="st"> </span><span class="kw">C_Lap</span>(sigma[<span class="dv">4</span>],x_<span class="dv">1</span>,N) </span>
<span id="cb143-101"><a href="#cb143-101"></a>C_ac[<span class="dv">4</span>] &lt;-<span class="st"> </span>C4[N<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb143-102"><a href="#cb143-102"></a>C_Sample4 &lt;-<span class="st"> </span>C4[<span class="dv">1</span><span class="op">:</span>N]</span>
<span id="cb143-103"><a href="#cb143-103"></a></span>
<span id="cb143-104"><a href="#cb143-104"></a>print_C_ac  &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(sigma,C_ac),<span class="dt">nrow=</span>L,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">dimnames=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>),<span class="kw">c</span>(<span class="st">&quot;sigma&quot;</span>,<span class="st">&quot;accept rate&quot;</span>)))</span>
<span id="cb143-105"><a href="#cb143-105"></a>print_C_ac</span></code></pre></div>
<pre><code>##   sigma accept rate
## 1   0.1   0.9600000
## 2   0.6   0.8036667
## 3   3.6   0.3573333
## 4  12.0   0.1350000</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a><span class="co">#par(mfrow=c(2,2)) </span></span>
<span id="cb145-2"><a href="#cb145-2"></a>Sample_C =<span class="st"> </span><span class="kw">cbind</span>(C_Sample1, C_Sample2, C_Sample3,  C_Sample4)</span>
<span id="cb145-3"><a href="#cb145-3"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb145-4"><a href="#cb145-4"></a>  <span class="kw">plot</span>(Sample_C[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb145-5"><a href="#cb145-5"></a>  <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb145-6"><a href="#cb145-6"></a>        <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(Sample_C[,j]))</span>
<span id="cb145-7"><a href="#cb145-7"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQ2/+2ZgC2Zjq2Zma22/+2/7a2///bkDrbtpDb////tmb/25D//7b//9v///+F+YrkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIw0lEQVR4nO3dC1ujOBgF4M9R92J3d3Yc9zJdseb//8kthYSEJJwEEgrtOc8zYy25kNdwUQFFMZORa6/A1kMgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCB5QJ+vcsmXH7HmdpMqQEd56V40+sWi5q6ZKkCfr4bl+Pi+uLmrpgrQ6fBNv2wiG9l9A9WcQWvL1toH9VOo/D7oNoDOG1l3CIjMHwLVa+7GgfJPL+qsR4X+OINKFazc3E0A6V10m9LnQTcBdD4Rin4TNqe5IhVr95f7zepTyeZKVKzdX+aKNfJtcvndA1VrjkC1Ktbuj0ClClZujkC1Ktbuj0ClClZujkC1Ktbuj0ClClZujkC1Ktbuj0ClClZujkDzK1axI9D8/qr2TqBazRFofsX9AJ0O7W/km/jvNAj00l/XYV0IM7+51Ir7Aupp1rz8RZa1nN3fzIKqA/p4vgCNLqCq+rv5fQFxBk2k+9Xzk9K764XNOTUkXnk/QOpi9PA9foFZYSDx/p8ds/GL8yGh4rJ+lzc3Dyi7n3sHgv3eMJAUAJK7BhqqRnvfEVBkMwoCyWwgf4LdBtBo4RhIvFpDVbeM19LWgPxWR+sXrJECFOggBuR46rblPoF0GZEgkIh5ZztA3iSP9GePCAHJXQINCgEgMYNtxzgB1LdiAfVv6Ya2C+QeYPKAZItAf4MrfVOak25I1lsW0OiNaSA9NJkAkjiQ+EDiNZAwotNX/fnHM7oUOqG5buMwY7G+cGMgEQ/I3nV4QKEJsArQ4fw9epu3+I+bM5rrgfSqmIFJBEj6ETlAMgDJMiBdUeYDtbczP7XTR8CF4mnN9cPRHkWBhh5Mnw6QmZAaSIoAtb+sePhD+nk0P9YMGgGZzzCQWE0MQDKwTwLpiVMaqJ9EC5MEZE2URCAZAckMIFkIdGxn0LIdkEoBGjY3MduEGbxZkAEkpmRNoNOhnT7n/2M/S80F0qs8ApJEILGBhiirvCk9Lml0XeZFQOWPYmEgscYQBTKUMSCrFZvGAXKkCgAVPw9ygWyIYQzO8GYAufvuqkB2ipxJDyQYyBrlMGJn0VwgqQI0Ffz0lyygIMIUUMjLa8hUtoBkHaDkp7+EgawxAKAyWR0o/dkdFskEUGGNMJBfoh5Q/OkvztBjow+ubeaYlxSuDzRrBkWGMB5PaHzpQGqysHI+1N0HJT79JXuEdYBU6EPVo1jq01/8EXrrPyoTml7B3UqssdAXxT6arQOU2py9XsO6jhHs1VbBgYWAQrPFBRpOMp0V2SKQe06nbAdz0E0CcoefD6TU5oH6oSl96B/OSsZYSn//FgNSzoQIA6m9ALnnjPq71BCQMsN3gJQ9z6aBlPmoi4SAMsddDUh5QEr/M3NkPpA1O1UqkD2BtgykYkAqBUiFgFQIaNhudwI0LA4A9e+bl8Nw1QCkLCA1C0gN7WeOqFR0c0WBlAfUFzGb1whI7QRIDyMMpDSQM2YLSI2AdBM3AaQQkIoBjV6J+SQCpFwgZQGp4f99A1nVPaChnjeyEJCaAlKbBAqcfSQBec0uADKlNwmk1BhI2UuS1mY2kLo/ILfyFJDb5MaBIr2lAgWX6dPPAcgUjAIFJiLIKkDe2polkt4/AhoVjHW1RSD/y2nez+jeB7IaSQeKtZbc7bJMHIVCvVUE8kqvAJRz13PizrcI0GjplYES73q+W6DUe1bvFih81zNqLtpLCaDUddjWDErspQZQrP4aQO05ceG7npOzAyAVvevZ/Dzz7oFWbq5k0+sBWdcwlGhurRAIhEAgBAIhEMjNH8WWhkAoBAIhEAiBQAgEQiAQAoEQKCcEAiEQCIFArga0m1wJCDYaX3T9JSWKL270+gwEmr2kRPHFjV6fgUCzl5QovrjR6zMQaPaSEsUXN3p9BgLNXlKi+P2FQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQMoDNZL6WOqPn384FfwXo1yec/mSV0cd40VTVrU4UNPeqpAkdDpcbhkyFfwXo3y+nt88tjeLpNdRx3MnkaJJq1oaqLsE9i3h0d1Nd+OiqeC/GKe7Fes84ow6l9tuPl9DRdNWtTSQGQQq2MjL5aYzU8F/Ean48D23TguU3U+f4kA/tVM2dr+dmw5IV/BfhGu9hYpO1zmet6PsfvqUBuq26bSd0GXdTAX/RbjSeS+dV6e57Nhz+9HZG1Cj99E5g/18fXzfClDlTay7lS97c2n3WxvZxJJ30koD5ew8+wdaZ+9wz4u3spNOP8z3QDmHX/2w3exTgybr1MDJFU8U+9mdfgL38axvM8o46Xt7fO8oNnKiaJ3aw/Sbv6ngv/BabtMuSq7T/iUM6SZeRh0r/GYVhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBALZC5Dza/SP5+7B6GtkJ0DmYt42zeO7Oh1WEtoHkLmYt013XU/aNVrLsw+gSzRQd+ncWtkU0Odfz5crgMKPYz72m1jz5d9DrEz5bAro7fEf9fE1/Bc7GmNybK/Q19OperYE1F92+uvlk7f+WWODQ3sxb/uxm0lpF9Iuz5aAujGffovtYvrDWLd77v+GTvVsECj2l6fcvyu01q56S0AdTc/gbGLmYt6h2D1uYudt6E+zp3FjLuZtc7Q/qZ1NAan/fhf5JXgU6y/m7Q5eTfRUoHy2BbTBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgkP8BvoxD8WSLcgIAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1"></a>R_Sample1 &lt;-<span class="st"> </span><span class="kw">R_Lap</span>(sigma[<span class="dv">1</span>],x_<span class="dv">1</span>,N)<span class="op">$</span>Sample</span>
<span id="cb146-2"><a href="#cb146-2"></a>R_Sample2 &lt;-<span class="st"> </span><span class="kw">R_Lap</span>(sigma[<span class="dv">2</span>],x_<span class="dv">1</span>,N)<span class="op">$</span>Sample</span>
<span id="cb146-3"><a href="#cb146-3"></a>R_Sample3 &lt;-<span class="st"> </span><span class="kw">R_Lap</span>(sigma[<span class="dv">3</span>],x_<span class="dv">1</span>,N)<span class="op">$</span>Sample</span>
<span id="cb146-4"><a href="#cb146-4"></a>R_Sample4 &lt;-<span class="st"> </span><span class="kw">R_Lap</span>(sigma[<span class="dv">4</span>],x_<span class="dv">1</span>,N)<span class="op">$</span>Sample</span>
<span id="cb146-5"><a href="#cb146-5"></a></span>
<span id="cb146-6"><a href="#cb146-6"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb146-7"><a href="#cb146-7"></a><span class="kw">qqplot</span>(C_Sample1,R_Sample1)</span>
<span id="cb146-8"><a href="#cb146-8"></a><span class="kw">lines</span>(C_Sample1,C_Sample1,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a><span class="kw">qqplot</span>(C_Sample2,R_Sample2)</span>
<span id="cb147-2"><a href="#cb147-2"></a><span class="kw">lines</span>(C_Sample2,C_Sample2,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1"></a><span class="kw">qqplot</span>(C_Sample3,R_Sample3)</span>
<span id="cb148-2"><a href="#cb148-2"></a><span class="kw">lines</span>(C_Sample3,C_Sample3,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a><span class="kw">qqplot</span>(C_Sample4,R_Sample4)</span>
<span id="cb149-2"><a href="#cb149-2"></a><span class="kw">lines</span>(C_Sample4,C_Sample4,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1"></a>a &lt;-<span class="st"> </span>sigma[<span class="dv">1</span>]</span>
<span id="cb150-2"><a href="#cb150-2"></a>b &lt;-<span class="st"> </span>sigma[<span class="dv">2</span>]</span>
<span id="cb150-3"><a href="#cb150-3"></a>c &lt;-<span class="st"> </span>sigma[<span class="dv">3</span>]</span>
<span id="cb150-4"><a href="#cb150-4"></a>d &lt;-<span class="st"> </span>sigma[<span class="dv">4</span>]</span>
<span id="cb150-5"><a href="#cb150-5"></a>z &lt;-<span class="st"> </span>x_<span class="dv">1</span> </span>
<span id="cb150-6"><a href="#cb150-6"></a></span>
<span id="cb150-7"><a href="#cb150-7"></a>microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(<span class="kw">C_Lap</span>(a,z,N),<span class="kw">R_Lap</span>(a,z,N),<span class="kw">C_Lap</span>(b,z,N),<span class="kw">R_Lap</span>(b,z,N),<span class="kw">C_Lap</span>(c,z,N),<span class="kw">R_Lap</span>(c,z,N),<span class="kw">C_Lap</span>(d,z,N),<span class="kw">R_Lap</span>(d,z,N))   </span></code></pre></div>
<pre><code>## Unit: microseconds
##            expr    min      lq     mean  median      uq     max neval
##  C_Lap(a, z, N)  451.2  457.35  524.955  463.00  476.95   832.9   100
##  R_Lap(a, z, N) 6066.4 6144.45 7257.249 6249.90 6524.70 16286.9   100
##  C_Lap(b, z, N)  462.7  465.85  537.891  471.20  479.35  2132.3   100
##  R_Lap(b, z, N) 6095.7 6161.95 7169.982 6245.75 6491.10 12421.8   100
##  C_Lap(c, z, N)  473.2  476.55  557.035  483.15  498.55  2143.1   100
##  R_Lap(c, z, N) 6118.4 6195.05 6993.225 6264.70 6474.35 12311.5   100
##  C_Lap(d, z, N)  458.2  465.00  517.617  468.50  475.10  1402.3   100
##  R_Lap(d, z, N) 6125.1 6191.65 7328.390 6274.45 6463.80 16538.8   100</code></pre>
</div>
<div id="comment" class="section level3">
<h3>Comment</h3>
<p>1 As we can see,if sigma is small ,the Chain 1 from Rcpp function has not converged to the target in 3000 iterations;if sigma is too small or too big,the acceptance rate is not in [0.15,0.5].</p>
<p>2 When sigma become bigger,the bias between C sample and R sample get smaller.</p>
<p>3 According to the result by “microbenchmark”,it’s obvious that the Rcpp function cost less time than R function.The speed of Rcpp function is more than 10 times of R function. In conclusion,the Rcpp function can improve the efficiency in this problem.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
