<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="20077 Peiran Liu" />


<title>Example</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Example</h1>
<h4 class="author">20077 Peiran Liu</h4>
<h4 class="date">2020/12/20</h4>



<div id="sort" class="section level1">
<h1>Sort</h1>
<p>There 9 types of sorting algorithm in this package(dim = 1)</p>
<p>For the function <em>Sort_XXXX(Y)</em> ,Y is the array(dim=1),and return value is the array has been sorted.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>Sort_bubble &lt;-<span class="st"> </span><span class="cf">function</span>(X){</span>
<span id="cb1-2"><a href="#cb1-2"></a>  Y &lt;-<span class="st"> </span>X</span>
<span id="cb1-3"><a href="#cb1-3"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(Y)</span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="cf">if</span>(n<span class="op">==</span><span class="dv">1</span>) <span class="kw">return</span>(Y)</span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>i){</span>
<span id="cb1-7"><a href="#cb1-7"></a>      <span class="cf">if</span>(Y[j<span class="op">+</span><span class="dv">1</span>]<span class="op">&lt;</span>Y[j]){</span>
<span id="cb1-8"><a href="#cb1-8"></a>        temp &lt;-<span class="st"> </span>Y[j<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb1-9"><a href="#cb1-9"></a>        Y[j<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>Y[j]</span>
<span id="cb1-10"><a href="#cb1-10"></a>        Y[j] &lt;-<span class="st"> </span>temp</span>
<span id="cb1-11"><a href="#cb1-11"></a>      }</span>
<span id="cb1-12"><a href="#cb1-12"></a>    }</span>
<span id="cb1-13"><a href="#cb1-13"></a>  }</span>
<span id="cb1-14"><a href="#cb1-14"></a>  <span class="kw">return</span>(Y)</span>
<span id="cb1-15"><a href="#cb1-15"></a>}</span>
<span id="cb1-16"><a href="#cb1-16"></a></span>
<span id="cb1-17"><a href="#cb1-17"></a>Sort_selection &lt;-<span class="st"> </span><span class="cf">function</span>(X){</span>
<span id="cb1-18"><a href="#cb1-18"></a>  Y &lt;-<span class="st"> </span>X</span>
<span id="cb1-19"><a href="#cb1-19"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(Y)</span>
<span id="cb1-20"><a href="#cb1-20"></a>  <span class="cf">if</span>(n<span class="op">==</span><span class="dv">1</span>) <span class="kw">return</span>(Y)</span>
<span id="cb1-21"><a href="#cb1-21"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb1-22"><a href="#cb1-22"></a>    Index &lt;-<span class="st"> </span>i</span>
<span id="cb1-23"><a href="#cb1-23"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){</span>
<span id="cb1-24"><a href="#cb1-24"></a>      <span class="cf">if</span> (Y[Index] <span class="op">&gt;</span><span class="st"> </span>Y[j]){</span>
<span id="cb1-25"><a href="#cb1-25"></a>        Index &lt;-<span class="st"> </span>j</span>
<span id="cb1-26"><a href="#cb1-26"></a>      }</span>
<span id="cb1-27"><a href="#cb1-27"></a>    }</span>
<span id="cb1-28"><a href="#cb1-28"></a>    temp &lt;-<span class="st"> </span>Y[i]</span>
<span id="cb1-29"><a href="#cb1-29"></a>    Y[i] &lt;-<span class="st"> </span>Y[Index]</span>
<span id="cb1-30"><a href="#cb1-30"></a>    Y[Index] &lt;-<span class="st"> </span>temp</span>
<span id="cb1-31"><a href="#cb1-31"></a>  }</span>
<span id="cb1-32"><a href="#cb1-32"></a>  <span class="kw">return</span>(Y)</span>
<span id="cb1-33"><a href="#cb1-33"></a>} </span>
<span id="cb1-34"><a href="#cb1-34"></a></span>
<span id="cb1-35"><a href="#cb1-35"></a>Sort_merge &lt;-<span class="st"> </span><span class="cf">function</span>(X){</span>
<span id="cb1-36"><a href="#cb1-36"></a>  Y &lt;-<span class="st"> </span>X</span>
<span id="cb1-37"><a href="#cb1-37"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(Y)</span>
<span id="cb1-38"><a href="#cb1-38"></a>  Z &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb1-39"><a href="#cb1-39"></a>  <span class="cf">if</span>(n <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){<span class="kw">return</span>(Y)}</span>
<span id="cb1-40"><a href="#cb1-40"></a>  <span class="cf">else</span> <span class="cf">if</span> (n <span class="op">==</span><span class="st"> </span><span class="dv">2</span>){</span>
<span id="cb1-41"><a href="#cb1-41"></a>    <span class="cf">if</span>(Y[<span class="dv">1</span>]<span class="op">&gt;</span>Y[<span class="dv">2</span>]){</span>
<span id="cb1-42"><a href="#cb1-42"></a>      temp &lt;-<span class="st"> </span>Y[<span class="dv">1</span>]</span>
<span id="cb1-43"><a href="#cb1-43"></a>      Y[<span class="dv">1</span>] &lt;-<span class="st"> </span>Y[<span class="dv">2</span>]</span>
<span id="cb1-44"><a href="#cb1-44"></a>      Y[<span class="dv">2</span>] &lt;-<span class="st"> </span>temp</span>
<span id="cb1-45"><a href="#cb1-45"></a>    }</span>
<span id="cb1-46"><a href="#cb1-46"></a>    <span class="kw">return</span>(Y)</span>
<span id="cb1-47"><a href="#cb1-47"></a>  }</span>
<span id="cb1-48"><a href="#cb1-48"></a>  <span class="cf">else</span>{</span>
<span id="cb1-49"><a href="#cb1-49"></a>    m &lt;-<span class="st"> </span>n<span class="op">%/%</span><span class="dv">2</span></span>
<span id="cb1-50"><a href="#cb1-50"></a>    Y1 &lt;-<span class="st"> </span><span class="kw">Sort_merge</span>(Y[<span class="dv">1</span><span class="op">:</span>m])</span>
<span id="cb1-51"><a href="#cb1-51"></a>    Y2 &lt;-<span class="st"> </span><span class="kw">Sort_merge</span>(Y[(m<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n])</span>
<span id="cb1-52"><a href="#cb1-52"></a>    i &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb1-53"><a href="#cb1-53"></a>    j &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb1-54"><a href="#cb1-54"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb1-55"><a href="#cb1-55"></a>      <span class="cf">if</span> (i <span class="op">+</span><span class="st"> </span>j <span class="op">==</span><span class="st"> </span>n<span class="op">+</span><span class="dv">1</span>){</span>
<span id="cb1-56"><a href="#cb1-56"></a>        <span class="cf">if</span>(Y1[m]<span class="op">&lt;</span>Y2[n<span class="op">-</span>m]) Z[n] &lt;-<span class="st"> </span>Y2[n<span class="op">-</span>m]</span>
<span id="cb1-57"><a href="#cb1-57"></a>        <span class="cf">else</span> Z[n] &lt;-<span class="st"> </span>Y1[m]</span>
<span id="cb1-58"><a href="#cb1-58"></a>      }</span>
<span id="cb1-59"><a href="#cb1-59"></a>      <span class="cf">else</span> <span class="cf">if</span>(i <span class="op">==</span><span class="st"> </span>m<span class="op">+</span><span class="dv">1</span>){</span>
<span id="cb1-60"><a href="#cb1-60"></a>        Z[k] &lt;-<span class="st"> </span>Y2[j]</span>
<span id="cb1-61"><a href="#cb1-61"></a>        j &lt;-<span class="st"> </span>j<span class="op">+</span><span class="dv">1</span></span>
<span id="cb1-62"><a href="#cb1-62"></a>      }</span>
<span id="cb1-63"><a href="#cb1-63"></a>      <span class="cf">else</span> <span class="cf">if</span>(j <span class="op">==</span><span class="st"> </span>n<span class="op">-</span>m<span class="op">+</span><span class="dv">1</span>){</span>
<span id="cb1-64"><a href="#cb1-64"></a>        Z[k] =<span class="st"> </span>Y1[i]</span>
<span id="cb1-65"><a href="#cb1-65"></a>        i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb1-66"><a href="#cb1-66"></a>      }</span>
<span id="cb1-67"><a href="#cb1-67"></a>      <span class="cf">else</span> <span class="cf">if</span> (Y1[i]<span class="op">&lt;</span>Y2[j]){</span>
<span id="cb1-68"><a href="#cb1-68"></a>        Z[k] &lt;-<span class="st"> </span>Y1[i]</span>
<span id="cb1-69"><a href="#cb1-69"></a>        i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb1-70"><a href="#cb1-70"></a>      }</span>
<span id="cb1-71"><a href="#cb1-71"></a>      <span class="cf">else</span>{</span>
<span id="cb1-72"><a href="#cb1-72"></a>        Z[k] &lt;-<span class="st"> </span>Y2[j]</span>
<span id="cb1-73"><a href="#cb1-73"></a>        j &lt;-<span class="st"> </span>j<span class="op">+</span><span class="dv">1</span></span>
<span id="cb1-74"><a href="#cb1-74"></a>      }</span>
<span id="cb1-75"><a href="#cb1-75"></a>    }</span>
<span id="cb1-76"><a href="#cb1-76"></a>    Y &lt;-<span class="st"> </span>Z</span>
<span id="cb1-77"><a href="#cb1-77"></a>  }</span>
<span id="cb1-78"><a href="#cb1-78"></a>  <span class="kw">return</span>(Y)</span>
<span id="cb1-79"><a href="#cb1-79"></a>}</span>
<span id="cb1-80"><a href="#cb1-80"></a></span>
<span id="cb1-81"><a href="#cb1-81"></a>Sort_quick &lt;-<span class="st"> </span><span class="cf">function</span>(X){</span>
<span id="cb1-82"><a href="#cb1-82"></a>  Y &lt;-<span class="st"> </span>X</span>
<span id="cb1-83"><a href="#cb1-83"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(Y)</span>
<span id="cb1-84"><a href="#cb1-84"></a>  <span class="cf">if</span>(n<span class="op">==</span><span class="dv">1</span>) <span class="kw">return</span>(Y)</span>
<span id="cb1-85"><a href="#cb1-85"></a>  Z &lt;-<span class="st"> </span>Yright &lt;-<span class="st"> </span>Yleft &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb1-86"><a href="#cb1-86"></a>  n2 &lt;-<span class="st"> </span>n1 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb1-87"><a href="#cb1-87"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n){</span>
<span id="cb1-88"><a href="#cb1-88"></a>    <span class="cf">if</span>(Y[i]<span class="op">&gt;</span>Y[<span class="dv">1</span>]){</span>
<span id="cb1-89"><a href="#cb1-89"></a>      n2 &lt;-<span class="st"> </span>n2 <span class="op">+</span><span class="dv">1</span></span>
<span id="cb1-90"><a href="#cb1-90"></a>      Yright[n2] &lt;-<span class="st"> </span>Y[i] </span>
<span id="cb1-91"><a href="#cb1-91"></a>    }</span>
<span id="cb1-92"><a href="#cb1-92"></a>    <span class="cf">else</span>{</span>
<span id="cb1-93"><a href="#cb1-93"></a>      n1 &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="dv">1</span></span>
<span id="cb1-94"><a href="#cb1-94"></a>      Yleft[n1] &lt;-<span class="st"> </span>Y[i] </span>
<span id="cb1-95"><a href="#cb1-95"></a>    }</span>
<span id="cb1-96"><a href="#cb1-96"></a>  }</span>
<span id="cb1-97"><a href="#cb1-97"></a>  <span class="cf">if</span>(n1<span class="op">==</span><span class="dv">0</span>){</span>
<span id="cb1-98"><a href="#cb1-98"></a>    Zright &lt;-<span class="st"> </span>Yright[<span class="dv">1</span><span class="op">:</span>n2]</span>
<span id="cb1-99"><a href="#cb1-99"></a>    Zright &lt;-<span class="st"> </span><span class="kw">Sort_quick</span>(Zright)</span>
<span id="cb1-100"><a href="#cb1-100"></a>    Z &lt;-<span class="st"> </span><span class="kw">c</span>(Y[<span class="dv">1</span>],Zright)</span>
<span id="cb1-101"><a href="#cb1-101"></a>  }</span>
<span id="cb1-102"><a href="#cb1-102"></a>  <span class="cf">else</span> <span class="cf">if</span>(n2<span class="op">==</span><span class="dv">0</span>){</span>
<span id="cb1-103"><a href="#cb1-103"></a>    Zleft &lt;-<span class="st"> </span>Yleft[<span class="dv">1</span><span class="op">:</span>n1]</span>
<span id="cb1-104"><a href="#cb1-104"></a>    Zleft &lt;-<span class="st"> </span><span class="kw">Sort_quick</span>(Zleft)</span>
<span id="cb1-105"><a href="#cb1-105"></a>    Z &lt;-<span class="st"> </span><span class="kw">c</span>(Zleft,Y[<span class="dv">1</span>])</span>
<span id="cb1-106"><a href="#cb1-106"></a>  }</span>
<span id="cb1-107"><a href="#cb1-107"></a>  <span class="cf">else</span>{</span>
<span id="cb1-108"><a href="#cb1-108"></a>    Zright &lt;-<span class="st"> </span>Yright[<span class="dv">1</span><span class="op">:</span>n2]</span>
<span id="cb1-109"><a href="#cb1-109"></a>    Zleft &lt;-<span class="st"> </span>Yleft[<span class="dv">1</span><span class="op">:</span>n1]</span>
<span id="cb1-110"><a href="#cb1-110"></a>    Zleft &lt;-<span class="st"> </span><span class="kw">Sort_quick</span>(Zleft)</span>
<span id="cb1-111"><a href="#cb1-111"></a>    Zright &lt;-<span class="st"> </span><span class="kw">Sort_quick</span>(Zright)</span>
<span id="cb1-112"><a href="#cb1-112"></a>    Z &lt;-<span class="st"> </span><span class="kw">c</span>(Zleft,Y[<span class="dv">1</span>],Zright)</span>
<span id="cb1-113"><a href="#cb1-113"></a>  }</span>
<span id="cb1-114"><a href="#cb1-114"></a>  Y &lt;-<span class="st"> </span>Z</span>
<span id="cb1-115"><a href="#cb1-115"></a>  <span class="kw">return</span>(Y)</span>
<span id="cb1-116"><a href="#cb1-116"></a>} </span>
<span id="cb1-117"><a href="#cb1-117"></a></span>
<span id="cb1-118"><a href="#cb1-118"></a>Sort_counting_Integer &lt;-<span class="st"> </span><span class="cf">function</span>(X){<span class="co">## Only useful for integer</span></span>
<span id="cb1-119"><a href="#cb1-119"></a>  Y &lt;-<span class="st"> </span>X</span>
<span id="cb1-120"><a href="#cb1-120"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(Y)</span>
<span id="cb1-121"><a href="#cb1-121"></a>  <span class="cf">if</span>(n<span class="op">==</span><span class="dv">1</span>) <span class="kw">return</span>(Y)</span>
<span id="cb1-122"><a href="#cb1-122"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb1-123"><a href="#cb1-123"></a>    Y[i] &lt;-<span class="st"> </span>Y[i]<span class="op">%/%</span><span class="dv">1</span></span>
<span id="cb1-124"><a href="#cb1-124"></a>  }</span>
<span id="cb1-125"><a href="#cb1-125"></a>  M &lt;-<span class="st"> </span>m &lt;-<span class="st"> </span>Y[<span class="dv">1</span>]</span>
<span id="cb1-126"><a href="#cb1-126"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n){</span>
<span id="cb1-127"><a href="#cb1-127"></a>    <span class="cf">if</span>(m<span class="op">&gt;</span>Y[i]) m &lt;-<span class="st"> </span>Y[i]</span>
<span id="cb1-128"><a href="#cb1-128"></a>    <span class="cf">if</span>(M<span class="op">&lt;</span>Y[i]) M &lt;-<span class="st"> </span>Y[i]</span>
<span id="cb1-129"><a href="#cb1-129"></a>  }</span>
<span id="cb1-130"><a href="#cb1-130"></a>  l &lt;-<span class="st"> </span>M<span class="op">-</span>m<span class="op">+</span><span class="dv">1</span></span>
<span id="cb1-131"><a href="#cb1-131"></a>  C &lt;-<span class="st"> </span><span class="kw">numeric</span>(l)</span>
<span id="cb1-132"><a href="#cb1-132"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb1-133"><a href="#cb1-133"></a>    C[Y[i]<span class="op">-</span>m<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>C[Y[i]<span class="op">-</span>m<span class="op">+</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span></span>
<span id="cb1-134"><a href="#cb1-134"></a>  }</span>
<span id="cb1-135"><a href="#cb1-135"></a>  Z &lt;-<span class="st"> </span><span class="kw">rep</span>(m,C[<span class="dv">1</span>])</span>
<span id="cb1-136"><a href="#cb1-136"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(M<span class="op">-</span>m)){</span>
<span id="cb1-137"><a href="#cb1-137"></a>    <span class="cf">if</span> (C[j<span class="op">+</span><span class="dv">1</span>]<span class="op">!=</span><span class="dv">0</span>){</span>
<span id="cb1-138"><a href="#cb1-138"></a>      Z &lt;-<span class="st"> </span><span class="kw">c</span>(Z,<span class="kw">rep</span>(m<span class="op">+</span>j,C[j<span class="op">+</span><span class="dv">1</span>]))</span>
<span id="cb1-139"><a href="#cb1-139"></a>    }</span>
<span id="cb1-140"><a href="#cb1-140"></a>  }</span>
<span id="cb1-141"><a href="#cb1-141"></a>  Y &lt;-<span class="st"> </span>Z</span>
<span id="cb1-142"><a href="#cb1-142"></a>  <span class="kw">return</span>(Y)</span>
<span id="cb1-143"><a href="#cb1-143"></a>}</span>
<span id="cb1-144"><a href="#cb1-144"></a></span>
<span id="cb1-145"><a href="#cb1-145"></a>n_digit &lt;-<span class="st"> </span><span class="cf">function</span>(a,n){</span>
<span id="cb1-146"><a href="#cb1-146"></a>  <span class="cf">if</span>(n<span class="op">==</span><span class="dv">1</span>){</span>
<span id="cb1-147"><a href="#cb1-147"></a>    <span class="kw">return</span>(a<span class="op">%%</span><span class="dv">10</span>)</span>
<span id="cb1-148"><a href="#cb1-148"></a>  }</span>
<span id="cb1-149"><a href="#cb1-149"></a>  <span class="cf">else</span>{</span>
<span id="cb1-150"><a href="#cb1-150"></a>    a1 &lt;-<span class="st"> </span>a<span class="op">%%</span>(<span class="dv">10</span><span class="op">^</span>n)</span>
<span id="cb1-151"><a href="#cb1-151"></a>    re &lt;-<span class="st"> </span>a1<span class="op">%/%</span>(<span class="dv">10</span><span class="op">^</span>(n<span class="dv">-1</span>))</span>
<span id="cb1-152"><a href="#cb1-152"></a>    <span class="kw">return</span>(re)</span>
<span id="cb1-153"><a href="#cb1-153"></a>  }</span>
<span id="cb1-154"><a href="#cb1-154"></a>}</span>
<span id="cb1-155"><a href="#cb1-155"></a></span>
<span id="cb1-156"><a href="#cb1-156"></a></span>
<span id="cb1-157"><a href="#cb1-157"></a>Sort_radix_PostiveInteger &lt;-<span class="cf">function</span>(X){<span class="co">## Only useful for postive integer</span></span>
<span id="cb1-158"><a href="#cb1-158"></a>  Y &lt;-<span class="st"> </span>X</span>
<span id="cb1-159"><a href="#cb1-159"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(Y)</span>
<span id="cb1-160"><a href="#cb1-160"></a>  <span class="cf">if</span> (n <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">return</span>(Y)</span>
<span id="cb1-161"><a href="#cb1-161"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb1-162"><a href="#cb1-162"></a>    Y[i] &lt;-<span class="st"> </span><span class="kw">abs</span>(Y[i])</span>
<span id="cb1-163"><a href="#cb1-163"></a>  }</span>
<span id="cb1-164"><a href="#cb1-164"></a>  M &lt;-<span class="st"> </span>Y[<span class="dv">1</span>]</span>
<span id="cb1-165"><a href="#cb1-165"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n){</span>
<span id="cb1-166"><a href="#cb1-166"></a>     <span class="cf">if</span>(Y[i]<span class="op">&gt;</span>M) M &lt;-<span class="st"> </span>Y[i]</span>
<span id="cb1-167"><a href="#cb1-167"></a>  }</span>
<span id="cb1-168"><a href="#cb1-168"></a>  <span class="cf">if</span>(M<span class="op">==</span><span class="dv">0</span>){<span class="kw">return</span>(Y)}</span>
<span id="cb1-169"><a href="#cb1-169"></a>  k &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb1-170"><a href="#cb1-170"></a>  a &lt;-<span class="st"> </span>M<span class="op">%/%</span>(<span class="dv">10</span><span class="op">^</span>(k<span class="dv">-1</span>))</span>
<span id="cb1-171"><a href="#cb1-171"></a>  <span class="cf">while</span>(a<span class="op">!=</span><span class="dv">0</span>){</span>
<span id="cb1-172"><a href="#cb1-172"></a>    k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb1-173"><a href="#cb1-173"></a>    a &lt;-<span class="st"> </span>M<span class="op">%/%</span>(<span class="dv">10</span><span class="op">^</span>(k<span class="dv">-1</span>))</span>
<span id="cb1-174"><a href="#cb1-174"></a>  }</span>
<span id="cb1-175"><a href="#cb1-175"></a>  k &lt;-<span class="st"> </span>k<span class="dv">-1</span></span>
<span id="cb1-176"><a href="#cb1-176"></a>  U &lt;-<span class="st"> </span>Y</span>
<span id="cb1-177"><a href="#cb1-177"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb1-178"><a href="#cb1-178"></a>    C &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb1-179"><a href="#cb1-179"></a>    r &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">0</span>,<span class="dt">nrow=</span><span class="dv">10</span>,<span class="dt">ncol=</span>n)</span>
<span id="cb1-180"><a href="#cb1-180"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb1-181"><a href="#cb1-181"></a>      t &lt;-<span class="st"> </span><span class="kw">n_digit</span>(U[j],i) </span>
<span id="cb1-182"><a href="#cb1-182"></a>      C[t<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>C[t<span class="op">+</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span></span>
<span id="cb1-183"><a href="#cb1-183"></a>      r[t<span class="op">+</span><span class="dv">1</span>,C[t<span class="op">+</span><span class="dv">1</span>]] &lt;-<span class="st"> </span>U[j]</span>
<span id="cb1-184"><a href="#cb1-184"></a>    }</span>
<span id="cb1-185"><a href="#cb1-185"></a>    t &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb1-186"><a href="#cb1-186"></a>    <span class="cf">while</span>(C[t]<span class="op">==</span><span class="dv">0</span>){</span>
<span id="cb1-187"><a href="#cb1-187"></a>      t &lt;-<span class="st"> </span>t<span class="op">+</span><span class="dv">1</span></span>
<span id="cb1-188"><a href="#cb1-188"></a>    }</span>
<span id="cb1-189"><a href="#cb1-189"></a>    r1 &lt;-<span class="st"> </span>r[t,]</span>
<span id="cb1-190"><a href="#cb1-190"></a>    r1 &lt;-<span class="st"> </span>r1[<span class="dv">1</span><span class="op">:</span>C[t]]</span>
<span id="cb1-191"><a href="#cb1-191"></a>    Z &lt;-<span class="st"> </span>r1</span>
<span id="cb1-192"><a href="#cb1-192"></a>    t &lt;-<span class="st"> </span>t<span class="op">+</span><span class="dv">1</span></span>
<span id="cb1-193"><a href="#cb1-193"></a>    <span class="cf">while</span>(t<span class="op">&lt;</span><span class="dv">11</span>){</span>
<span id="cb1-194"><a href="#cb1-194"></a>      <span class="cf">if</span>(C[t]<span class="op">!=</span><span class="dv">0</span>){</span>
<span id="cb1-195"><a href="#cb1-195"></a>        r2 &lt;-<span class="st"> </span>r[t,]</span>
<span id="cb1-196"><a href="#cb1-196"></a>        r2 &lt;-<span class="st"> </span>r2[<span class="dv">1</span><span class="op">:</span>C[t]]</span>
<span id="cb1-197"><a href="#cb1-197"></a>        Z &lt;-<span class="st"> </span><span class="kw">c</span>(Z,r2)</span>
<span id="cb1-198"><a href="#cb1-198"></a>      }</span>
<span id="cb1-199"><a href="#cb1-199"></a>      t &lt;-<span class="st"> </span>t<span class="op">+</span><span class="dv">1</span></span>
<span id="cb1-200"><a href="#cb1-200"></a>    }</span>
<span id="cb1-201"><a href="#cb1-201"></a>    U &lt;-<span class="st"> </span>Z</span>
<span id="cb1-202"><a href="#cb1-202"></a>  }</span>
<span id="cb1-203"><a href="#cb1-203"></a>  Y &lt;-<span class="st"> </span>U</span>
<span id="cb1-204"><a href="#cb1-204"></a>  <span class="kw">return</span>(Y)</span>
<span id="cb1-205"><a href="#cb1-205"></a>}</span>
<span id="cb1-206"><a href="#cb1-206"></a></span>
<span id="cb1-207"><a href="#cb1-207"></a>Sort_Insert &lt;-<span class="st"> </span><span class="cf">function</span>(X){</span>
<span id="cb1-208"><a href="#cb1-208"></a>  Y &lt;-<span class="st"> </span>X</span>
<span id="cb1-209"><a href="#cb1-209"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(Y)</span>
<span id="cb1-210"><a href="#cb1-210"></a>  <span class="cf">if</span>(n<span class="op">==</span><span class="dv">1</span>) <span class="kw">return</span>(Y)</span>
<span id="cb1-211"><a href="#cb1-211"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n){</span>
<span id="cb1-212"><a href="#cb1-212"></a>    temp &lt;-<span class="st"> </span>Y[i]</span>
<span id="cb1-213"><a href="#cb1-213"></a>    j &lt;-<span class="st"> </span>i<span class="dv">-1</span></span>
<span id="cb1-214"><a href="#cb1-214"></a>    <span class="cf">while</span>(j <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span><span class="op">&amp;&amp;</span>Y[j]<span class="op">&gt;</span>temp){</span>
<span id="cb1-215"><a href="#cb1-215"></a>      j &lt;-<span class="st"> </span>j<span class="dv">-1</span></span>
<span id="cb1-216"><a href="#cb1-216"></a>      Y[j<span class="op">+</span><span class="dv">2</span>] &lt;-<span class="st"> </span>Y[j<span class="op">+</span><span class="dv">1</span>] </span>
<span id="cb1-217"><a href="#cb1-217"></a>    }</span>
<span id="cb1-218"><a href="#cb1-218"></a>    Y[j<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>temp  </span>
<span id="cb1-219"><a href="#cb1-219"></a>  }</span>
<span id="cb1-220"><a href="#cb1-220"></a>  <span class="kw">return</span>(Y)</span>
<span id="cb1-221"><a href="#cb1-221"></a>}</span>
<span id="cb1-222"><a href="#cb1-222"></a></span>
<span id="cb1-223"><a href="#cb1-223"></a>Sort_Shell &lt;-<span class="st"> </span><span class="cf">function</span>(X){<span class="co">##Using Sort_Insert</span></span>
<span id="cb1-224"><a href="#cb1-224"></a>  Y &lt;-<span class="st"> </span>X</span>
<span id="cb1-225"><a href="#cb1-225"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(Y)</span>
<span id="cb1-226"><a href="#cb1-226"></a>  <span class="cf">if</span>(n<span class="op">==</span><span class="dv">1</span>) <span class="kw">return</span>(Y)</span>
<span id="cb1-227"><a href="#cb1-227"></a>  d &lt;-<span class="st"> </span>n<span class="op">%/%</span><span class="dv">2</span></span>
<span id="cb1-228"><a href="#cb1-228"></a>  <span class="cf">while</span>(d<span class="op">!=</span><span class="dv">0</span>){</span>
<span id="cb1-229"><a href="#cb1-229"></a>    m &lt;-<span class="st"> </span>n<span class="op">%/%</span>d</span>
<span id="cb1-230"><a href="#cb1-230"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){</span>
<span id="cb1-231"><a href="#cb1-231"></a>      arrayd &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb1-232"><a href="#cb1-232"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb1-233"><a href="#cb1-233"></a>        arrayd[j] &lt;-<span class="st"> </span>Y[(j<span class="dv">-1</span>)<span class="op">*</span>d<span class="op">+</span>i]</span>
<span id="cb1-234"><a href="#cb1-234"></a>      }</span>
<span id="cb1-235"><a href="#cb1-235"></a>      arrayd &lt;-<span class="st"> </span><span class="kw">Sort_Insert</span>(arrayd)</span>
<span id="cb1-236"><a href="#cb1-236"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb1-237"><a href="#cb1-237"></a>        Y[(j<span class="dv">-1</span>)<span class="op">*</span>d<span class="op">+</span>i] &lt;-<span class="st"> </span>arrayd[j]</span>
<span id="cb1-238"><a href="#cb1-238"></a>      }</span>
<span id="cb1-239"><a href="#cb1-239"></a>    }</span>
<span id="cb1-240"><a href="#cb1-240"></a>    d &lt;-<span class="st"> </span>d<span class="op">%/%</span><span class="dv">2</span></span>
<span id="cb1-241"><a href="#cb1-241"></a>  }</span>
<span id="cb1-242"><a href="#cb1-242"></a>  <span class="kw">return</span>(Y)</span>
<span id="cb1-243"><a href="#cb1-243"></a>}</span>
<span id="cb1-244"><a href="#cb1-244"></a></span>
<span id="cb1-245"><a href="#cb1-245"></a>Sort_Heap &lt;-<span class="cf">function</span>(X){</span>
<span id="cb1-246"><a href="#cb1-246"></a>  Y &lt;-<span class="st"> </span>X</span>
<span id="cb1-247"><a href="#cb1-247"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(Y)</span>
<span id="cb1-248"><a href="#cb1-248"></a>  <span class="cf">if</span>(n<span class="op">==</span><span class="dv">1</span>) <span class="kw">return</span>(Y)</span>
<span id="cb1-249"><a href="#cb1-249"></a>  <span class="cf">else</span> <span class="cf">if</span>(n<span class="op">==</span><span class="dv">2</span>){</span>
<span id="cb1-250"><a href="#cb1-250"></a>    <span class="cf">if</span>(Y[<span class="dv">1</span>]<span class="op">&gt;</span>Y[<span class="dv">2</span>]){</span>
<span id="cb1-251"><a href="#cb1-251"></a>      temp &lt;-<span class="st"> </span>Y[<span class="dv">1</span>]</span>
<span id="cb1-252"><a href="#cb1-252"></a>      Y[<span class="dv">1</span>] &lt;-<span class="st"> </span>Y[<span class="dv">2</span>]</span>
<span id="cb1-253"><a href="#cb1-253"></a>      Y[<span class="dv">2</span>] &lt;-<span class="st"> </span>temp</span>
<span id="cb1-254"><a href="#cb1-254"></a>    }</span>
<span id="cb1-255"><a href="#cb1-255"></a>    <span class="kw">return</span>(Y)</span>
<span id="cb1-256"><a href="#cb1-256"></a>  }</span>
<span id="cb1-257"><a href="#cb1-257"></a>  <span class="cf">else</span>{</span>
<span id="cb1-258"><a href="#cb1-258"></a>    m &lt;-<span class="st"> </span>n<span class="op">%/%</span><span class="dv">2</span></span>
<span id="cb1-259"><a href="#cb1-259"></a>    <span class="cf">for</span>(i0 <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb1-260"><a href="#cb1-260"></a>      i &lt;-<span class="st"> </span>m <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>i0</span>
<span id="cb1-261"><a href="#cb1-261"></a>      <span class="cf">if</span> (Y[i]<span class="op">&lt;</span>Y[<span class="dv">2</span><span class="op">*</span>i]){</span>
<span id="cb1-262"><a href="#cb1-262"></a>        temp &lt;-<span class="st"> </span>Y[<span class="dv">2</span><span class="op">*</span>i]</span>
<span id="cb1-263"><a href="#cb1-263"></a>        Y[<span class="dv">2</span><span class="op">*</span>i] &lt;-<span class="st"> </span>Y[i]</span>
<span id="cb1-264"><a href="#cb1-264"></a>        Y[i] &lt;-<span class="st"> </span>temp</span>
<span id="cb1-265"><a href="#cb1-265"></a>      }</span>
<span id="cb1-266"><a href="#cb1-266"></a>      <span class="cf">if</span>(<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span><span class="op">&lt;</span>n<span class="op">+</span><span class="dv">1</span>){</span>
<span id="cb1-267"><a href="#cb1-267"></a>        <span class="cf">if</span> (Y[i]<span class="op">&lt;</span>Y[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>]){</span>
<span id="cb1-268"><a href="#cb1-268"></a>          temp &lt;-<span class="st"> </span>Y[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb1-269"><a href="#cb1-269"></a>          Y[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>Y[i]</span>
<span id="cb1-270"><a href="#cb1-270"></a>          Y[i] &lt;-<span class="st"> </span>temp</span>
<span id="cb1-271"><a href="#cb1-271"></a>        }</span>
<span id="cb1-272"><a href="#cb1-272"></a>      }  </span>
<span id="cb1-273"><a href="#cb1-273"></a>    }</span>
<span id="cb1-274"><a href="#cb1-274"></a>    Yn &lt;-<span class="st"> </span>Y[<span class="dv">1</span>]</span>
<span id="cb1-275"><a href="#cb1-275"></a>    Y[<span class="dv">1</span>] &lt;-<span class="st"> </span>Y[n]</span>
<span id="cb1-276"><a href="#cb1-276"></a>    Z &lt;-<span class="st"> </span>Y[<span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)]</span>
<span id="cb1-277"><a href="#cb1-277"></a>    Z &lt;-<span class="st"> </span><span class="kw">Sort_Heap</span>(Z)</span>
<span id="cb1-278"><a href="#cb1-278"></a>    Y &lt;-<span class="st"> </span><span class="kw">c</span>(Z,Yn)</span>
<span id="cb1-279"><a href="#cb1-279"></a>    <span class="kw">return</span>(Y)</span>
<span id="cb1-280"><a href="#cb1-280"></a>  }</span>
<span id="cb1-281"><a href="#cb1-281"></a>}</span>
<span id="cb1-282"><a href="#cb1-282"></a></span>
<span id="cb1-283"><a href="#cb1-283"></a>x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">15</span>,<span class="dt">replace =</span> T)</span>
<span id="cb1-284"><a href="#cb1-284"></a>x</span></code></pre></div>
<pre><code>##  [1] 11 16 20 17 10 14 17  6 10  3  8 18  4 16  6</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">Sort_bubble</span>(x)</span></code></pre></div>
<pre><code>##  [1]  6 10 10  3 11  8 14 16 17  4 17 16 18  6 20</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">15</span>,<span class="dt">replace =</span> T)</span>
<span id="cb5-2"><a href="#cb5-2"></a>x</span></code></pre></div>
<pre><code>##  [1]  1 16 16  1  9 17 11 14  6  9  8 10 20  5  1</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">Sort_selection</span>(x)</span></code></pre></div>
<pre><code>##  [1]  1  1  1  5  6  8  9  9 10 11 14 16 16 17 20</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">15</span>,<span class="dt">replace =</span> T)</span>
<span id="cb9-2"><a href="#cb9-2"></a>x</span></code></pre></div>
<pre><code>##  [1] 11  3 16 11 15  2  6  1  4 17  5  6  7 16  7</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">Sort_merge</span>(x)</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  6  7  7 11 11 15 16 16 17</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">15</span>,<span class="dt">replace =</span> T)</span>
<span id="cb13-2"><a href="#cb13-2"></a>x</span></code></pre></div>
<pre><code>##  [1]  8  1 16  5 15  5 10 20  8 15 10 12 11 18 16</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">Sort_quick</span>(x)</span></code></pre></div>
<pre><code>##  [1]  1  5  5  8  8 10 10 11 12 15 15 16 16 18 20</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">15</span>,<span class="dt">replace =</span> T)</span>
<span id="cb17-2"><a href="#cb17-2"></a>x</span></code></pre></div>
<pre><code>##  [1] 18 15 11 12 16 19 15 17 19  5 20  7 19 16  7</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">Sort_quick</span>(x)</span></code></pre></div>
<pre><code>##  [1]  5  7  7 11 12 15 15 16 16 17 18 19 19 19 20</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">15</span>,<span class="dt">replace =</span> T)</span>
<span id="cb21-2"><a href="#cb21-2"></a>x</span></code></pre></div>
<pre><code>##  [1] 13  1 15 18 15  6  9 16  4 20  6  7 18  8 12</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">Sort_Insert</span>(x)</span></code></pre></div>
<pre><code>##  [1]  1  4  6  6  7  8  9 12 13 15 15 16 18 18 20</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">15</span>,<span class="dt">replace =</span> T)</span>
<span id="cb25-2"><a href="#cb25-2"></a>x</span></code></pre></div>
<pre><code>##  [1] 14  2  5  2  8  2  8  2 14  9 11  7  7 20 13</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">Sort_Shell</span>(x)</span></code></pre></div>
<pre><code>##  [1]  2  2  2  2  5  7  7  8  8  9 11 13 14 14 20</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">15</span>,<span class="dt">replace =</span> T)</span>
<span id="cb29-2"><a href="#cb29-2"></a>x</span></code></pre></div>
<pre><code>##  [1]  3 13 18  2 10  5 14  9  1  4  9 14 16 15 11</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">Sort_Heap</span>(x)</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  9  9 10 11 13 14 14 15 16 18</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">15</span>,<span class="dt">replace =</span> T)</span>
<span id="cb33-2"><a href="#cb33-2"></a>x</span></code></pre></div>
<pre><code>##  [1]  3  3 13  4 13 17 10  4 11 10 10  8 10  7 18</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">Sort_radix_PostiveInteger</span>(x)<span class="co">##Only can use in PostiveInteger array</span></span></code></pre></div>
<pre><code>##  [1]  3  3  4  4  7  8 10 10 10 10 11 13 13 17 18</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">15</span>,<span class="dt">replace =</span> T)</span>
<span id="cb37-2"><a href="#cb37-2"></a>x</span></code></pre></div>
<pre><code>##  [1] 16 20 11  9 12  1 13  5 13 10 15  6 19 11  1</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">Sort_counting_Integer</span>(x)<span class="co">##Only can use in Integer array</span></span></code></pre></div>
<pre><code>##  [1]  1  1  5  6  9 10 11 11 12 13 13 15 16 19 20</code></pre>
</div>
<div id="adaptive-estimate-functiondim1" class="section level1">
<h1>adaptive estimate function(dim=1)</h1>
<p>When we compute the estimate function by kernel function,if we change the bandwidth by adaptive method,the accuracy of the function will be better than naive method.</p>
<p>For the function <em>fhat_adaptive(X,y,h)</em>,and <em>fhat_simple(X,y,h)</em>,X is the sample,y is the argument of estimate function,h is the bandwidth. The return value is the estimate function.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>fhat_simple &lt;-<span class="st"> </span><span class="cf">function</span>(Sample,x,h){</span>
<span id="cb41-2"><a href="#cb41-2"></a>  N &lt;-<span class="st"> </span><span class="kw">length</span>(Sample)</span>
<span id="cb41-3"><a href="#cb41-3"></a>  K &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb41-4"><a href="#cb41-4"></a>  L &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb41-5"><a href="#cb41-5"></a>  fhat &lt;-<span class="st"> </span><span class="kw">numeric</span>(L)</span>
<span id="cb41-6"><a href="#cb41-6"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>L){</span>
<span id="cb41-7"><a href="#cb41-7"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb41-8"><a href="#cb41-8"></a>      <span class="cf">if</span>(Sample[i]<span class="op">&gt;</span>x[j]<span class="op">+</span>h){</span>
<span id="cb41-9"><a href="#cb41-9"></a>        K[i] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb41-10"><a href="#cb41-10"></a>      }</span>
<span id="cb41-11"><a href="#cb41-11"></a>      <span class="cf">else</span> <span class="cf">if</span>(Sample[i]<span class="op">&lt;</span>x[j]<span class="op">-</span>h){</span>
<span id="cb41-12"><a href="#cb41-12"></a>        K[i] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb41-13"><a href="#cb41-13"></a>      }</span>
<span id="cb41-14"><a href="#cb41-14"></a>      <span class="cf">else</span>{</span>
<span id="cb41-15"><a href="#cb41-15"></a>        K[i] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span></span>
<span id="cb41-16"><a href="#cb41-16"></a>      }</span>
<span id="cb41-17"><a href="#cb41-17"></a>    }</span>
<span id="cb41-18"><a href="#cb41-18"></a>    fhat[j] &lt;-<span class="st"> </span><span class="kw">sum</span>(K)<span class="op">/</span>(N<span class="op">*</span>h)</span>
<span id="cb41-19"><a href="#cb41-19"></a>  }</span>
<span id="cb41-20"><a href="#cb41-20"></a>  <span class="kw">return</span>(fhat)</span>
<span id="cb41-21"><a href="#cb41-21"></a>}</span>
<span id="cb41-22"><a href="#cb41-22"></a></span>
<span id="cb41-23"><a href="#cb41-23"></a>fhat_adaptive &lt;-<span class="st"> </span><span class="cf">function</span>(Sample,x,h){</span>
<span id="cb41-24"><a href="#cb41-24"></a>  N &lt;-<span class="st"> </span><span class="kw">length</span>(Sample)</span>
<span id="cb41-25"><a href="#cb41-25"></a>  s &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb41-26"><a href="#cb41-26"></a>  c &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb41-27"><a href="#cb41-27"></a>  L &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb41-28"><a href="#cb41-28"></a>  f_hat &lt;-<span class="st"> </span><span class="kw">numeric</span>(L)</span>
<span id="cb41-29"><a href="#cb41-29"></a>  f_simple &lt;-<span class="st"> </span><span class="kw">fhat_simple</span>(Sample,Sample,h)</span>
<span id="cb41-30"><a href="#cb41-30"></a>  T_s &lt;-<span class="st"> </span>(<span class="kw">prod</span>(f_simple))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>N)</span>
<span id="cb41-31"><a href="#cb41-31"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){s[i] &lt;-<span class="st"> </span>(f_simple[i]<span class="op">/</span>T_s)<span class="op">^</span>(<span class="op">-</span>c)}</span>
<span id="cb41-32"><a href="#cb41-32"></a>  K_hat &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb41-33"><a href="#cb41-33"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>L){</span>
<span id="cb41-34"><a href="#cb41-34"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb41-35"><a href="#cb41-35"></a>      <span class="cf">if</span>(Sample[i]<span class="op">&gt;</span>x[j]<span class="op">+</span>h<span class="op">*</span>s[i]){</span>
<span id="cb41-36"><a href="#cb41-36"></a>        K_hat[i] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb41-37"><a href="#cb41-37"></a>      }</span>
<span id="cb41-38"><a href="#cb41-38"></a>      <span class="cf">else</span> <span class="cf">if</span>(Sample[i]<span class="op">&lt;</span>x[j]<span class="op">-</span>h<span class="op">*</span>s[i]){</span>
<span id="cb41-39"><a href="#cb41-39"></a>        K_hat[i] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb41-40"><a href="#cb41-40"></a>      }</span>
<span id="cb41-41"><a href="#cb41-41"></a>      <span class="cf">else</span>{</span>
<span id="cb41-42"><a href="#cb41-42"></a>        K_hat[i] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>N<span class="op">*</span>h<span class="op">*</span>s[i])</span>
<span id="cb41-43"><a href="#cb41-43"></a>      }</span>
<span id="cb41-44"><a href="#cb41-44"></a>    }</span>
<span id="cb41-45"><a href="#cb41-45"></a>    f_hat[j] &lt;-<span class="st"> </span><span class="kw">sum</span>(K_hat)</span>
<span id="cb41-46"><a href="#cb41-46"></a>  }</span>
<span id="cb41-47"><a href="#cb41-47"></a>  <span class="kw">return</span>(f_hat)</span>
<span id="cb41-48"><a href="#cb41-48"></a>}</span>
<span id="cb41-49"><a href="#cb41-49"></a></span>
<span id="cb41-50"><a href="#cb41-50"></a></span>
<span id="cb41-51"><a href="#cb41-51"></a><span class="kw">set.seed</span>(<span class="dv">2020</span>)</span>
<span id="cb41-52"><a href="#cb41-52"></a>h &lt;-<span class="st"> </span><span class="fl">0.3</span></span>
<span id="cb41-53"><a href="#cb41-53"></a>n &lt;-<span class="st"> </span><span class="dv">200</span></span>
<span id="cb41-54"><a href="#cb41-54"></a>rsample &lt;-<span class="st"> </span><span class="cf">function</span>(N){</span>
<span id="cb41-55"><a href="#cb41-55"></a>  lnY &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</span>
<span id="cb41-56"><a href="#cb41-56"></a>  Y &lt;-<span class="st"> </span><span class="kw">exp</span>(lnY)</span>
<span id="cb41-57"><a href="#cb41-57"></a>  <span class="kw">return</span>(Y)</span>
<span id="cb41-58"><a href="#cb41-58"></a>}</span>
<span id="cb41-59"><a href="#cb41-59"></a>true_density &lt;-<span class="st"> </span><span class="cf">function</span>(t){</span>
<span id="cb41-60"><a href="#cb41-60"></a>    return_value &lt;-<span class="st"> </span><span class="kw">dnorm</span>(<span class="kw">log</span>(t),<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">/</span>t</span>
<span id="cb41-61"><a href="#cb41-61"></a>  <span class="kw">return</span>(return_value)</span>
<span id="cb41-62"><a href="#cb41-62"></a>}</span>
<span id="cb41-63"><a href="#cb41-63"></a>X &lt;-<span class="st"> </span><span class="kw">rsample</span>(n)</span>
<span id="cb41-64"><a href="#cb41-64"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.002</span>,<span class="dv">16</span>,<span class="fl">0.002</span>)</span>
<span id="cb41-65"><a href="#cb41-65"></a><span class="kw">plot</span>(y, <span class="kw">true_density</span>(y), <span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;h = adaptive&quot;</span>)</span>
<span id="cb41-66"><a href="#cb41-66"></a><span class="kw">lines</span>(y,<span class="kw">fhat_adaptive</span>(X,y,h),<span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw">plot</span>(y, <span class="kw">true_density</span>(y), <span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;h = naive&quot;</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="kw">lines</span>(y,<span class="kw">fhat_simple</span>(X,y,h),<span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="equality-of-density-testdim1" class="section level1">
<h1>Equality of density-Test(dim=1)</h1>
<p>There is a function to test whether two samples(dim=1) have same density or not.Here we use a kernel function to compute a Test-statistic<span class="math inline">\(T\)</span>,compare with the standard normal distribution <span class="math inline">\(Z_\alpha\)</span>.If <span class="math inline">\(T&gt;Z_\alpha\)</span>,we think they don’t have the same density,else we think they have the same density(When Confidence coefficient=<span class="math inline">\(\alpha\)</span>).</p>
<p>For the function <em>density_test(X,Y,alpha)</em>,X is the first sample,Y is the second sample,alpha is 1-Confidence_coefficient.For the return_value,TURE stand for “density are same”,FALSE stand for “density are not same”</p>
<p>Because it’s difficult to dicide the bandwidth of kernel function,so the result may be not accurate.So users can choose the bandwidth by himself like this:</p>
<p>For the function <em>bw_density_test(X,Y,alpha,h)</em>,h is the bandwidth.(choose by users)</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>K &lt;-<span class="st"> </span><span class="cf">function</span>(u,h){<span class="co">###Gaussian kernel function</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>  K_value &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(u<span class="op">/</span>h)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(h<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))</span>
<span id="cb43-3"><a href="#cb43-3"></a>  <span class="kw">return</span>(K_value)</span>
<span id="cb43-4"><a href="#cb43-4"></a>}</span>
<span id="cb43-5"><a href="#cb43-5"></a></span>
<span id="cb43-6"><a href="#cb43-6"></a>Ts &lt;-<span class="st"> </span><span class="cf">function</span>(X,Y,h){<span class="co">#Test statistics</span></span>
<span id="cb43-7"><a href="#cb43-7"></a>  len_X &lt;-<span class="st"> </span><span class="kw">length</span>(X)</span>
<span id="cb43-8"><a href="#cb43-8"></a>  len_Y &lt;-<span class="st"> </span><span class="kw">length</span>(Y)</span>
<span id="cb43-9"><a href="#cb43-9"></a>  C &lt;-<span class="st"> </span><span class="kw">K</span>(<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">*</span>(len_X<span class="op">+</span>len_Y)<span class="op">/</span>(h<span class="op">*</span>len_X<span class="op">*</span>len_Y)</span>
<span id="cb43-10"><a href="#cb43-10"></a>  I1 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb43-11"><a href="#cb43-11"></a>  I2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb43-12"><a href="#cb43-12"></a>  I3 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb43-13"><a href="#cb43-13"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_X){</span>
<span id="cb43-14"><a href="#cb43-14"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_X){</span>
<span id="cb43-15"><a href="#cb43-15"></a>      K1 &lt;-<span class="st"> </span><span class="kw">K</span>(X[i]<span class="op">-</span>X[j],h)<span class="op">/</span>(len_X<span class="op">*</span>len_X)</span>
<span id="cb43-16"><a href="#cb43-16"></a>      I1 &lt;-<span class="st"> </span>I1 <span class="op">+</span><span class="st"> </span>K1</span>
<span id="cb43-17"><a href="#cb43-17"></a>    }</span>
<span id="cb43-18"><a href="#cb43-18"></a>  }</span>
<span id="cb43-19"><a href="#cb43-19"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_Y){</span>
<span id="cb43-20"><a href="#cb43-20"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_Y){</span>
<span id="cb43-21"><a href="#cb43-21"></a>      K2 &lt;-<span class="st"> </span><span class="kw">K</span>(Y[i]<span class="op">-</span>Y[j],h)<span class="op">/</span>(len_Y<span class="op">*</span>len_Y)</span>
<span id="cb43-22"><a href="#cb43-22"></a>      I2 &lt;-<span class="st"> </span>I2 <span class="op">+</span><span class="st"> </span>K2</span>
<span id="cb43-23"><a href="#cb43-23"></a>    }</span>
<span id="cb43-24"><a href="#cb43-24"></a>  }</span>
<span id="cb43-25"><a href="#cb43-25"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_X){</span>
<span id="cb43-26"><a href="#cb43-26"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_Y){</span>
<span id="cb43-27"><a href="#cb43-27"></a>      K3 &lt;-<span class="st"> </span><span class="dv">-2</span><span class="op">*</span><span class="kw">K</span>(X[i]<span class="op">-</span>Y[j],h)<span class="op">/</span>(len_X<span class="op">*</span>len_Y)</span>
<span id="cb43-28"><a href="#cb43-28"></a>      I3 &lt;-<span class="st"> </span>I3 <span class="op">+</span><span class="st"> </span>K3</span>
<span id="cb43-29"><a href="#cb43-29"></a>    }</span>
<span id="cb43-30"><a href="#cb43-30"></a>  }</span>
<span id="cb43-31"><a href="#cb43-31"></a>  I &lt;-<span class="st"> </span>I1 <span class="op">+</span><span class="st"> </span>I2 <span class="op">+</span><span class="st"> </span>I3</span>
<span id="cb43-32"><a href="#cb43-32"></a>    sigma2_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb43-33"><a href="#cb43-33"></a>  sigma2_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb43-34"><a href="#cb43-34"></a>  sigma2_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb43-35"><a href="#cb43-35"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_X){</span>
<span id="cb43-36"><a href="#cb43-36"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_X){</span>
<span id="cb43-37"><a href="#cb43-37"></a>      s1 &lt;-<span class="st"> </span>(<span class="kw">K</span>(X[i]<span class="op">-</span>X[j],h))<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(len_X<span class="op">*</span>len_X)</span>
<span id="cb43-38"><a href="#cb43-38"></a>      sigma2_<span class="dv">1</span> &lt;-<span class="st"> </span>sigma2_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>s1</span>
<span id="cb43-39"><a href="#cb43-39"></a>    }</span>
<span id="cb43-40"><a href="#cb43-40"></a>  }</span>
<span id="cb43-41"><a href="#cb43-41"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_Y){</span>
<span id="cb43-42"><a href="#cb43-42"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_Y){</span>
<span id="cb43-43"><a href="#cb43-43"></a>      s2 &lt;-<span class="st"> </span>(<span class="kw">K</span>(Y[i]<span class="op">-</span>Y[j],h))<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(len_Y<span class="op">*</span>len_Y)</span>
<span id="cb43-44"><a href="#cb43-44"></a>      sigma2_<span class="dv">2</span> &lt;-<span class="st"> </span>sigma2_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>s2</span>
<span id="cb43-45"><a href="#cb43-45"></a>    }</span>
<span id="cb43-46"><a href="#cb43-46"></a>  }</span>
<span id="cb43-47"><a href="#cb43-47"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_X){</span>
<span id="cb43-48"><a href="#cb43-48"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_Y){</span>
<span id="cb43-49"><a href="#cb43-49"></a>     s3 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="kw">K</span>(X[i]<span class="op">-</span>Y[j],h))<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(len_X<span class="op">*</span>len_Y)</span>
<span id="cb43-50"><a href="#cb43-50"></a>      sigma2_<span class="dv">3</span> &lt;-<span class="st"> </span>sigma2_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>s3</span>
<span id="cb43-51"><a href="#cb43-51"></a>    }</span>
<span id="cb43-52"><a href="#cb43-52"></a>  }</span>
<span id="cb43-53"><a href="#cb43-53"></a>  sigma2&lt;-<span class="st"> </span>h<span class="op">*</span>(sigma2_<span class="dv">1</span><span class="op">+</span>sigma2_<span class="dv">2</span><span class="op">+</span>sigma2_<span class="dv">3</span>)</span>
<span id="cb43-54"><a href="#cb43-54"></a>  sigma_hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(sigma2)</span>
<span id="cb43-55"><a href="#cb43-55"></a>  result &lt;-<span class="kw">sqrt</span>(len_X<span class="op">*</span>len_Y<span class="op">*</span>h)<span class="op">*</span>(I<span class="op">-</span>C)<span class="op">/</span>sigma_hat</span>
<span id="cb43-56"><a href="#cb43-56"></a>  <span class="kw">return</span>(result)</span>
<span id="cb43-57"><a href="#cb43-57"></a>}</span>
<span id="cb43-58"><a href="#cb43-58"></a></span>
<span id="cb43-59"><a href="#cb43-59"></a></span>
<span id="cb43-60"><a href="#cb43-60"></a></span>
<span id="cb43-61"><a href="#cb43-61"></a>density_test &lt;-<span class="st"> </span><span class="cf">function</span>(X,Y,alpha){</span>
<span id="cb43-62"><a href="#cb43-62"></a>  len_x &lt;-<span class="st"> </span><span class="kw">length</span>(X)</span>
<span id="cb43-63"><a href="#cb43-63"></a>  len_y &lt;-<span class="st"> </span><span class="kw">length</span>(Y)</span>
<span id="cb43-64"><a href="#cb43-64"></a>  S &lt;-<span class="st"> </span><span class="kw">c</span>(X,Y)</span>
<span id="cb43-65"><a href="#cb43-65"></a>  sd_hat &lt;-<span class="st"> </span><span class="kw">sd</span>(S)</span>
<span id="cb43-66"><a href="#cb43-66"></a>  bw &lt;-<span class="st"> </span>sd_hat<span class="op">*</span><span class="fl">1.06</span><span class="op">*</span>(len_y<span class="op">+</span>len_x)<span class="op">^</span>(<span class="op">-</span><span class="fl">0.2</span>)</span>
<span id="cb43-67"><a href="#cb43-67"></a>  T1 &lt;-<span class="st"> </span><span class="kw">Ts</span>(X,Y,bw)</span>
<span id="cb43-68"><a href="#cb43-68"></a>  T0 &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb43-69"><a href="#cb43-69"></a>  return_value &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">result=</span>T0<span class="op">&gt;</span>T1,<span class="dt">Tstatistic=</span>T1,<span class="dt">Standard=</span>T0)</span>
<span id="cb43-70"><a href="#cb43-70"></a>  <span class="kw">return</span>(return_value)</span>
<span id="cb43-71"><a href="#cb43-71"></a>}</span>
<span id="cb43-72"><a href="#cb43-72"></a></span>
<span id="cb43-73"><a href="#cb43-73"></a></span>
<span id="cb43-74"><a href="#cb43-74"></a>bw_density_test &lt;-<span class="st"> </span><span class="cf">function</span>(X,Y,alpha,bw){<span class="co">## User can choice the bandwidth by himself</span></span>
<span id="cb43-75"><a href="#cb43-75"></a>  T1 &lt;-<span class="st"> </span><span class="kw">Ts</span>(X,Y,bw)</span>
<span id="cb43-76"><a href="#cb43-76"></a>  T0 &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb43-77"><a href="#cb43-77"></a>  return_value &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">result=</span>T0<span class="op">&gt;</span>T1,<span class="dt">Tstatistic=</span>T1,<span class="dt">Standard=</span>T0)</span>
<span id="cb43-78"><a href="#cb43-78"></a>  <span class="kw">return</span>(return_value)</span>
<span id="cb43-79"><a href="#cb43-79"></a>}</span>
<span id="cb43-80"><a href="#cb43-80"></a></span>
<span id="cb43-81"><a href="#cb43-81"></a><span class="kw">set.seed</span>(<span class="dv">2020</span>)</span>
<span id="cb43-82"><a href="#cb43-82"></a>n1 &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb43-83"><a href="#cb43-83"></a>n2 &lt;-<span class="st"> </span><span class="dv">40</span></span>
<span id="cb43-84"><a href="#cb43-84"></a>X1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb43-85"><a href="#cb43-85"></a>X2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb43-86"><a href="#cb43-86"></a><span class="kw">density_test</span>(X1,X2,<span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## $result
## [1] TRUE
## 
## $Tstatistic
## [1] 0.1796912
## 
## $Standard
## [1] 1.644854</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>X3 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="kw">density_test</span>(X1,X3,<span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## $result
## [1] FALSE
## 
## $Tstatistic
## [1] 1.959711
## 
## $Standard
## [1] 1.644854</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>S &lt;-<span class="st"> </span><span class="kw">c</span>(X1,X2)</span>
<span id="cb47-2"><a href="#cb47-2"></a>sd_hat &lt;-<span class="st"> </span><span class="kw">sd</span>(S)</span>
<span id="cb47-3"><a href="#cb47-3"></a>bw &lt;-<span class="st"> </span>sd_hat<span class="op">*</span><span class="fl">1.06</span><span class="op">*</span>(n1<span class="op">+</span>n2)<span class="op">^</span>(<span class="op">-</span><span class="fl">0.2</span>)</span>
<span id="cb47-4"><a href="#cb47-4"></a><span class="kw">bw_density_test</span>(X1,X2,<span class="fl">0.05</span>,bw)</span></code></pre></div>
<pre><code>## $result
## [1] TRUE
## 
## $Tstatistic
## [1] 0.1796912
## 
## $Standard
## [1] 1.644854</code></pre>
</div>
<div id="independence-testdim1" class="section level1">
<h1>Independence-Test(dim=1)</h1>
<p>There is a function to test whether two samples(dim=1) are independent or not,but the function is only useful for the samples with same sample size.Here use a kernel function to compute a Test-statistic<span class="math inline">\(T\)</span>,compare with the standard normal distribution <span class="math inline">\(Z_\alpha\)</span>.If <span class="math inline">\(T&gt;Z_\alpha\)</span>,we think they are dependent,else we think they are independent(When Confidence coefficient=<span class="math inline">\(\alpha\)</span>).</p>
<p>For the function <em>Independence_test(X,Y,alpha)</em>,X is the first sample,Y is the second sample,alpha is 1-Confidence_coefficient.</p>
<p>Because it’s difficult to dicide the bandwidth of kernel function,so the result may be not accurate.So users can choose the bandwidth by himself like this:</p>
<p>For the function <em>bw_Independence_test(X,Y,alpha,h1,h2)</em>,h1 is the bandwidth of X,h2 is the bandwidth of Y.(choose by users) .</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>K &lt;-<span class="st"> </span><span class="cf">function</span>(u,h){<span class="co">###Gaussian kernel function</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>  K_value &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(u<span class="op">/</span>h)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(h<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))</span>
<span id="cb49-3"><a href="#cb49-3"></a>  <span class="kw">return</span>(K_value)</span>
<span id="cb49-4"><a href="#cb49-4"></a>}</span>
<span id="cb49-5"><a href="#cb49-5"></a></span>
<span id="cb49-6"><a href="#cb49-6"></a>f1 &lt;-<span class="st"> </span><span class="cf">function</span>(X,h,m){</span>
<span id="cb49-7"><a href="#cb49-7"></a>  re &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb49-8"><a href="#cb49-8"></a>  lX &lt;-<span class="kw">length</span>(X)</span>
<span id="cb49-9"><a href="#cb49-9"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>lX) {</span>
<span id="cb49-10"><a href="#cb49-10"></a>    re &lt;-<span class="st"> </span>re <span class="op">+</span><span class="st"> </span><span class="kw">K</span>(X[i]<span class="op">-</span>X[m],h) </span>
<span id="cb49-11"><a href="#cb49-11"></a>  }</span>
<span id="cb49-12"><a href="#cb49-12"></a>  re &lt;-<span class="st"> </span>re <span class="op">-</span><span class="st"> </span><span class="kw">K</span>(<span class="dv">0</span>,h)</span>
<span id="cb49-13"><a href="#cb49-13"></a>  re &lt;-<span class="st"> </span>re<span class="op">/</span>(lX<span class="dv">-1</span>)</span>
<span id="cb49-14"><a href="#cb49-14"></a>  <span class="kw">return</span>(re)</span>
<span id="cb49-15"><a href="#cb49-15"></a>}</span>
<span id="cb49-16"><a href="#cb49-16"></a></span>
<span id="cb49-17"><a href="#cb49-17"></a>f2 &lt;-<span class="st"> </span><span class="cf">function</span>(X,Y,h1,h2,m){</span>
<span id="cb49-18"><a href="#cb49-18"></a>  res &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb49-19"><a href="#cb49-19"></a>  lX &lt;-<span class="kw">length</span>(X)</span>
<span id="cb49-20"><a href="#cb49-20"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>lX) {</span>
<span id="cb49-21"><a href="#cb49-21"></a>    res &lt;-<span class="st"> </span>res <span class="op">+</span><span class="st"> </span><span class="kw">K</span>(X[i]<span class="op">-</span>X[m],h1)<span class="op">*</span><span class="kw">K</span>(Y[i]<span class="op">-</span>Y[m],h2) </span>
<span id="cb49-22"><a href="#cb49-22"></a>  }</span>
<span id="cb49-23"><a href="#cb49-23"></a>  res &lt;-<span class="st"> </span>res <span class="op">-</span><span class="st"> </span><span class="kw">K</span>(<span class="dv">0</span>,h1)<span class="op">*</span><span class="kw">K</span>(<span class="dv">0</span>,h2)</span>
<span id="cb49-24"><a href="#cb49-24"></a>  res &lt;-<span class="st"> </span>res<span class="op">/</span>(lX<span class="dv">-1</span>)</span>
<span id="cb49-25"><a href="#cb49-25"></a>  <span class="kw">return</span>(res)</span>
<span id="cb49-26"><a href="#cb49-26"></a>}</span>
<span id="cb49-27"><a href="#cb49-27"></a></span>
<span id="cb49-28"><a href="#cb49-28"></a>Ts2 &lt;-<span class="st"> </span><span class="cf">function</span>(X,Y,h1,h2){<span class="co">#Test statistics</span></span>
<span id="cb49-29"><a href="#cb49-29"></a>  len_X &lt;-<span class="st"> </span><span class="kw">length</span>(X)</span>
<span id="cb49-30"><a href="#cb49-30"></a>    len_X &lt;-<span class="st"> </span><span class="kw">length</span>(X)</span>
<span id="cb49-31"><a href="#cb49-31"></a>  I1 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb49-32"><a href="#cb49-32"></a>  I2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb49-33"><a href="#cb49-33"></a>  I3 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb49-34"><a href="#cb49-34"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_X){</span>
<span id="cb49-35"><a href="#cb49-35"></a>    I1 &lt;-<span class="st"> </span>I1 <span class="op">+</span><span class="st"> </span><span class="kw">f2</span>(X,Y,h1,h2,i)</span>
<span id="cb49-36"><a href="#cb49-36"></a>    I3 &lt;-<span class="st"> </span>I3 <span class="op">+</span><span class="st"> </span><span class="kw">f1</span>(X,h1,i)<span class="op">*</span><span class="kw">f1</span>(Y,h2,i)</span>
<span id="cb49-37"><a href="#cb49-37"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_X){</span>
<span id="cb49-38"><a href="#cb49-38"></a>      I2 &lt;-<span class="st"> </span>I2 <span class="op">+</span><span class="st"> </span><span class="kw">f1</span>(X,h1,i)<span class="op">*</span><span class="kw">f1</span>(Y,h2,j)</span>
<span id="cb49-39"><a href="#cb49-39"></a>    }</span>
<span id="cb49-40"><a href="#cb49-40"></a>  }</span>
<span id="cb49-41"><a href="#cb49-41"></a>  I1 &lt;-<span class="st"> </span>I1<span class="op">/</span>len_X</span>
<span id="cb49-42"><a href="#cb49-42"></a>  I2 &lt;-<span class="st"> </span>I2<span class="op">/</span>(len_X)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb49-43"><a href="#cb49-43"></a>  I3 &lt;-<span class="st"> </span><span class="dv">-2</span><span class="op">*</span>I3<span class="op">/</span>len_X</span>
<span id="cb49-44"><a href="#cb49-44"></a>  I_hat &lt;-<span class="st"> </span>I1 <span class="op">+</span><span class="st"> </span>I2 <span class="op">+</span><span class="st"> </span>I3</span>
<span id="cb49-45"><a href="#cb49-45"></a>    len_X &lt;-<span class="st"> </span><span class="kw">length</span>(X)</span>
<span id="cb49-46"><a href="#cb49-46"></a>  s1 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb49-47"><a href="#cb49-47"></a>  s2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb49-48"><a href="#cb49-48"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_X){</span>
<span id="cb49-49"><a href="#cb49-49"></a>    s1 &lt;-<span class="st"> </span>s1 <span class="op">+</span><span class="st"> </span>(<span class="kw">K</span>(<span class="dv">0</span>,h1)<span class="op">*</span><span class="kw">K</span>(<span class="dv">0</span>,h2))<span class="op">^</span><span class="dv">2</span></span>
<span id="cb49-50"><a href="#cb49-50"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len_X){</span>
<span id="cb49-51"><a href="#cb49-51"></a>      s2 &lt;-<span class="st"> </span>s2<span class="op">+</span><span class="st"> </span>(<span class="kw">K</span>(X[j]<span class="op">-</span>X[i],h1)<span class="op">*</span><span class="kw">K</span>(Y[j]<span class="op">-</span>Y[i],h2))<span class="op">^</span><span class="dv">2</span></span>
<span id="cb49-52"><a href="#cb49-52"></a>    }</span>
<span id="cb49-53"><a href="#cb49-53"></a>  }</span>
<span id="cb49-54"><a href="#cb49-54"></a>  s_hat &lt;-<span class="st"> </span>s2<span class="op">-</span>s1</span>
<span id="cb49-55"><a href="#cb49-55"></a>  s_hat &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>s_hat<span class="op">/</span>(len_X<span class="op">^</span><span class="dv">2</span><span class="op">-</span>len_X)</span>
<span id="cb49-56"><a href="#cb49-56"></a>  sigma_hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(s_hat)</span>
<span id="cb49-57"><a href="#cb49-57"></a>  result &lt;-<span class="st"> </span>len_X<span class="op">*</span><span class="kw">sqrt</span>(h1<span class="op">*</span>h2)<span class="op">*</span>I_hat<span class="op">/</span>sigma_hat</span>
<span id="cb49-58"><a href="#cb49-58"></a>  <span class="kw">return</span>(result)</span>
<span id="cb49-59"><a href="#cb49-59"></a>}</span>
<span id="cb49-60"><a href="#cb49-60"></a></span>
<span id="cb49-61"><a href="#cb49-61"></a>Independence_test &lt;-<span class="st"> </span><span class="cf">function</span>(X,Y,alpha){</span>
<span id="cb49-62"><a href="#cb49-62"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(X)</span>
<span id="cb49-63"><a href="#cb49-63"></a>  r &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb49-64"><a href="#cb49-64"></a>  r[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb49-65"><a href="#cb49-65"></a>  r[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb49-66"><a href="#cb49-66"></a>  <span class="cf">if</span>(n<span class="op">==</span><span class="kw">length</span>(Y)){</span>
<span id="cb49-67"><a href="#cb49-67"></a>    h1 &lt;-<span class="st"> </span><span class="fl">1.06</span><span class="op">*</span><span class="kw">sd</span>(X)<span class="op">*</span>n<span class="op">^</span>(<span class="op">-</span><span class="fl">0.2</span>)<span class="co">##suitable bandwith</span></span>
<span id="cb49-68"><a href="#cb49-68"></a>    h2 &lt;-<span class="st"> </span><span class="fl">1.06</span><span class="op">*</span><span class="kw">sd</span>(Y)<span class="op">*</span>n<span class="op">^</span>(<span class="op">-</span><span class="fl">0.2</span>)</span>
<span id="cb49-69"><a href="#cb49-69"></a>    r[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb49-70"><a href="#cb49-70"></a>    r[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">Ts2</span>(X,Y,h1,h2)</span>
<span id="cb49-71"><a href="#cb49-71"></a>    <span class="cf">if</span>(r[<span class="dv">3</span>]<span class="op">&gt;</span>r[<span class="dv">2</span>]){</span>
<span id="cb49-72"><a href="#cb49-72"></a>      r1 &lt;-<span class="st"> &quot;Dependence&quot;</span></span>
<span id="cb49-73"><a href="#cb49-73"></a>    }</span>
<span id="cb49-74"><a href="#cb49-74"></a>    <span class="cf">else</span>{</span>
<span id="cb49-75"><a href="#cb49-75"></a>      r1 &lt;-<span class="st"> &quot;Independence&quot;</span></span>
<span id="cb49-76"><a href="#cb49-76"></a>    }</span>
<span id="cb49-77"><a href="#cb49-77"></a>  }</span>
<span id="cb49-78"><a href="#cb49-78"></a>  <span class="cf">else</span>{</span>
<span id="cb49-79"><a href="#cb49-79"></a>    r1 &lt;-<span class="st"> &quot;different length&quot;</span></span>
<span id="cb49-80"><a href="#cb49-80"></a>  }</span>
<span id="cb49-81"><a href="#cb49-81"></a>  return_value &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">result=</span>r1,<span class="dt">Tstatistic=</span>r[<span class="dv">3</span>],<span class="dt">Standard=</span>r[<span class="dv">2</span>])</span>
<span id="cb49-82"><a href="#cb49-82"></a>  <span class="kw">return</span>(return_value)</span>
<span id="cb49-83"><a href="#cb49-83"></a>}</span>
<span id="cb49-84"><a href="#cb49-84"></a></span>
<span id="cb49-85"><a href="#cb49-85"></a></span>
<span id="cb49-86"><a href="#cb49-86"></a>bw_Independence_test &lt;-<span class="st"> </span><span class="cf">function</span>(X,Y,alpha,bw1,bw2){<span class="co">## User can choice the bandwidth by himself</span></span>
<span id="cb49-87"><a href="#cb49-87"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(X)</span>
<span id="cb49-88"><a href="#cb49-88"></a>  r &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb49-89"><a href="#cb49-89"></a>  r[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb49-90"><a href="#cb49-90"></a>  r[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb49-91"><a href="#cb49-91"></a>  <span class="cf">if</span>(n<span class="op">==</span><span class="kw">length</span>(Y)){</span>
<span id="cb49-92"><a href="#cb49-92"></a>    r[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb49-93"><a href="#cb49-93"></a>    r[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">Ts2</span>(X,Y,bw1,bw2)</span>
<span id="cb49-94"><a href="#cb49-94"></a>    <span class="cf">if</span>(r[<span class="dv">3</span>]<span class="op">&gt;</span>r[<span class="dv">2</span>]){</span>
<span id="cb49-95"><a href="#cb49-95"></a>      r1 &lt;-<span class="st"> &quot;Dependence&quot;</span></span>
<span id="cb49-96"><a href="#cb49-96"></a>    }</span>
<span id="cb49-97"><a href="#cb49-97"></a>    <span class="cf">else</span>{</span>
<span id="cb49-98"><a href="#cb49-98"></a>      r1 &lt;-<span class="st"> &quot;Independence&quot;</span></span>
<span id="cb49-99"><a href="#cb49-99"></a>    }</span>
<span id="cb49-100"><a href="#cb49-100"></a>  }</span>
<span id="cb49-101"><a href="#cb49-101"></a>  <span class="cf">else</span>{</span>
<span id="cb49-102"><a href="#cb49-102"></a>    r1 &lt;-<span class="st"> &quot;different length&quot;</span></span>
<span id="cb49-103"><a href="#cb49-103"></a>  }</span>
<span id="cb49-104"><a href="#cb49-104"></a>  return_value &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">result=</span>r1,<span class="dt">Tstatistic=</span>r[<span class="dv">3</span>],<span class="dt">Standard=</span>r[<span class="dv">2</span>])</span>
<span id="cb49-105"><a href="#cb49-105"></a>  <span class="kw">return</span>(return_value)</span>
<span id="cb49-106"><a href="#cb49-106"></a>}</span>
<span id="cb49-107"><a href="#cb49-107"></a></span>
<span id="cb49-108"><a href="#cb49-108"></a><span class="kw">set.seed</span>(<span class="dv">2020</span>)</span>
<span id="cb49-109"><a href="#cb49-109"></a>n1 &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb49-110"><a href="#cb49-110"></a>n2 &lt;-<span class="st"> </span><span class="dv">40</span></span>
<span id="cb49-111"><a href="#cb49-111"></a>X1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb49-112"><a href="#cb49-112"></a>X2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb49-113"><a href="#cb49-113"></a><span class="kw">Independence_test</span>(X1,X2,<span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## $result
## [1] &quot;different length&quot;
## 
## $Tstatistic
## [1] NA
## 
## $Standard
## [1] NA</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>X3 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="kw">Independence_test</span>(X1,X3,<span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## $result
## [1] &quot;Independence&quot;
## 
## $Tstatistic
## [1] -0.02240621
## 
## $Standard
## [1] 1.644854</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>X4 &lt;-<span class="st"> </span>X1<span class="op">^</span><span class="dv">2</span></span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="kw">Independence_test</span>(X1,X4,<span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## $result
## [1] &quot;Dependence&quot;
## 
## $Tstatistic
## [1] 1.987891
## 
## $Standard
## [1] 1.644854</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(X1)</span>
<span id="cb55-2"><a href="#cb55-2"></a>h1 &lt;-<span class="st"> </span><span class="fl">1.06</span><span class="op">*</span><span class="kw">sd</span>(X1)<span class="op">*</span>n<span class="op">^</span>(<span class="op">-</span><span class="fl">0.2</span>)</span>
<span id="cb55-3"><a href="#cb55-3"></a>h4 &lt;-<span class="st"> </span><span class="fl">1.06</span><span class="op">*</span><span class="kw">sd</span>(X4)<span class="op">*</span>n<span class="op">^</span>(<span class="op">-</span><span class="fl">0.2</span>)</span>
<span id="cb55-4"><a href="#cb55-4"></a><span class="kw">bw_Independence_test</span>(X1,X4,<span class="fl">0.05</span>,h1,h4)</span></code></pre></div>
<pre><code>## $result
## [1] &quot;Dependence&quot;
## 
## $Tstatistic
## [1] 1.987891
## 
## $Standard
## [1] 1.644854</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
